
12-13 16:06 - Optimizing Logistic Regression hyperparameters with Optuna.
12-13 16:09 - Best Logistic Regression parameters: {'penalty': 'elasticnet', 'C': 0.21956410310260677, 'max_iter': 520, 'tol': 0.00017962160461897637, 'l1_ratio': 0.46663841712083964}
12-13 16:09 - Logistic Regression - Total trials: 3
12-13 16:09 - Logistic Regression - Completed trials: 3
12-13 16:09 - Logistic Regression - Pruned trials: 0
12-13 16:09 - Logistic Regression - Failed trials: 0
12-13 16:09 - Training Logistic Regression (Tuned)...
12-13 16:09 - Training completed for Logistic Regression (Tuned).
12-13 16:09 - Predictions made for Logistic Regression (Tuned).
12-13 16:09 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-13 16:09 - 
Logistic Regression (Tuned) Evaluation:
12-13 16:09 -   Accuracy                  : 0.9462
12-13 16:09 -   Precision                 : 0.1906
12-13 16:09 -   Recall                    : 0.7050
12-13 16:09 -   F1 Score                  : 0.3001
12-13 16:09 -   Mean Absolute Error       : 0.0538
12-13 16:09 -   Root Mean Squared Error   : 0.2319
12-13 16:09 -   AUC-ROC                   : 0.8967
12-13 16:09 -   Specificity               : 0.9502
12-13 16:09 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-13 16:09 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-13 16:09 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-13 16:09 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-13 16:09 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-13 16:09 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-13 16:09 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 16:09 - Missing values heatmap saved to reports/evaluations/run_20241213_154102/Logistic Regression (Tuned)_missing_values_heatmap.png
12-13 16:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_110729.png
12-13 16:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_1698.png
12-13 16:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_12208.png
12-13 16:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_102089.png
12-13 16:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13569.png
12-13 16:09 - Saved temporal progression plots for 5 patients
12-13 16:09 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-13 16:09 - Saved error analysis plots to reports/evaluations/run_20241213_154102
12-13 16:10 - Saved feature interaction plots for top 5 pairs
ERROR fixed
12-13 16:10 - Optimizing XGBoost hyperparameters with Optuna.
12-13 16:10 - Best XGBoost parameters: {'n_estimators': 176, 'max_depth': 7, 'learning_rate': 0.04638179464247007, 'subsample': 0.7606676539306889, 'colsample_bytree': 0.9160374894113419, 'gamma': 4.978798091728098, 'reg_alpha': 0.5845828949299587, 'reg_lambda': 0.899002251069711}
12-13 16:10 - XGBoost - Total trials: 3
12-13 16:10 - XGBoost - Completed trials: 3
12-13 16:10 - XGBoost - Pruned trials: 0
12-13 16:10 - XGBoost - Failed trials: 0
12-13 16:10 - Training XGBoost (Tuned)...
12-13 16:10 - Training completed for XGBoost (Tuned).
12-13 16:10 - Predictions made for XGBoost (Tuned).
12-13 16:10 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-13 16:10 - 
XGBoost (Tuned) Evaluation:
12-13 16:10 -   Accuracy                  : 0.9288
12-13 16:10 -   Precision                 : 0.1608
12-13 16:10 -   Recall                    : 0.7956
12-13 16:10 -   F1 Score                  : 0.2675
12-13 16:10 -   Mean Absolute Error       : 0.0712
12-13 16:10 -   Root Mean Squared Error   : 0.2669
12-13 16:10 -   AUC-ROC                   : 0.9474
12-13 16:10 -   Specificity               : 0.9310
12-13 16:10 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-13 16:10 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-13 16:10 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-13 16:10 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-13 16:10 - Saved plot: XGBoost_(Tuned)_calibration.png
12-13 16:10 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-13 16:10 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 16:10 - Missing values heatmap saved to reports/evaluations/run_20241213_154102/XGBoost (Tuned)_missing_values_heatmap.png
12-13 16:10 - Saved plot: XGBoost_(Tuned)_temporal_patient_107525.png
12-13 16:10 - Saved plot: XGBoost_(Tuned)_temporal_patient_15199.png
12-13 16:10 - Saved plot: XGBoost_(Tuned)_temporal_patient_100693.png
12-13 16:10 - Saved plot: XGBoost_(Tuned)_temporal_patient_10855.png
12-13 16:10 - Saved plot: XGBoost_(Tuned)_temporal_patient_1895.png
12-13 16:10 - Saved temporal progression plots for 5 patients
12-13 16:10 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-13 16:10 - Saved error analysis plots to reports/evaluations/run_20241213_154102
12-13 16:11 - Saved feature interaction plots for top 5 pairs
12-13 16:11 - Error plotting prediction timeline: x and y must have same first dimension, but have shapes (17,) and (0,)
ERROR fixed
ValueError: x and y must have same first dimension, but have shapes (17,) and (0,)
12-13 16:11 - Saved trained models to checkpoints/trained_models.pkl
12-13 16:11 - Saved updated Optuna studies to checkpoints/optuna_studies.pkl
12-13 16:11 - Saved trial data to reports/evaluations/run_20241213_154102/random_forest_optimization_optimization_trials.csv
12-13 16:11 - Saved trial data to reports/evaluations/run_20241213_154102/logistic_regression_optimization_optimization_trials.csv
12-13 16:11 - Saved trial data to reports/evaluations/run_20241213_154102/xgboost_optimization_optimization_trials.csv
12-13 16:11 - No models were trained. Pipeline did not complete successfully.
12-13 16:11 - --------------------------------------------------------------------------------
12-13 16:11 - Phase Complete: Main
12-13 16:11 - Duration: 1827.19 seconds
12-13 16:11 - Final Memory Usage: 1160.56 MB
12-13 16:11 - Memory Change: +946.08 MB
12-13 16:11 - ================================================================================
12-13 16:31 - ================================================================================
12-13 16:31 - Starting Phase: Main
12-13 16:31 - --------------------------------------------------------------------------------
12-13 16:31 - Initial Memory Usage: 215.95 MB
12-13 16:31 - Starting Sepsis Prediction Pipeline
12-13 16:31 - Reports and metrics will be saved to: reports/evaluations/run_20241213_163148
12-13 16:31 - Loading preprocessed data from checkpoint.
12-13 16:31 - Loading resampled data from checkpoint.
12-13 16:31 - Loading trained models from checkpoint.
12-13 16:31 - Best model so far: None with F1 Score: 0.0000
12-13 16:31 - No models were trained. Pipeline did not complete successfully.
12-13 16:31 - --------------------------------------------------------------------------------
12-13 16:31 - Phase Complete: Main
12-13 16:31 - Duration: 0.17 seconds
12-13 16:31 - Final Memory Usage: 575.62 MB
12-13 16:31 - Memory Change: +359.67 MB
12-13 16:31 - ================================================================================
12-13 16:33 - ================================================================================
12-13 16:33 - Starting Phase: Main
12-13 16:33 - --------------------------------------------------------------------------------
12-13 16:33 - Initial Memory Usage: 216.19 MB
12-13 16:33 - Starting Sepsis Prediction Pipeline
12-13 16:33 - Reports and metrics will be saved to: reports/evaluations/run_20241213_163338
12-13 16:33 - Loading preprocessed data from checkpoint.
12-13 16:33 - Loading resampled data from checkpoint.
12-13 16:33 - Loading trained models from checkpoint.
12-13 16:33 - Best model so far: None with F1 Score: 0.0000
12-13 16:33 - No models were trained. Pipeline did not complete successfully.
12-13 16:33 - --------------------------------------------------------------------------------
12-13 16:33 - Phase Complete: Main
12-13 16:33 - Duration: 0.16 seconds
12-13 16:33 - Final Memory Usage: 579.31 MB
12-13 16:33 - Memory Change: +363.12 MB
12-13 16:33 - ================================================================================
12-13 16:37 - ================================================================================
12-13 16:37 - Starting Phase: Main
12-13 16:37 - --------------------------------------------------------------------------------
12-13 16:37 - Initial Memory Usage: 215.48 MB
12-13 16:37 - Starting Sepsis Prediction Pipeline
12-13 16:37 - Reports and metrics will be saved to: reports/evaluations/run_20241213_163758
12-13 16:37 - Loading preprocessed data from checkpoint.
12-13 16:37 - Loading resampled data from checkpoint.
12-13 16:37 - Loading Optuna studies from checkpoint.
12-13 16:37 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-13 16:37 - Optimizing Random Forest hyperparameters with Optuna.
12-13 16:46 - Best Random Forest parameters: {'n_estimators': 437, 'max_depth': 30, 'min_samples_split': 11, 'min_samples_leaf': 3, 'max_features': 'log2'}
ERROR fixed
12-13 16:46 - Optimizing XGBoost hyperparameters with Optuna.
12-13 16:59 - ================================================================================
12-13 16:59 - Starting Phase: Main
12-13 16:59 - --------------------------------------------------------------------------------
12-13 16:59 - Initial Memory Usage: 213.77 MB
12-13 16:59 - Starting Sepsis Prediction Pipeline
12-13 16:59 - Reports and metrics will be saved to: reports/evaluations/run_20241213_165933
12-13 16:59 - Loading and preprocessing data.
12-13 16:59 - Splitting data into training, validation, and testing sets
12-13 16:59 - Starting step: Preprocessing training data
12-13 17:03 - Completed step: Preprocessing training data (Duration: 218.75s)
12-13 17:03 - Starting step: Preprocessing validation data
12-13 17:03 - Completed step: Preprocessing validation data (Duration: 7.27s)
12-13 17:03 - Starting step: Preprocessing testing data
12-13 17:03 - Completed step: Preprocessing testing data (Duration: 7.47s)
12-13 17:03 - Saved preprocessed data to checkpoints/preprocessed_data.pkl
12-13 17:03 - Applying SMOTEENN to training data.
12-13 17:04 - ================================================================================
12-13 17:04 - Starting Phase: Main
12-13 17:04 - --------------------------------------------------------------------------------
12-13 17:04 - Initial Memory Usage: 214.83 MB
12-13 17:04 - Starting Sepsis Prediction Pipeline
12-13 17:04 - Reports and metrics will be saved to: reports/evaluations/run_20241213_170447
12-13 17:04 - Loading preprocessed data from checkpoint.
12-13 17:04 - Applying SMOTEENN to training data.
12-13 17:07 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-13 17:07 - Saved resampled data to checkpoints/resampled_data.pkl
12-13 17:07 - Initializing new Optuna studies.
12-13 17:07 - Saved Optuna studies to checkpoints/optuna_studies.pkl
12-13 17:07 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-13 17:07 - Optimizing Random Forest hyperparameters with Optuna.
12-13 17:09 - Best Random Forest parameters: {'n_estimators': 437, 'max_depth': 30, 'min_samples_split': 11, 'min_samples_leaf': 3, 'max_features': 'log2'}
12-13 17:09 - Random Forest - Total trials: 5
12-13 17:09 - Random Forest - Completed trials: 5
12-13 17:09 - Random Forest - Pruned trials: 0
12-13 17:09 - Random Forest - Failed trials: 0
12-13 17:09 - Training Random Forest (Tuned)...
12-13 17:13 - Training completed for Random Forest (Tuned).
12-13 17:13 - Predictions made for Random Forest (Tuned).
12-13 17:13 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-13 17:13 - 
Random Forest (Tuned) Evaluation:
12-13 17:13 -   Accuracy                  : 0.9711
12-13 17:13 -   Precision                 : 0.2907
12-13 17:13 -   Recall                    : 0.5330
12-13 17:13 -   F1 Score                  : 0.3762
12-13 17:13 -   Mean Absolute Error       : 0.0289
12-13 17:13 -   Root Mean Squared Error   : 0.1700
12-13 17:13 -   AUC-ROC                   : 0.9534
12-13 17:13 -   Specificity               : 0.9784
12-13 17:13 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-13 17:13 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-13 17:13 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-13 17:13 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-13 17:13 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-13 17:13 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-13 17:13 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 17:13 - Missing values heatmap saved to reports/evaluations/run_20241213_170447/Random Forest (Tuned)_missing_values_heatmap.png
12-13 17:13 - Saved plot: Random_Forest_(Tuned)_temporal_patient_102089.png
12-13 17:13 - Saved plot: Random_Forest_(Tuned)_temporal_patient_110411.png
12-13 17:13 - Saved plot: Random_Forest_(Tuned)_temporal_patient_106429.png
12-13 17:13 - Saved plot: Random_Forest_(Tuned)_temporal_patient_10966.png
12-13 17:13 - Saved plot: Random_Forest_(Tuned)_temporal_patient_650.png
12-13 17:13 - Saved temporal progression plots for 5 patients
12-13 17:13 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-13 17:13 - Saved error analysis plots to reports/evaluations/run_20241213_170447
12-13 17:13 - Saved feature interaction plots for top 5 pairs
12-13 17:13 - No sepsis patients have predictions for timeline plots.
12-13 17:13 - Saved evaluation metrics to reports/evaluations/run_20241213_170447/Random Forest (Tuned)_metrics.json

12-13 17:13 - Evaluation completed for Random Forest (Tuned).
12-13 17:13 - New best model: Random Forest (Tuned) with F1 Score: 0.3762
12-13 17:13 - Saved hyperparameters to reports/evaluations/run_20241213_170447/random_forest_tuned_params.json
12-13 17:13 - Optimizing Logistic Regression hyperparameters with Optuna.
12-13 17:14 - Best Logistic Regression parameters: {'penalty': 'elasticnet', 'C': 0.21956410310260677, 'max_iter': 520, 'tol': 0.00017962160461897637, 'l1_ratio': 0.46663841712083964}
12-13 17:14 - Logistic Regression - Total trials: 5
12-13 17:14 - Logistic Regression - Completed trials: 5
12-13 17:14 - Logistic Regression - Pruned trials: 0
12-13 17:14 - Logistic Regression - Failed trials: 0
ERROR fixed
XGBoost (Tuned) Evaluation:
12-13 17:14 -   Accuracy                  : 0.9288
12-13 17:14 -   Precision                 : 0.1608
12-13 17:14 -   Recall                    : 0.7956
12-13 17:14 -   F1 Score                  : 0.2675
12-13 17:14 -   Mean Absolute Error       : 0.0712
12-13 17:14 -   Root Mean Squared Error   : 0.2669
12-13 17:14 -   AUC-ROC                   : 0.9474
12-13 17:14 -   Specificity               : 0.9310
12-13 17:14 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-13 17:14 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-13 17:14 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-13 17:14 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-13 17:14 - Saved plot: XGBoost_(Tuned)_calibration.png
12-13 17:14 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-13 17:14 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 17:14 - Missing values heatmap saved to reports/evaluations/run_20241213_170447/XGBoost (Tuned)_missing_values_heatmap.png
12-13 17:14 - Saved plot: XGBoost_(Tuned)_temporal_patient_359.png
12-13 17:14 - Saved plot: XGBoost_(Tuned)_temporal_patient_118275.png
12-13 17:14 - Saved plot: XGBoost_(Tuned)_temporal_patient_102453.png
12-13 17:14 - Saved plot: XGBoost_(Tuned)_temporal_patient_13856.png
12-13 17:14 - Saved plot: XGBoost_(Tuned)_temporal_patient_113147.png
12-13 17:14 - Saved temporal progression plots for 5 patients
12-13 17:14 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-13 17:14 - Saved error analysis plots to reports/evaluations/run_20241213_170447
12-13 17:18 - ================================================================================
12-13 17:18 - Starting Phase: Main
12-13 17:18 - --------------------------------------------------------------------------------
12-13 17:18 - Initial Memory Usage: 215.80 MB
12-13 17:18 - Starting Sepsis Prediction Pipeline
12-13 17:18 - Reports and metrics will be saved to: reports/evaluations/run_20241213_171807
12-13 17:18 - Loading preprocessed data from checkpoint.
12-13 17:18 - Loading resampled data from checkpoint.
12-13 17:18 - Loading Optuna studies from checkpoint.
12-13 17:18 - Starting Optuna hyperparameter tuning with 2 parallel jobs.
12-13 17:18 - Optimizing Random Forest hyperparameters with Optuna.
12-13 17:27 - Best Random Forest parameters: {'n_estimators': 437, 'max_depth': 30, 'min_samples_split': 11, 'min_samples_leaf': 3, 'max_features': 'log2'}
12-13 17:27 - Random Forest - Total trials: 7
12-13 17:27 - Random Forest - Completed trials: 7
12-13 17:27 - Random Forest - Pruned trials: 0
12-13 17:27 - Random Forest - Failed trials: 0
12-13 17:27 - Training Random Forest (Tuned)...
12-13 17:30 - Training completed for Random Forest (Tuned).
12-13 17:30 - Predictions made for Random Forest (Tuned).
12-13 17:30 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-13 17:30 - 
Random Forest (Tuned) Evaluation:
12-13 17:30 -   Accuracy                  : 0.9711
12-13 17:30 -   Precision                 : 0.2907
12-13 17:30 -   Recall                    : 0.5330
12-13 17:30 -   F1 Score                  : 0.3762
12-13 17:30 -   Mean Absolute Error       : 0.0289
12-13 17:30 -   Root Mean Squared Error   : 0.1700
12-13 17:30 -   AUC-ROC                   : 0.9534
12-13 17:30 -   Specificity               : 0.9784
12-13 17:30 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-13 17:30 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-13 17:30 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-13 17:31 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-13 17:31 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-13 17:31 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-13 17:31 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 17:31 - Missing values heatmap saved to reports/evaluations/run_20241213_171807/Random Forest (Tuned)_missing_values_heatmap.png
12-13 17:31 - Saved plot: Random_Forest_(Tuned)_temporal_patient_5719.png
12-13 17:31 - Saved plot: Random_Forest_(Tuned)_temporal_patient_14823.png
12-13 17:31 - Saved plot: Random_Forest_(Tuned)_temporal_patient_8135.png
12-13 17:31 - Saved plot: Random_Forest_(Tuned)_temporal_patient_13035.png
12-13 17:31 - Saved plot: Random_Forest_(Tuned)_temporal_patient_11144.png
12-13 17:31 - Saved temporal progression plots for 5 patients
12-13 17:31 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-13 17:31 - Saved error analysis plots to reports/evaluations/run_20241213_171807
12-13 17:31 - Saved feature interaction plots for top 5 pairs
12-13 17:31 - No sepsis patients have predictions for timeline plots.
12-13 17:31 - Saved evaluation metrics to reports/evaluations/run_20241213_171807/Random Forest (Tuned)_metrics.json

12-13 17:31 - Evaluation completed for Random Forest (Tuned).
12-13 17:31 - New best model: Random Forest (Tuned) with F1 Score: 0.3762
12-13 17:31 - Saved hyperparameters to reports/evaluations/run_20241213_171807/random_forest_tuned_params.json
12-13 17:31 - Optimizing Logistic Regression hyperparameters with Optuna.
12-13 17:35 - Best Logistic Regression parameters: {'penalty': 'elasticnet', 'C': 0.21956410310260677, 'max_iter': 520, 'tol': 0.00017962160461897637, 'l1_ratio': 0.46663841712083964}
12-13 17:35 - Logistic Regression - Total trials: 7
12-13 17:35 - Logistic Regression - Completed trials: 7
12-13 17:35 - Logistic Regression - Pruned trials: 0
12-13 17:35 - Logistic Regression - Failed trials: 0
12-13 17:35 - Training Logistic Regression (Tuned)...
12-13 17:35 - Training completed for Logistic Regression (Tuned).
12-13 17:35 - Predictions made for Logistic Regression (Tuned).
12-13 17:35 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-13 17:35 - 
Logistic Regression (Tuned) Evaluation:
12-13 17:35 -   Accuracy                  : 0.9462
12-13 17:35 -   Precision                 : 0.1906
12-13 17:35 -   Recall                    : 0.7050
12-13 17:35 -   F1 Score                  : 0.3001
12-13 17:35 -   Mean Absolute Error       : 0.0538
12-13 17:35 -   Root Mean Squared Error   : 0.2319
12-13 17:35 -   AUC-ROC                   : 0.8967
12-13 17:35 -   Specificity               : 0.9502
12-13 17:35 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-13 17:35 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-13 17:35 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-13 17:35 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-13 17:35 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-13 17:35 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-13 17:35 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 17:35 - Missing values heatmap saved to reports/evaluations/run_20241213_171807/Logistic Regression (Tuned)_missing_values_heatmap.png
12-13 17:35 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_103365.png
12-13 17:35 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_2220.png
12-13 17:35 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_9396.png
12-13 17:35 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_114937.png
12-13 17:35 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16968.png
12-13 17:35 - Saved temporal progression plots for 5 patients
12-13 17:35 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-13 17:35 - Saved error analysis plots to reports/evaluations/run_20241213_171807
12-13 17:36 - Saved feature interaction plots for top 5 pairs
12-13 17:36 - No sepsis patients have predictions for timeline plots.
12-13 17:36 - Saved evaluation metrics to reports/evaluations/run_20241213_171807/Logistic Regression (Tuned)_metrics.json

12-13 17:36 - Evaluation completed for Logistic Regression (Tuned).
12-13 17:36 - Saved hyperparameters to reports/evaluations/run_20241213_171807/logistic_regression_tuned_params.json
12-13 17:36 - Optimizing XGBoost hyperparameters with Optuna.
12-13 17:36 - Best XGBoost parameters: {'n_estimators': 360, 'max_depth': 6, 'learning_rate': 0.119527718013466, 'subsample': 0.8562833575504147, 'colsample_bytree': 0.5953210534503394, 'gamma': 3.775219533080583, 'reg_alpha': 0.9682079285262276, 'reg_lambda': 0.7909075717648127}
12-13 17:36 - XGBoost - Total trials: 6
12-13 17:36 - XGBoost - Completed trials: 5
12-13 17:36 - XGBoost - Pruned trials: 0
12-13 17:36 - XGBoost - Failed trials: 1
12-13 17:36 - Training XGBoost (Tuned)...
12-13 17:36 - Training completed for XGBoost (Tuned).
12-13 17:37 - Predictions made for XGBoost (Tuned).
12-13 17:37 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-13 17:37 - 
XGBoost (Tuned) Evaluation:
12-13 17:37 -   Accuracy                  : 0.9262
12-13 17:37 -   Precision                 : 0.1546
12-13 17:37 -   Recall                    : 0.7865
12-13 17:37 -   F1 Score                  : 0.2584
12-13 17:37 -   Mean Absolute Error       : 0.0738
12-13 17:37 -   Root Mean Squared Error   : 0.2717
12-13 17:37 -   AUC-ROC                   : 0.9407
12-13 17:37 -   Specificity               : 0.9285
12-13 17:37 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-13 17:37 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-13 17:37 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-13 17:37 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-13 17:37 - Saved plot: XGBoost_(Tuned)_calibration.png
12-13 17:37 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-13 17:37 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 17:37 - Missing values heatmap saved to reports/evaluations/run_20241213_171807/XGBoost (Tuned)_missing_values_heatmap.png
12-13 17:37 - Saved plot: XGBoost_(Tuned)_temporal_patient_106058.png
12-13 17:37 - Saved plot: XGBoost_(Tuned)_temporal_patient_110736.png
12-13 17:37 - Saved plot: XGBoost_(Tuned)_temporal_patient_4827.png
12-13 17:37 - Saved plot: XGBoost_(Tuned)_temporal_patient_109959.png
12-13 17:37 - Saved plot: XGBoost_(Tuned)_temporal_patient_18872.png
12-13 17:37 - Saved temporal progression plots for 5 patients
12-13 17:37 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-13 17:37 - Saved error analysis plots to reports/evaluations/run_20241213_171807
12-13 17:37 - Saved feature interaction plots for top 5 pairs
12-13 17:37 - No sepsis patients have predictions for timeline plots.
12-13 17:37 - Saved evaluation metrics to reports/evaluations/run_20241213_171807/XGBoost (Tuned)_metrics.json

12-13 17:37 - Evaluation completed for XGBoost (Tuned).
12-13 17:37 - Saved hyperparameters to reports/evaluations/run_20241213_171807/xgboost_tuned_params.json
12-13 17:37 - Saved trained models to checkpoints/trained_models.pkl
12-13 17:37 - Saved updated Optuna studies to checkpoints/optuna_studies.pkl
12-13 17:37 - Saved trial data to reports/evaluations/run_20241213_171807/random_forest_optimization_optimization_trials.csv
12-13 17:37 - Saved trial data to reports/evaluations/run_20241213_171807/logistic_regression_optimization_optimization_trials.csv
12-13 17:37 - Saved trial data to reports/evaluations/run_20241213_171807/xgboost_optimization_optimization_trials.csv
ERROR fixed
12-13 18:27 - ================================================================================
12-13 18:29 - ================================================================================
12-13 18:29 - Starting Phase: Main
12-13 18:29 - --------------------------------------------------------------------------------
12-13 18:29 - Initial Memory Usage: 213.55 MB
12-13 18:29 - Starting Sepsis Prediction Pipeline
12-13 18:29 - Reports and metrics will be saved to: reports/evaluations/run_20241213_182951
12-13 18:29 - Loading preprocessed data from checkpoint.
12-13 18:29 - Loading resampled data from checkpoint.
12-13 18:29 - Loading Optuna studies from checkpoint.
12-13 18:29 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-13 18:29 - Optimizing Random Forest hyperparameters with Optuna.
12-13 18:34 - Best Random Forest parameters: {'n_estimators': 437, 'max_depth': 30, 'min_samples_split': 11, 'min_samples_leaf': 3, 'max_features': 'log2'}
12-13 18:34 - Random Forest - Total trials: 8
12-13 18:34 - Random Forest - Completed trials: 8
12-13 18:34 - Random Forest - Pruned trials: 0
12-13 18:34 - Random Forest - Failed trials: 0
12-13 18:34 - Training Random Forest (Tuned)...
12-13 18:37 - Training completed for Random Forest (Tuned).
12-13 18:37 - Predictions made for Random Forest (Tuned).
12-13 18:37 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-13 18:37 - 
Random Forest (Tuned) Evaluation:
12-13 18:37 -   Accuracy                  : 0.9711
12-13 18:37 -   Precision                 : 0.2907
12-13 18:37 -   Recall                    : 0.5330
12-13 18:37 -   F1 Score                  : 0.3762
12-13 18:37 -   Mean Absolute Error       : 0.0289
12-13 18:37 -   Root Mean Squared Error   : 0.1700
12-13 18:37 -   AUC-ROC                   : 0.9534
12-13 18:37 -   Specificity               : 0.9784
12-13 18:37 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-13 18:37 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-13 18:37 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-13 18:37 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-13 18:37 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-13 18:37 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-13 18:37 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 18:37 - Missing values heatmap saved to reports/evaluations/run_20241213_182951/Random Forest (Tuned)_missing_values_heatmap.png
12-13 18:37 - Saved plot: Random_Forest_(Tuned)_temporal_patient_103365.png
12-13 18:37 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119022.png
12-13 18:37 - Saved plot: Random_Forest_(Tuned)_temporal_patient_2720.png
12-13 18:37 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19437.png
12-13 18:37 - Saved plot: Random_Forest_(Tuned)_temporal_patient_105885.png
12-13 18:37 - Saved temporal progression plots for 5 patients
12-13 18:37 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-13 18:37 - Saved error analysis plots to reports/evaluations/run_20241213_182951
12-13 18:38 - Saved feature interaction plots for top 5 pairs
12-13 18:38 - No sepsis patients have predictions for timeline plots.
12-13 18:38 - Saved evaluation metrics to reports/evaluations/run_20241213_182951/Random Forest (Tuned)_metrics.json

12-13 18:38 - Evaluation completed for Random Forest (Tuned).
12-13 18:38 - New best model: Random Forest (Tuned) with F1 Score: 0.3762
12-13 18:38 - Saved hyperparameters to reports/evaluations/run_20241213_182951/random_forest_tuned_params.json
12-13 18:38 - Optimizing Logistic Regression hyperparameters with Optuna.
12-13 18:38 - Best Logistic Regression parameters: {'penalty': 'elasticnet', 'C': 0.21956410310260677, 'max_iter': 520, 'tol': 0.00017962160461897637, 'l1_ratio': 0.46663841712083964}
12-13 18:38 - Logistic Regression - Total trials: 8
12-13 18:38 - Logistic Regression - Completed trials: 8
12-13 18:38 - Logistic Regression - Pruned trials: 0
12-13 18:38 - Logistic Regression - Failed trials: 0
12-13 18:38 - Training Logistic Regression (Tuned)...
12-13 18:39 - Training completed for Logistic Regression (Tuned).
12-13 18:39 - Predictions made for Logistic Regression (Tuned).
12-13 18:39 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-13 18:39 - 
Logistic Regression (Tuned) Evaluation:
12-13 18:39 -   Accuracy                  : 0.9462
12-13 18:39 -   Precision                 : 0.1906
12-13 18:39 -   Recall                    : 0.7050
12-13 18:39 -   F1 Score                  : 0.3001
12-13 18:39 -   Mean Absolute Error       : 0.0538
12-13 18:39 -   Root Mean Squared Error   : 0.2319
12-13 18:39 -   AUC-ROC                   : 0.8967
12-13 18:39 -   Specificity               : 0.9502
12-13 18:39 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-13 18:39 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-13 18:39 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-13 18:39 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-13 18:39 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-13 18:39 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-13 18:39 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 18:39 - Missing values heatmap saved to reports/evaluations/run_20241213_182951/Logistic Regression (Tuned)_missing_values_heatmap.png
12-13 18:39 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_103265.png
12-13 18:39 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_114260.png
12-13 18:39 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_19970.png
12-13 18:39 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_8710.png
12-13 18:39 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_1245.png
12-13 18:39 - Saved temporal progression plots for 5 patients
12-13 18:39 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-13 18:39 - Saved error analysis plots to reports/evaluations/run_20241213_182951
12-13 18:39 - Saved feature interaction plots for top 5 pairs
12-13 18:39 - No sepsis patients have predictions for timeline plots.
12-13 18:39 - Saved evaluation metrics to reports/evaluations/run_20241213_182951/Logistic Regression (Tuned)_metrics.json

12-13 18:39 - Evaluation completed for Logistic Regression (Tuned).
12-13 18:39 - Saved hyperparameters to reports/evaluations/run_20241213_182951/logistic_regression_tuned_params.json
12-13 18:39 - Optimizing XGBoost hyperparameters with Optuna.
12-13 18:40 - Best XGBoost parameters: {'n_estimators': 360, 'max_depth': 6, 'learning_rate': 0.119527718013466, 'subsample': 0.8562833575504147, 'colsample_bytree': 0.5953210534503394, 'gamma': 3.775219533080583, 'reg_alpha': 0.9682079285262276, 'reg_lambda': 0.7909075717648127}
12-13 18:40 - XGBoost - Total trials: 7
12-13 18:40 - XGBoost - Completed trials: 6
12-13 18:40 - XGBoost - Pruned trials: 0
12-13 18:40 - XGBoost - Failed trials: 1
12-13 18:40 - Training XGBoost (Tuned)...
12-13 18:40 - Training completed for XGBoost (Tuned).
12-13 18:40 - Predictions made for XGBoost (Tuned).
12-13 18:40 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-13 18:40 - 
XGBoost (Tuned) Evaluation:
12-13 18:40 -   Accuracy                  : 0.9262
12-13 18:40 -   Precision                 : 0.1546
12-13 18:40 -   Recall                    : 0.7865
12-13 18:40 -   F1 Score                  : 0.2584
12-13 18:40 -   Mean Absolute Error       : 0.0738
12-13 18:40 -   Root Mean Squared Error   : 0.2717
12-13 18:40 -   AUC-ROC                   : 0.9407
12-13 18:40 -   Specificity               : 0.9285
12-13 18:40 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-13 18:40 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-13 18:40 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-13 18:40 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-13 18:40 - Saved plot: XGBoost_(Tuned)_calibration.png
12-13 18:40 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-13 18:40 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 18:40 - Missing values heatmap saved to reports/evaluations/run_20241213_182951/XGBoost (Tuned)_missing_values_heatmap.png
12-13 18:40 - Saved plot: XGBoost_(Tuned)_temporal_patient_2220.png
12-13 18:40 - Saved plot: XGBoost_(Tuned)_temporal_patient_5191.png
12-13 18:40 - Saved plot: XGBoost_(Tuned)_temporal_patient_12970.png
12-13 18:40 - Saved plot: XGBoost_(Tuned)_temporal_patient_614.png
12-13 18:40 - Saved plot: XGBoost_(Tuned)_temporal_patient_108217.png
12-13 18:40 - Saved temporal progression plots for 5 patients
12-13 18:40 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-13 18:40 - Saved error analysis plots to reports/evaluations/run_20241213_182951
12-13 18:40 - Saved feature interaction plots for top 5 pairs
12-13 18:40 - No sepsis patients have predictions for timeline plots.
12-13 18:40 - Saved evaluation metrics to reports/evaluations/run_20241213_182951/XGBoost (Tuned)_metrics.json

12-13 18:40 - Evaluation completed for XGBoost (Tuned).
12-13 18:40 - Saved hyperparameters to reports/evaluations/run_20241213_182951/xgboost_tuned_params.json
12-13 18:40 - Saved trained models to checkpoints/trained_models.pkl
12-13 18:40 - Saved updated Optuna studies to checkpoints/optuna_studies.pkl
12-13 18:40 - Saved trial data to reports/evaluations/run_20241213_182951/random_forest_optimization_optimization_trials.csv
12-13 18:40 - Saved trial data to reports/evaluations/run_20241213_182951/logistic_regression_optimization_optimization_trials.csv
12-13 18:40 - Saved trial data to reports/evaluations/run_20241213_182951/xgboost_optimization_optimization_trials.csv
12-13 18:40 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-13 18:40 - Predictions made with Random Forest (Tuned) on test set.
12-13 18:40 - An error occurred during final evaluation: local variable 'df_test' referenced before assignment
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1258, in main
    df_test_with_predictions = df_test.copy()  # Use original df_test
UnboundLocalError: local variable 'df_test' referenced before assignment
12-13 18:40 - An error occurred: local variable 'df_test' referenced before assignment
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1258, in main
    df_test_with_predictions = df_test.copy()  # Use original df_test
UnboundLocalError: local variable 'df_test' referenced before assignment
12-13 18:40 - Phase Failed: Main
12-13 18:40 - Error: local variable 'df_test' referenced before assignment
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1258, in main
    df_test_with_predictions = df_test.copy()  # Use original df_test
UnboundLocalError: local variable 'df_test' referenced before assignment
12-13 18:40 - ================================================================================
12-13 18:53 - ================================================================================
12-13 18:53 - Starting Phase: Main
12-13 18:53 - --------------------------------------------------------------------------------
12-13 18:53 - Initial Memory Usage: 214.27 MB
12-13 18:53 - Starting Sepsis Prediction Pipeline
12-13 18:53 - Reports and metrics will be saved to: reports/evaluations/run_20241213_185346
12-13 18:53 - Loading and preprocessing data.
12-13 18:53 - Splitting data into training, validation, and testing sets
12-13 18:54 - Starting step: Preprocessing training data
12-13 18:57 - Completed step: Preprocessing training data (Duration: 215.64s)
12-13 18:57 - Starting step: Preprocessing validation data
12-13 18:57 - Completed step: Preprocessing validation data (Duration: 7.12s)
12-13 18:57 - Starting step: Preprocessing testing data
12-13 18:57 - Completed step: Preprocessing testing data (Duration: 7.28s)
12-13 18:57 - Saved preprocessed data to checkpoints/preprocessed_data.pkl
12-13 18:57 - Loading resampled data from checkpoint.
12-13 18:57 - Loading trained models from checkpoint.
12-13 18:57 - Best model so far: Random Forest (Tuned) with F1 Score: 0.3762
12-13 18:57 - --------------------------------------------------------------------------------
12-13 18:57 - Phase Complete: Main
12-13 18:57 - Duration: 247.40 seconds
12-13 18:57 - Final Memory Usage: 1408.42 MB
12-13 18:57 - Memory Change: +1194.16 MB
12-13 18:57 - ================================================================================
12-13 20:15 - ================================================================================
12-13 20:15 - Starting Phase: Main
12-13 20:15 - --------------------------------------------------------------------------------
12-13 20:15 - Initial Memory Usage: 213.73 MB
12-13 20:15 - Starting Sepsis Prediction Pipeline
12-13 20:15 - Reports and metrics will be saved to: reports/evaluations/run_20241213_201502
12-13 20:15 - Loading preprocessed data from checkpoint.
12-13 20:15 - Loading resampled data from checkpoint.
12-13 20:15 - Loading trained models from checkpoint.
12-13 20:15 - Best model so far: Random Forest (Tuned) with F1 Score: 0.3762
12-13 20:15 - --------------------------------------------------------------------------------
12-13 20:15 - Phase Complete: Main
12-13 20:15 - Duration: 1.23 seconds
12-13 20:15 - Final Memory Usage: 632.72 MB
12-13 20:15 - Memory Change: +418.98 MB
12-13 20:15 - ================================================================================
12-13 20:56 - ================================================================================
12-13 20:56 - Starting Phase: Main
12-13 20:56 - --------------------------------------------------------------------------------
12-13 20:56 - Initial Memory Usage: 213.61 MB
12-13 20:56 - Starting Sepsis Prediction Pipeline
12-13 20:56 - Initial Memory Usage: 213.62 MB
12-13 20:56 - Reports and metrics will be saved to: reports/evaluations/run_20241213_205654
12-13 20:56 - Loading and preprocessing data.
12-13 20:56 - Splitting data into training, validation, and testing sets
12-13 20:57 - ================================================================================
12-13 20:57 - Starting Phase: Main
12-13 20:57 - --------------------------------------------------------------------------------
12-13 20:57 - Initial Memory Usage: 213.41 MB
12-13 20:57 - Starting Sepsis Prediction Pipeline
12-13 20:57 - Initial Memory Usage: 213.42 MB
12-13 20:57 - Reports and metrics will be saved to: reports/evaluations/run_20241213_205731
12-13 20:57 - Loading and preprocessing data.
12-13 20:57 - Splitting data into training, validation, and testing sets
12-13 20:57 - Starting step: Preprocessing training data
12-13 20:58 - ================================================================================
12-13 20:58 - Starting Phase: Main
12-13 20:58 - --------------------------------------------------------------------------------
12-13 20:58 - Initial Memory Usage: 215.38 MB
12-13 20:58 - Starting Sepsis Prediction Pipeline
12-13 20:58 - Initial Memory Usage: 215.41 MB
12-13 20:58 - Reports and metrics will be saved to: reports/evaluations/run_20241213_205811
12-13 20:58 - Loading and preprocessing data.
12-13 20:58 - Splitting data into training, validation, and testing sets
12-13 20:58 - Starting step: Preprocessing training data
12-13 20:58 - ================================================================================
12-13 20:58 - Starting Phase: Main
12-13 20:58 - --------------------------------------------------------------------------------
12-13 20:58 - Initial Memory Usage: 213.88 MB
12-13 20:58 - Starting Sepsis Prediction Pipeline
12-13 20:58 - Initial Memory Usage: 213.91 MB
12-13 20:58 - Reports and metrics will be saved to: reports/evaluations/run_20241213_205854
12-13 20:58 - Loading and preprocessing data.
12-13 20:58 - Splitting data into training, validation, and testing sets
12-13 20:59 - Starting step: Preprocessing training data
12-13 21:05 - ================================================================================
12-13 21:05 - Starting Phase: Main
12-13 21:05 - --------------------------------------------------------------------------------
12-13 21:05 - Initial Memory Usage: 213.47 MB
12-13 21:05 - Starting Sepsis Prediction Pipeline
12-13 21:05 - Initial Memory Usage: 213.47 MB
12-13 21:05 - Reports and metrics will be saved to: reports/evaluations/run_20241213_210538
12-13 21:05 - Loading and preprocessing data.
12-13 21:05 - Splitting data into training, validation, and testing sets
12-13 21:05 - Starting step: Preprocessing training data
12-13 21:09 - Completed step: Preprocessing training data (Duration: 213.00s)
12-13 21:09 - Starting step: Preprocessing validation data
12-13 21:09 - Completed step: Preprocessing validation data (Duration: 7.16s)
12-13 21:09 - Starting step: Preprocessing testing data
12-13 21:09 - Completed step: Preprocessing testing data (Duration: 7.30s)
12-13 21:09 - Saved preprocessed data to checkpoints/preprocessed_data_20241213_210538.pkl
12-13 21:09 - Applying SMOTEENN to training data.
12-13 21:12 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-13 21:12 - Saved resampled data to checkpoints/resampled_data_20241213_210538.pkl
12-13 21:12 - Initializing new Optuna studies.
12-13 21:12 - Saved Optuna studies to checkpoints/optuna_studies_20241213_210538.pkl
12-13 21:12 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-13 21:12 - Optimizing Random Forest hyperparameters with Optuna.
12-13 22:26 - Best Random Forest parameters: {'n_estimators': 480, 'max_depth': 19, 'min_samples_split': 7, 'min_samples_leaf': 3, 'max_features': 'log2'}
12-13 22:26 - Random Forest - Total trials: 10
12-13 22:26 - Random Forest - Completed trials: 10
12-13 22:26 - Random Forest - Pruned trials: 0
12-13 22:26 - Random Forest - Failed trials: 0
12-13 22:26 - Training Random Forest (Tuned)...
12-13 22:29 - Training completed for Random Forest (Tuned).
12-13 22:29 - Predictions made for Random Forest (Tuned).
12-13 22:29 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-13 22:29 - 
Random Forest (Tuned) Evaluation:
12-13 22:29 -   Accuracy                  : 0.9695
12-13 22:29 -   Precision                 : 0.2860
12-13 22:29 -   Recall                    : 0.5791
12-13 22:29 -   F1 Score                  : 0.3829
12-13 22:29 -   Mean Absolute Error       : 0.0305
12-13 22:29 -   Root Mean Squared Error   : 0.1747
12-13 22:29 -   AUC-ROC                   : 0.9529
12-13 22:29 -   Specificity               : 0.9760
12-13 22:29 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-13 22:29 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-13 22:29 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-13 22:29 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-13 22:29 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-13 22:29 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-13 22:29 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 22:29 - Missing values heatmap saved to reports/evaluations/run_20241213_210538/Random Forest (Tuned)_missing_values_heatmap.png
12-13 22:29 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-13 22:29 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-13 22:29 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-13 22:29 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-13 22:29 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-13 22:29 - Saved temporal progression plots for 5 patients
12-13 22:29 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-13 22:29 - Saved error analysis plots to reports/evaluations/run_20241213_210538
12-13 22:30 - Saved feature interaction plots for top 5 pairs
12-13 22:30 - No sepsis patients have predictions for timeline plots.
12-13 22:30 - Saved evaluation metrics to reports/evaluations/run_20241213_210538/Random Forest (Tuned)_metrics.json

12-13 22:30 - Evaluation completed for Random Forest (Tuned).
12-13 22:30 - New best model: Random Forest (Tuned) with F1 Score: 0.3829
12-13 22:30 - Saved hyperparameters to reports/evaluations/run_20241213_210538/random_forest_tuned_params.json
12-13 22:30 - Optimizing Logistic Regression hyperparameters with Optuna.
12-13 22:36 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 29.363955482169217, 'max_iter': 1406, 'tol': 0.00032256290283729606}
12-13 22:36 - Logistic Regression - Total trials: 10
12-13 22:36 - Logistic Regression - Completed trials: 10
12-13 22:36 - Logistic Regression - Pruned trials: 0
12-13 22:36 - Logistic Regression - Failed trials: 0
12-13 22:36 - Training Logistic Regression (Tuned)...
12-13 22:36 - Training completed for Logistic Regression (Tuned).
12-13 22:36 - Predictions made for Logistic Regression (Tuned).
12-13 22:36 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-13 22:36 - 
Logistic Regression (Tuned) Evaluation:
12-13 22:36 -   Accuracy                  : 0.9463
12-13 22:36 -   Precision                 : 0.1907
12-13 22:36 -   Recall                    : 0.7050
12-13 22:36 -   F1 Score                  : 0.3002
12-13 22:36 -   Mean Absolute Error       : 0.0537
12-13 22:36 -   Root Mean Squared Error   : 0.2318
12-13 22:36 -   AUC-ROC                   : 0.8967
12-13 22:36 -   Specificity               : 0.9503
12-13 22:36 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-13 22:36 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-13 22:36 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-13 22:36 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-13 22:36 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-13 22:36 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-13 22:36 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 22:36 - Missing values heatmap saved to reports/evaluations/run_20241213_210538/Logistic Regression (Tuned)_missing_values_heatmap.png
12-13 22:36 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-13 22:36 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-13 22:36 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-13 22:36 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-13 22:36 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-13 22:36 - Saved temporal progression plots for 5 patients
12-13 22:36 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-13 22:36 - Saved error analysis plots to reports/evaluations/run_20241213_210538
12-13 22:37 - Saved feature interaction plots for top 5 pairs
12-13 22:37 - No sepsis patients have predictions for timeline plots.
12-13 22:37 - Saved evaluation metrics to reports/evaluations/run_20241213_210538/Logistic Regression (Tuned)_metrics.json

12-13 22:37 - Evaluation completed for Logistic Regression (Tuned).
12-13 22:37 - Saved hyperparameters to reports/evaluations/run_20241213_210538/logistic_regression_tuned_params.json
12-13 22:37 - Optimizing XGBoost hyperparameters with Optuna.
12-13 22:40 - Best XGBoost parameters: {'n_estimators': 338, 'max_depth': 8, 'learning_rate': 0.16902518037374925, 'subsample': 0.8701688482044616, 'colsample_bytree': 0.6701347117764145, 'gamma': 0.21014101892587955, 'reg_alpha': 0.06923646746704126, 'reg_lambda': 0.4268922983052541}
12-13 22:40 - XGBoost - Total trials: 10
12-13 22:40 - XGBoost - Completed trials: 10
12-13 22:40 - XGBoost - Pruned trials: 0
12-13 22:40 - XGBoost - Failed trials: 0
12-13 22:40 - Training XGBoost (Tuned)...
12-13 22:41 - Training completed for XGBoost (Tuned).
12-13 22:41 - Predictions made for XGBoost (Tuned).
12-13 22:41 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-13 22:41 - 
XGBoost (Tuned) Evaluation:
12-13 22:41 -   Accuracy                  : 0.9562
12-13 22:41 -   Precision                 : 0.2323
12-13 22:41 -   Recall                    : 0.7275
12-13 22:41 -   F1 Score                  : 0.3522
12-13 22:41 -   Mean Absolute Error       : 0.0438
12-13 22:41 -   Root Mean Squared Error   : 0.2092
12-13 22:41 -   AUC-ROC                   : 0.9436
12-13 22:41 -   Specificity               : 0.9600
12-13 22:41 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-13 22:41 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-13 22:41 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-13 22:41 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-13 22:41 - Saved plot: XGBoost_(Tuned)_calibration.png
12-13 22:41 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-13 22:41 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-13 22:41 - Missing values heatmap saved to reports/evaluations/run_20241213_210538/XGBoost (Tuned)_missing_values_heatmap.png
12-13 22:41 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-13 22:41 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-13 22:41 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-13 22:41 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-13 22:41 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-13 22:41 - Saved temporal progression plots for 5 patients
12-13 22:41 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-13 22:41 - Saved error analysis plots to reports/evaluations/run_20241213_210538
12-13 22:41 - Saved feature interaction plots for top 5 pairs
12-13 22:41 - No sepsis patients have predictions for timeline plots.
12-13 22:41 - Saved evaluation metrics to reports/evaluations/run_20241213_210538/XGBoost (Tuned)_metrics.json

12-13 22:41 - Evaluation completed for XGBoost (Tuned).
12-13 22:41 - Saved hyperparameters to reports/evaluations/run_20241213_210538/xgboost_tuned_params.json
12-13 22:41 - Saved trained models to checkpoints/trained_models_20241213_210538.pkl
12-13 22:41 - Saved updated Optuna studies to checkpoints/optuna_studies_20241213_210538.pkl
12-13 22:41 - Saved trial data to reports/evaluations/run_20241213_210538/random_forest_optimization_optimization_trials.csv
12-13 22:41 - Saved trial data to reports/evaluations/run_20241213_210538/logistic_regression_optimization_optimization_trials.csv
12-13 22:41 - Saved trial data to reports/evaluations/run_20241213_210538/xgboost_optimization_optimization_trials.csv
12-13 22:41 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-13 22:41 - Predictions made with Random Forest (Tuned) on test set.
12-13 22:41 - 
Final_random_forest_(tuned) Evaluation:
12-13 22:41 -   Accuracy                  : 0.9849
12-13 22:41 -   Precision                 : 0.5280
12-13 22:41 -   Recall                    : 0.5948
12-13 22:41 -   F1 Score                  : 0.5594
12-13 22:41 -   Mean Absolute Error       : 0.0151
12-13 22:41 -   Root Mean Squared Error   : 0.1229
12-13 22:41 -   AUC-ROC                   : 0.9760
12-13 22:41 -   Specificity               : 0.9913
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-13 22:41 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-13 22:41 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-13 22:41 - Missing values heatmap saved to reports/evaluations/run_20241213_210538/Final_random_forest_(tuned)_missing_values_heatmap.png
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-13 22:41 - Saved temporal progression plots for 5 patients
12-13 22:41 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-13 22:41 - Saved error analysis plots to reports/evaluations/run_20241213_210538
12-13 22:42 - Saved feature interaction plots for top 5 pairs
12-13 22:42 - No sepsis patients have predictions for timeline plots.
12-13 22:42 - Saved evaluation metrics to reports/evaluations/run_20241213_210538/Final_random_forest_(tuned)_metrics.json

12-13 22:42 - Final evaluation completed for Random Forest (Tuned).
12-13 22:42 - An error occurred during final evaluation: Unknown format code 'f' for object of type 'str'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1315, in main
    model=best_model_pipeline,
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 428, in generate_model_card
    f.write(f"| AUPRC | {metrics.get('AUPRC', 'N/A'):.4f} |\n")
ValueError: Unknown format code 'f' for object of type 'str'
12-13 22:42 - An error occurred: Unknown format code 'f' for object of type 'str'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1315, in main
    model=best_model_pipeline,
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 428, in generate_model_card
    f.write(f"| AUPRC | {metrics.get('AUPRC', 'N/A'):.4f} |\n")
ValueError: Unknown format code 'f' for object of type 'str'
12-13 22:42 - Phase Complete: Main
12-13 22:42 - Duration: 5816.57 seconds
12-13 22:42 - Final Memory Usage: 773.75 MB
12-13 22:42 - Memory Change: +560.28 MB
12-13 22:42 - Phase Failed: Main
12-13 22:42 - Error: Unknown format code 'f' for object of type 'str'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1315, in main
    model=best_model_pipeline,
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 428, in generate_model_card
    f.write(f"| AUPRC | {metrics.get('AUPRC', 'N/A'):.4f} |\n")
ValueError: Unknown format code 'f' for object of type 'str'
12-13 22:42 - ================================================================================
12-13 23:15 - ================================================================================
12-13 23:15 - Starting Phase: Main
12-13 23:15 - --------------------------------------------------------------------------------
12-13 23:15 - Initial Memory Usage: 216.06 MB
12-13 23:15 - Starting Sepsis Prediction Pipeline
12-13 23:15 - Initial Memory Usage: 216.06 MB
12-13 23:15 - Reports and metrics will be saved to: reports/evaluations/run_20241213_231511
12-13 23:15 - Loading and preprocessing data.
12-13 23:15 - Splitting data into training, validation, and testing sets
12-13 23:15 - Starting step: Preprocessing training data
12-13 23:27 - Completed step: Preprocessing training data (Duration: 732.96s)
12-13 23:27 - Starting step: Preprocessing validation data
12-13 23:27 - Completed step: Preprocessing validation data (Duration: 7.67s)
12-13 23:27 - Starting step: Preprocessing testing data
12-13 23:27 - Completed step: Preprocessing testing data (Duration: 7.66s)
12-13 23:27 - Saved preprocessed data to checkpoints/preprocessed_data_20241213_231511.pkl
12-13 23:27 - Applying SMOTEENN to training data.
12-13 23:31 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-13 23:31 - Saved resampled data to checkpoints/resampled_data_20241213_231511.pkl
12-13 23:31 - Initializing new Optuna studies.
12-13 23:31 - Saved Optuna studies to checkpoints/optuna_studies_20241213_231511.pkl
12-13 23:31 - Starting Optuna hyperparameter tuning with 5 parallel jobs.
12-13 23:31 - Optimizing Random Forest hyperparameters with Optuna.
12-13 23:31 - Error during Random Forest optimization or training: CategoricalDistribution does not support dynamic value space.
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 908, in main
    studies["Random_Forest_Optimization"].optimize(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 100, in _optimize
    f.result()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 751, in rf_objective
    "max_features": trial.suggest_categorical(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/trial/_trial.py", line 402, in suggest_categorical
    return self._suggest(name, CategoricalDistribution(choices=choices))
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/trial/_trial.py", line 637, in _suggest
    storage.set_trial_param(trial_id, name, param_value_in_internal_repr, distribution)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_cached_storage.py", line 171, in set_trial_param
    self._backend.set_trial_param(trial_id, param_name, param_value_internal, distribution)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 585, in set_trial_param
    self._set_trial_param_without_commit(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 607, in _set_trial_param_without_commit
    trial_param.check_and_add(session, trial.study_id)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/models.py", line 353, in check_and_add
    self._check_compatibility_with_previous_trial_param_distributions(session, study_id)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/models.py", line 367, in _check_compatibility_with_previous_trial_param_distributions
    distributions.check_distribution_compatibility(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/distributions.py", line 678, in check_distribution_compatibility
    raise ValueError(
ValueError: CategoricalDistribution does not support dynamic value space.
12-13 23:31 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 00:07 - Best Logistic Regression parameters: {'penalty': 'elasticnet', 'C': 1.9309326922752332, 'max_iter': 896, 'tol': 9.26297451548514e-05, 'l1_ratio': 0.1770067876040133}
12-14 00:07 - Logistic Regression - Total trials: 18
12-14 00:07 - Logistic Regression - Completed trials: 18
12-14 00:07 - Logistic Regression - Pruned trials: 0
12-14 00:07 - Logistic Regression - Failed trials: 0
12-14 00:07 - Training Logistic Regression (Tuned)...
12-14 00:07 - Training completed for Logistic Regression (Tuned).
12-14 00:07 - Predictions made for Logistic Regression (Tuned).
12-14 00:07 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 00:07 - 
Logistic Regression (Tuned) Evaluation:
12-14 00:07 -   Accuracy                  : 0.9460
12-14 00:07 -   Precision                 : 0.1900
12-14 00:07 -   Recall                    : 0.7050
12-14 00:07 -   F1 Score                  : 0.2993
12-14 00:07 -   Mean Absolute Error       : 0.0540
12-14 00:07 -   Root Mean Squared Error   : 0.2323
12-14 00:07 -   AUC-ROC                   : 0.8963
12-14 00:07 -   AUPRC                     : 0.1447
12-14 00:07 -   Specificity               : 0.9501
12-14 00:07 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 00:07 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 00:07 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 00:07 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 00:07 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 00:07 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 00:07 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 00:07 - Missing values heatmap saved to reports/evaluations/run_20241213_231511/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 00:07 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_19434.png
12-14 00:07 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_119867.png
12-14 00:07 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113388.png
12-14 00:07 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16905.png
12-14 00:07 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_18504.png
12-14 00:07 - Saved temporal progression plots for 5 patients
12-14 00:07 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 00:07 - Saved error analysis plots to reports/evaluations/run_20241213_231511
12-14 00:08 - Saved feature interaction plots for top 5 pairs
12-14 00:08 - No sepsis patients have predictions for timeline plots.
12-14 00:08 - Saved evaluation metrics to reports/evaluations/run_20241213_231511/Logistic Regression (Tuned)_metrics.json

12-14 00:08 - Evaluation completed for Logistic Regression (Tuned).
12-14 00:08 - New best model: Logistic Regression (Tuned) with F1 Score: 0.2993
12-14 00:08 - Saved hyperparameters to reports/evaluations/run_20241213_231511/logistic_regression_tuned_params.json
12-14 00:08 - Optimizing XGBoost hyperparameters with Optuna.
12-14 00:08 - Error during XGBoost optimization or training: module 'optuna' has no attribute 'callbacks'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1146, in main
    if t.state == optuna.trial.TrialState.COMPLETE
AttributeError: module 'optuna' has no attribute 'callbacks'. Did you mean: '_callbacks'?
12-14 00:08 - Saved trained models to checkpoints/trained_models_20241213_231511.pkl
12-14 00:08 - Saved updated Optuna studies to checkpoints/optuna_studies_20241213_231511.pkl
12-14 00:08 - Saved trial data to reports/evaluations/run_20241213_231511/random_forest_optimization_optimization_trials.csv
12-14 00:08 - Saved trial data to reports/evaluations/run_20241213_231511/logistic_regression_optimization_optimization_trials.csv
12-14 00:08 - Saved trial data to reports/evaluations/run_20241213_231511/xgboost_optimization_optimization_trials.csv
12-14 00:08 - 
Performing final evaluation with best model: Logistic Regression (Tuned)
12-14 00:08 - Predictions made with Logistic Regression (Tuned) on test set.
12-14 00:08 - 
Final_logistic_regression_(tuned) Evaluation:
12-14 00:08 -   Accuracy                  : 0.9350
12-14 00:08 -   Precision                 : 0.1657
12-14 00:08 -   Recall                    : 0.7513
12-14 00:08 -   F1 Score                  : 0.2715
12-14 00:08 -   Mean Absolute Error       : 0.0650
12-14 00:08 -   Root Mean Squared Error   : 0.2550
12-14 00:08 -   AUC-ROC                   : 0.9011
12-14 00:08 -   AUPRC                     : 0.1066
12-14 00:08 -   Specificity               : 0.9380
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_confusion_matrix.png
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_confusion_matrix_normalized.png
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_roc_curve.png
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_precision_recall_curve.png
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_calibration.png
12-14 00:08 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 00:08 - Final_logistic_regression_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 00:08 - Missing values heatmap saved to reports/evaluations/run_20241213_231511/Final_logistic_regression_(tuned)_missing_values_heatmap.png
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_temporal_patient_9051.png
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_temporal_patient_112640.png
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_temporal_patient_13640.png
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_temporal_patient_116564.png
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_temporal_patient_119526.png
12-14 00:08 - Saved temporal progression plots for 5 patients
12-14 00:08 - Saved plot: Final_logistic_regression_(tuned)_error_analysis.png
12-14 00:08 - Saved error analysis plots to reports/evaluations/run_20241213_231511
12-14 00:09 - Saved feature interaction plots for top 5 pairs
12-14 00:09 - No sepsis patients have predictions for timeline plots.
12-14 00:09 - Saved evaluation metrics to reports/evaluations/run_20241213_231511/Final_logistic_regression_(tuned)_metrics.json

12-14 00:09 - Final evaluation completed for Logistic Regression (Tuned).
12-14 00:09 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 00:09 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 00:09 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 00:09 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 00:09 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 00:09 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 00:09 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 00:09 - Missing values heatmap saved to reports/evaluations/run_20241213_231511/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 00:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_18053.png
12-14 00:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_118522.png
12-14 00:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13882.png
12-14 00:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_118906.png
12-14 00:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_115627.png
12-14 00:09 - Saved temporal progression plots for 5 patients
12-14 00:09 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 00:09 - Saved error analysis plots to reports/evaluations/run_20241213_231511
12-14 00:09 - Error plotting feature interactions: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1070, in plot_feature_interactions
    """Save metrics to JSON file."""
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 00:09 - Error generating evaluation plots: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 303, in generate_evaluation_plots
    raise
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1070, in plot_feature_interactions
    """Save metrics to JSON file."""
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 00:09 - An error occurred during final evaluation: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1341, in main
    model=best_model_pipeline,  # Save the entire pipeline
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 431, in generate_model_card
    y_pred=pd.Series(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 303, in generate_evaluation_plots
    raise
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1070, in plot_feature_interactions
    """Save metrics to JSON file."""
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 00:09 - An error occurred: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1341, in main
    model=best_model_pipeline,  # Save the entire pipeline
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 431, in generate_model_card
    y_pred=pd.Series(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 303, in generate_evaluation_plots
    raise
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1070, in plot_feature_interactions
    """Save metrics to JSON file."""
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 00:09 - Phase Complete: Main
12-14 00:09 - Duration: 3250.33 seconds
12-14 00:09 - Final Memory Usage: 1924.52 MB
12-14 00:09 - Memory Change: +1708.45 MB
12-14 00:09 - Phase Failed: Main
12-14 00:09 - Error: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1341, in main
    model=best_model_pipeline,  # Save the entire pipeline
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 431, in generate_model_card
    y_pred=pd.Series(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 303, in generate_evaluation_plots
    raise
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1070, in plot_feature_interactions
    """Save metrics to JSON file."""
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 00:09 - ================================================================================
12-14 00:41 - ================================================================================
12-14 00:41 - Starting Phase: Main
12-14 00:41 - --------------------------------------------------------------------------------
12-14 00:41 - Initial Memory Usage: 216.23 MB
12-14 00:41 - Starting Sepsis Prediction Pipeline
12-14 00:41 - Initial Memory Usage: 216.23 MB
12-14 00:41 - Reports and metrics will be saved to: reports/evaluations/run_20241214_004157
12-14 00:41 - Loading and preprocessing data.
12-14 00:41 - Splitting data into training, validation, and testing sets
12-14 00:42 - Starting step: Preprocessing training data
12-14 00:50 - ================================================================================
12-14 00:50 - Starting Phase: Main
12-14 00:50 - --------------------------------------------------------------------------------
12-14 00:50 - Initial Memory Usage: 216.44 MB
12-14 00:50 - Starting Sepsis Prediction Pipeline
12-14 00:50 - Initial Memory Usage: 216.45 MB
12-14 00:50 - Reports and metrics will be saved to: reports/evaluations/run_20241214_005015
12-14 00:50 - Loading and preprocessing data.
12-14 00:50 - Splitting data into training, validation, and testing sets
12-14 00:50 - Starting step: Preprocessing training data
12-14 00:57 - ================================================================================
12-14 00:57 - Starting Phase: Main
12-14 00:57 - --------------------------------------------------------------------------------
12-14 00:57 - Initial Memory Usage: 214.17 MB
12-14 00:57 - Starting Sepsis Prediction Pipeline
12-14 00:57 - Initial Memory Usage: 214.19 MB
12-14 00:57 - Reports and metrics will be saved to: reports/evaluations/run_20241214_005726
12-14 00:57 - Loading and preprocessing data.
12-14 00:57 - Splitting data into training, validation, and testing sets
12-14 00:57 - Starting step: Preprocessing training data
12-14 01:09 - Completed step: Preprocessing training data (Duration: 723.91s)
12-14 01:09 - Starting step: Preprocessing validation data
12-14 01:09 - Completed step: Preprocessing validation data (Duration: 7.22s)
12-14 01:09 - Starting step: Preprocessing testing data
12-14 01:10 - Completed step: Preprocessing testing data (Duration: 7.35s)
12-14 01:10 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_005726.pkl
12-14 01:10 - Applying SMOTEENN to training data.
12-14 01:13 - Failed to save plot Resampled_Training_Data_class_distribution__after_resampling.png: [Errno 2] No such file or directory: '/Users/jeremy/Desktop/predicting-sepsis-main/reports/evaluations/run_20241214_005726/Resampled_Training_Data_class_distribution__after_resampling.png'
12-14 01:13 - Error plotting class distribution: [Errno 2] No such file or directory: '/Users/jeremy/Desktop/predicting-sepsis-main/reports/evaluations/run_20241214_005726/Resampled_Training_Data_class_distribution__after_resampling.png'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 379, in plot_class_distribution
    save_plot(plt, report_dir, filename, logger)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1114, in save_plot
    plt_obj.savefig(os.path.join(report_dir, filename))
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/pyplot.py", line 1228, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/figure.py", line 3395, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 2204, in print_figure
    result = print_method(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 2054, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py", line 496, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py", line 445, in _print_pil
    mpl.image.imsave(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/image.py", line 1676, in imsave
    image.save(fname, **pil_kwargs)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/PIL/Image.py", line 2600, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: '/Users/jeremy/Desktop/predicting-sepsis-main/reports/evaluations/run_20241214_005726/Resampled_Training_Data_class_distribution__after_resampling.png'
12-14 01:13 - An error occurred: [Errno 2] No such file or directory: '/Users/jeremy/Desktop/predicting-sepsis-main/reports/evaluations/run_20241214_005726/Resampled_Training_Data_class_distribution__after_resampling.png'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 631, in main
    model_name="Resampled Training Data",
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 379, in plot_class_distribution
    save_plot(plt, report_dir, filename, logger)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1114, in save_plot
    plt_obj.savefig(os.path.join(report_dir, filename))
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/pyplot.py", line 1228, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/figure.py", line 3395, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 2204, in print_figure
    result = print_method(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 2054, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py", line 496, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py", line 445, in _print_pil
    mpl.image.imsave(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/image.py", line 1676, in imsave
    image.save(fname, **pil_kwargs)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/PIL/Image.py", line 2600, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: '/Users/jeremy/Desktop/predicting-sepsis-main/reports/evaluations/run_20241214_005726/Resampled_Training_Data_class_distribution__after_resampling.png'
12-14 01:13 - Phase Complete: Main
12-14 01:13 - Duration: 951.89 seconds
12-14 01:13 - Final Memory Usage: 1540.95 MB
12-14 01:13 - Memory Change: +1326.77 MB
12-14 01:13 - Phase Failed: Main
12-14 01:13 - Error: [Errno 2] No such file or directory: '/Users/jeremy/Desktop/predicting-sepsis-main/reports/evaluations/run_20241214_005726/Resampled_Training_Data_class_distribution__after_resampling.png'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 631, in main
    model_name="Resampled Training Data",
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 379, in plot_class_distribution
    save_plot(plt, report_dir, filename, logger)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1114, in save_plot
    plt_obj.savefig(os.path.join(report_dir, filename))
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/pyplot.py", line 1228, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/figure.py", line 3395, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 2204, in print_figure
    result = print_method(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backend_bases.py", line 2054, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py", line 496, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/backends/backend_agg.py", line 445, in _print_pil
    mpl.image.imsave(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/matplotlib/image.py", line 1676, in imsave
    image.save(fname, **pil_kwargs)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/PIL/Image.py", line 2600, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: '/Users/jeremy/Desktop/predicting-sepsis-main/reports/evaluations/run_20241214_005726/Resampled_Training_Data_class_distribution__after_resampling.png'
12-14 01:13 - ================================================================================
12-14 01:42 - ================================================================================
12-14 01:42 - Starting Phase: Main
12-14 01:42 - --------------------------------------------------------------------------------
12-14 01:42 - Initial Memory Usage: 214.95 MB
12-14 01:42 - Starting Sepsis Prediction Pipeline
12-14 01:42 - Initial Memory Usage: 214.97 MB
12-14 01:42 - Reports and metrics will be saved to: reports/evaluations/run_20241214_014248
12-14 01:42 - Loading and preprocessing data.
12-14 01:42 - Splitting data into training, validation, and testing sets
12-14 01:43 - Starting step: Preprocessing training data
12-14 01:46 - ================================================================================
12-14 01:46 - Starting Phase: Main
12-14 01:46 - --------------------------------------------------------------------------------
12-14 01:46 - Initial Memory Usage: 215.66 MB
12-14 01:46 - Starting Sepsis Prediction Pipeline
12-14 01:46 - Initial Memory Usage: 215.66 MB
12-14 01:46 - Reports and metrics will be saved to: reports/evaluations/run_20241214_014605
12-14 01:46 - Loading and preprocessing data.
12-14 01:46 - Splitting data into training, validation, and testing sets
12-14 01:46 - Starting step: Preprocessing training data
12-14 02:07 - Completed step: Preprocessing training data (Duration: 1242.18s)
12-14 02:07 - Starting step: Preprocessing validation data
12-14 02:07 - Completed step: Preprocessing validation data (Duration: 7.18s)
12-14 02:07 - Starting step: Preprocessing testing data
12-14 02:07 - Completed step: Preprocessing testing data (Duration: 7.25s)
12-14 02:07 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_014605.pkl
12-14 02:07 - Applying SMOTEENN to training data.
12-14 02:10 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 02:10 - Saved resampled data to checkpoints/resampled_data_20241214_014605.pkl
12-14 02:10 - Initializing new Optuna studies.
12-14 02:10 - Saved Optuna studies to checkpoints/optuna_studies_20241214_014605.pkl
12-14 02:10 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 02:10 - Optimizing Random Forest hyperparameters with Optuna.
12-14 02:10 - Error during Random Forest optimization or training: CategoricalDistribution does not support dynamic value space.
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 885, in main
    studies["Random_Forest_Optimization"].optimize(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 743, in rf_objective
    "max_features": trial.suggest_categorical(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/trial/_trial.py", line 402, in suggest_categorical
    return self._suggest(name, CategoricalDistribution(choices=choices))
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/trial/_trial.py", line 637, in _suggest
    storage.set_trial_param(trial_id, name, param_value_in_internal_repr, distribution)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_cached_storage.py", line 171, in set_trial_param
    self._backend.set_trial_param(trial_id, param_name, param_value_internal, distribution)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 585, in set_trial_param
    self._set_trial_param_without_commit(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 607, in _set_trial_param_without_commit
    trial_param.check_and_add(session, trial.study_id)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/models.py", line 353, in check_and_add
    self._check_compatibility_with_previous_trial_param_distributions(session, study_id)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/models.py", line 367, in _check_compatibility_with_previous_trial_param_distributions
    distributions.check_distribution_compatibility(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/distributions.py", line 678, in check_distribution_compatibility
    raise ValueError(
ValueError: CategoricalDistribution does not support dynamic value space.
12-14 02:10 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 02:14 - ================================================================================
12-14 02:14 - Starting Phase: Main
12-14 02:14 - --------------------------------------------------------------------------------
12-14 02:14 - Initial Memory Usage: 215.61 MB
12-14 02:14 - Starting Sepsis Prediction Pipeline
12-14 02:14 - Initial Memory Usage: 215.61 MB
12-14 02:14 - Reports and metrics will be saved to: reports/evaluations/run_20241214_021425
12-14 02:14 - Loading and preprocessing data.
12-14 02:14 - Splitting data into training, validation, and testing sets
12-14 02:14 - Starting step: Preprocessing training data
12-14 02:16 - Error during Logistic Regression optimization or training: Should not reach.
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: attempt to write a readonly database

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 81, in _create_scoped_session
    session.commit()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2028, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4352, in flush
    self._flush(objects)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4487, in _flush
    with util.safe_reraise():
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    flush_context.execute()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) attempt to write a readonly database
[SQL: UPDATE trials SET state=?, datetime_complete=? WHERE trials.trial_id = ?]
[parameters: ('FAIL', '2024-12-14 02:16:36.184032', 43)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 209, in _run_trial
    frozen_trial = _tell_with_warning(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_tell.py", line 183, in _tell_with_warning
    study._storage.set_trial_state_values(frozen_trial._trial_id, state, values)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_cached_storage.py", line 187, in set_trial_state_values
    return self._backend.set_trial_state_values(trial_id, state=state, values=values)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 644, in set_trial_state_values
    with _create_scoped_session(self.scoped_session) as session:
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/contextlib.py", line 142, in __exit__
    next(self.gen)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 98, in _create_scoped_session
    raise optuna.exceptions.StorageInternalError(message) from e
optuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. 

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 997, in main
    studies["Logistic_Regression_Optimization"].optimize(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 241, in _run_trial
    assert False, "Should not reach."
AssertionError: Should not reach.
12-14 02:16 - Optimizing XGBoost hyperparameters with Optuna.
12-14 02:16 - Error during XGBoost optimization or training: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. 
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlite3.OperationalError: attempt to write a readonly database

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 81, in _create_scoped_session
    session.commit()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2028, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4352, in flush
    self._flush(objects)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4487, in _flush
    with util.safe_reraise():
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4448, in _flush
    flush_context.execute()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1418, in execute
    return meth(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) attempt to write a readonly database
[SQL: UPDATE study_user_attributes SET value_json=? WHERE study_user_attributes.study_user_attribute_id = ?]
[parameters: ('"2024-12-14T02:16:36.216304"', 18)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1110, in main
    studies["XGBoost_Optimization"].set_user_attr(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/study.py", line 707, in set_user_attr
    self._storage.set_study_user_attr(self._study_id, key, value)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_cached_storage.py", line 103, in set_study_user_attr
    self._backend.set_study_user_attr(study_id, key, value)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 312, in set_study_user_attr
    with _create_scoped_session(self.scoped_session, True) as session:
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/contextlib.py", line 142, in __exit__
    next(self.gen)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 98, in _create_scoped_session
    raise optuna.exceptions.StorageInternalError(message) from e
optuna.exceptions.StorageInternalError: An exception is raised during the commit. This typically happens due to invalid data in the commit, e.g. exceeding max length. 
12-14 02:16 - Saved trained models to checkpoints/trained_models_20241214_014605.pkl
12-14 02:16 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_014605.pkl
12-14 02:16 - Saved trial data to reports/evaluations/run_20241214_014605/random_forest_optimization_optimization_trials.csv
12-14 02:16 - Saved trial data to reports/evaluations/run_20241214_014605/logistic_regression_optimization_optimization_trials.csv
12-14 02:16 - Saved trial data to reports/evaluations/run_20241214_014605/xgboost_optimization_optimization_trials.csv
12-14 02:16 - No models were trained. Pipeline did not complete successfully.
12-14 02:16 - Sepsis Prediction Pipeline completed successfully.
12-14 02:16 - Phase Complete: Main
12-14 02:16 - Duration: 1830.85 seconds
12-14 02:16 - Final Memory Usage: 125.84 MB
12-14 02:16 - Memory Change: -89.81 MB
12-14 02:16 - --------------------------------------------------------------------------------
12-14 02:16 - Phase Complete: Main
12-14 02:16 - Duration: 1830.85 seconds
12-14 02:16 - Final Memory Usage: 125.89 MB
12-14 02:16 - Memory Change: -89.77 MB
12-14 02:16 - ================================================================================
12-14 02:17 - ================================================================================
12-14 02:17 - Starting Phase: Main
12-14 02:17 - --------------------------------------------------------------------------------
12-14 02:17 - Initial Memory Usage: 216.14 MB
12-14 02:17 - Starting Sepsis Prediction Pipeline
12-14 02:17 - Initial Memory Usage: 216.14 MB
12-14 02:17 - Reports and metrics will be saved to: reports/evaluations/run_20241214_021741
12-14 02:17 - Loading and preprocessing data.
12-14 02:17 - ================================================================================
12-14 02:17 - Starting Phase: Main
12-14 02:17 - --------------------------------------------------------------------------------
12-14 02:17 - Initial Memory Usage: 216.62 MB
12-14 02:17 - Starting Sepsis Prediction Pipeline
12-14 02:17 - Initial Memory Usage: 216.62 MB
12-14 02:17 - Reports and metrics will be saved to: reports/evaluations/run_20241214_021750
12-14 02:17 - Loading and preprocessing data.
12-14 02:17 - Splitting data into training, validation, and testing sets
12-14 02:18 - Starting step: Preprocessing training data
12-14 02:39 - Completed step: Preprocessing training data (Duration: 1284.97s)
12-14 02:39 - Starting step: Preprocessing validation data
12-14 02:39 - Completed step: Preprocessing validation data (Duration: 7.78s)
12-14 02:39 - Starting step: Preprocessing testing data
12-14 02:39 - Completed step: Preprocessing testing data (Duration: 7.90s)
12-14 02:39 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_021750.pkl
12-14 02:39 - Applying SMOTEENN to training data.
12-14 02:43 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 02:43 - Saved resampled data to checkpoints/resampled_data_20241214_021750.pkl
12-14 02:43 - Initializing new Optuna studies.
12-14 02:43 - Saved Optuna studies to checkpoints/optuna_studies_20241214_021750.pkl
12-14 02:43 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 02:43 - Optimizing Random Forest hyperparameters with Optuna.
12-14 03:44 - Best Random Forest parameters: {'n_estimators': 300, 'max_depth': 27, 'min_samples_split': 7, 'min_samples_leaf': 3, 'max_features': 'sqrt'}
12-14 03:44 - Random Forest - Total trials: 10
12-14 03:44 - Random Forest - Completed trials: 10
12-14 03:44 - Random Forest - Pruned trials: 0
12-14 03:44 - Random Forest - Failed trials: 0
12-14 03:44 - Training Random Forest (Tuned)...
12-14 03:47 - Training completed for Random Forest (Tuned).
12-14 03:47 - Predictions made for Random Forest (Tuned).
12-14 03:47 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 03:47 - 
Random Forest (Tuned) Evaluation:
12-14 03:47 -   Accuracy                  : 0.9721
12-14 03:47 -   Precision                 : 0.2988
12-14 03:47 -   Recall                    : 0.5257
12-14 03:47 -   F1 Score                  : 0.3811
12-14 03:47 -   Mean Absolute Error       : 0.0279
12-14 03:47 -   Root Mean Squared Error   : 0.1671
12-14 03:47 -   AUC-ROC                   : 0.9541
12-14 03:47 -   AUPRC                     : 0.3664
12-14 03:47 -   Specificity               : 0.9795
12-14 03:47 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 03:47 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 03:47 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 03:47 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 03:47 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 03:47 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 03:47 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 03:47 - Missing values heatmap saved to reports/evaluations/run_20241214_021750/Random Forest (Tuned)_missing_values_heatmap.png
12-14 03:47 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 03:47 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 03:47 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 03:47 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 03:47 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 03:47 - Saved temporal progression plots for 5 patients
12-14 03:47 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 03:47 - Saved error analysis plots to reports/evaluations/run_20241214_021750
12-14 03:47 - Saved feature interaction plots for top 5 pairs
12-14 03:47 - No sepsis patients have predictions for timeline plots.
12-14 03:47 - Saved evaluation metrics to reports/evaluations/run_20241214_021750/Random Forest (Tuned)_metrics.json

12-14 03:47 - Evaluation completed for Random Forest (Tuned).
12-14 03:47 - New best model: Random Forest (Tuned) with F1 Score: 0.3811
12-14 03:47 - Saved hyperparameters to reports/evaluations/run_20241214_021750/random_forest_tuned_params.json
12-14 03:47 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 04:09 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 04:09 - Logistic Regression - Total trials: 10
12-14 04:09 - Logistic Regression - Completed trials: 10
12-14 04:09 - Logistic Regression - Pruned trials: 0
12-14 04:09 - Logistic Regression - Failed trials: 0
12-14 04:09 - Training Logistic Regression (Tuned)...
12-14 04:09 - Training completed for Logistic Regression (Tuned).
12-14 04:09 - Predictions made for Logistic Regression (Tuned).
12-14 04:09 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 04:09 - 
Logistic Regression (Tuned) Evaluation:
12-14 04:09 -   Accuracy                  : 0.9460
12-14 04:09 -   Precision                 : 0.1902
12-14 04:09 -   Recall                    : 0.7063
12-14 04:09 -   F1 Score                  : 0.2997
12-14 04:09 -   Mean Absolute Error       : 0.0540
12-14 04:09 -   Root Mean Squared Error   : 0.2323
12-14 04:09 -   AUC-ROC                   : 0.8962
12-14 04:09 -   AUPRC                     : 0.1445
12-14 04:09 -   Specificity               : 0.9500
12-14 04:09 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 04:09 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 04:09 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 04:09 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 04:09 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 04:09 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 04:09 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 04:09 - Missing values heatmap saved to reports/evaluations/run_20241214_021750/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 04:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 04:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 04:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 04:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 04:09 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 04:09 - Saved temporal progression plots for 5 patients
12-14 04:09 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 04:09 - Saved error analysis plots to reports/evaluations/run_20241214_021750
12-14 04:09 - Saved feature interaction plots for top 5 pairs
12-14 04:09 - No sepsis patients have predictions for timeline plots.
12-14 04:09 - Saved evaluation metrics to reports/evaluations/run_20241214_021750/Logistic Regression (Tuned)_metrics.json

12-14 04:09 - Evaluation completed for Logistic Regression (Tuned).
12-14 04:09 - Saved hyperparameters to reports/evaluations/run_20241214_021750/logistic_regression_tuned_params.json
12-14 04:09 - Optimizing XGBoost hyperparameters with Optuna.
12-14 04:13 - Best XGBoost parameters: {'n_estimators': 470, 'max_depth': 10, 'learning_rate': 0.23783727342125796, 'subsample': 0.9249413832963282, 'colsample_bytree': 0.5694345181714191, 'gamma': 0.7439796805799659, 'reg_alpha': 0.8000500169568902, 'reg_lambda': 0.33413228169039866}
12-14 04:13 - XGBoost - Total trials: 10
12-14 04:13 - XGBoost - Completed trials: 10
12-14 04:13 - XGBoost - Pruned trials: 0
12-14 04:13 - XGBoost - Failed trials: 0
12-14 04:13 - Training XGBoost (Tuned)...
12-14 04:13 - Training completed for XGBoost (Tuned).
12-14 04:13 - Predictions made for XGBoost (Tuned).
12-14 04:13 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 04:13 - 
XGBoost (Tuned) Evaluation:
12-14 04:13 -   Accuracy                  : 0.9561
12-14 04:13 -   Precision                 : 0.2308
12-14 04:13 -   Recall                    : 0.7236
12-14 04:13 -   F1 Score                  : 0.3499
12-14 04:13 -   Mean Absolute Error       : 0.0439
12-14 04:13 -   Root Mean Squared Error   : 0.2096
12-14 04:13 -   AUC-ROC                   : 0.9438
12-14 04:13 -   AUPRC                     : 0.4444
12-14 04:13 -   Specificity               : 0.9599
12-14 04:13 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 04:13 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 04:13 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 04:13 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 04:13 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 04:13 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 04:13 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 04:13 - Missing values heatmap saved to reports/evaluations/run_20241214_021750/XGBoost (Tuned)_missing_values_heatmap.png
12-14 04:13 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 04:13 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 04:13 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 04:13 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 04:13 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 04:13 - Saved temporal progression plots for 5 patients
12-14 04:13 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 04:13 - Saved error analysis plots to reports/evaluations/run_20241214_021750
12-14 04:13 - Saved feature interaction plots for top 5 pairs
12-14 04:13 - No sepsis patients have predictions for timeline plots.
12-14 04:13 - Saved evaluation metrics to reports/evaluations/run_20241214_021750/XGBoost (Tuned)_metrics.json

12-14 04:13 - Evaluation completed for XGBoost (Tuned).
12-14 04:13 - Saved hyperparameters to reports/evaluations/run_20241214_021750/xgboost_tuned_params.json
12-14 04:13 - Saved trained models to checkpoints/trained_models_20241214_021750.pkl
12-14 04:13 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_021750.pkl
12-14 04:13 - Saved trial data to reports/evaluations/run_20241214_021750/random_forest_optimization_optimization_trials.csv
12-14 04:13 - Saved trial data to reports/evaluations/run_20241214_021750/logistic_regression_optimization_optimization_trials.csv
12-14 04:13 - Saved trial data to reports/evaluations/run_20241214_021750/xgboost_optimization_optimization_trials.csv
12-14 04:13 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 04:13 - Predictions made with Random Forest (Tuned) on test set.
12-14 04:13 - 
Final_random_forest_(tuned) Evaluation:
12-14 04:13 -   Accuracy                  : 0.9862
12-14 04:13 -   Precision                 : 0.5758
12-14 04:13 -   Recall                    : 0.5452
12-14 04:13 -   F1 Score                  : 0.5601
12-14 04:13 -   Mean Absolute Error       : 0.0138
12-14 04:13 -   Root Mean Squared Error   : 0.1175
12-14 04:13 -   AUC-ROC                   : 0.9757
12-14 04:13 -   AUPRC                     : 0.5957
12-14 04:13 -   Specificity               : 0.9934
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-14 04:13 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 04:13 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 04:13 - Missing values heatmap saved to reports/evaluations/run_20241214_021750/Final_random_forest_(tuned)_missing_values_heatmap.png
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-14 04:13 - Saved temporal progression plots for 5 patients
12-14 04:13 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-14 04:13 - Saved error analysis plots to reports/evaluations/run_20241214_021750
12-14 04:14 - Saved feature interaction plots for top 5 pairs
12-14 04:14 - No sepsis patients have predictions for timeline plots.
12-14 04:14 - Saved evaluation metrics to reports/evaluations/run_20241214_021750/Final_random_forest_(tuned)_metrics.json

12-14 04:14 - Final evaluation completed for Random Forest (Tuned).
12-14 04:14 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 04:14 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 04:14 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 04:14 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 04:14 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 04:14 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 04:14 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 04:14 - Missing values heatmap saved to reports/evaluations/run_20241214_021750/Random Forest (Tuned)_missing_values_heatmap.png
12-14 04:14 - Saved plot: Random_Forest_(Tuned)_temporal_patient_13491.png
12-14 04:14 - Saved plot: Random_Forest_(Tuned)_temporal_patient_109380.png
12-14 04:14 - Saved plot: Random_Forest_(Tuned)_temporal_patient_15235.png
12-14 04:14 - Saved plot: Random_Forest_(Tuned)_temporal_patient_100016.png
12-14 04:14 - Saved plot: Random_Forest_(Tuned)_temporal_patient_9513.png
12-14 04:14 - Saved temporal progression plots for 5 patients
12-14 04:14 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 04:14 - Saved error analysis plots to reports/evaluations/run_20241214_021750
12-14 04:14 - Error plotting feature interactions: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1070, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 04:14 - Error generating evaluation plots: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 303, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1070, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 04:14 - An error occurred during final evaluation: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1308, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 431, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 303, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1070, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 04:14 - An error occurred: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1308, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 431, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 303, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1070, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 04:14 - Phase Complete: Main
12-14 04:14 - Duration: 7002.92 seconds
12-14 04:14 - Final Memory Usage: 2341.33 MB
12-14 04:14 - Memory Change: +2124.70 MB
12-14 04:14 - Phase Failed: Main
12-14 04:14 - Error: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1308, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 431, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 303, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1070, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 04:14 - ================================================================================
12-14 11:13 - ================================================================================
12-14 11:13 - Starting Phase: Main
12-14 11:13 - --------------------------------------------------------------------------------
12-14 11:13 - Initial Memory Usage: 216.12 MB
12-14 11:13 - Starting Sepsis Prediction Pipeline
12-14 11:13 - Initial Memory Usage: 216.12 MB
12-14 11:13 - Reports and metrics will be saved to: reports/evaluations/run_20241214_111330
12-14 11:13 - Loading and preprocessing data.
12-14 11:13 - Splitting data into training, validation, and testing sets
12-14 11:13 - Starting step: Preprocessing training data
12-14 11:30 - ================================================================================
12-14 11:30 - Starting Phase: Main
12-14 11:30 - --------------------------------------------------------------------------------
12-14 11:30 - Initial Memory Usage: 213.38 MB
12-14 11:30 - Starting Sepsis Prediction Pipeline
12-14 11:30 - Reports and metrics will be saved to: reports/evaluations/run_20241214_113007
12-14 11:30 - Loading preprocessed data from checkpoint.
12-14 11:30 - An error occurred: too many values to unpack (expected 4)
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1922, in main
    df_train_processed, df_val_processed, df_test_processed, df_val_original = (
ValueError: too many values to unpack (expected 4)
12-14 11:30 - Phase Failed: Main
12-14 11:30 - Error: too many values to unpack (expected 4)
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1922, in main
    df_train_processed, df_val_processed, df_test_processed, df_val_original = (
ValueError: too many values to unpack (expected 4)
12-14 11:30 - ================================================================================
12-14 11:31 - ================================================================================
12-14 11:31 - Starting Phase: Main
12-14 11:31 - --------------------------------------------------------------------------------
12-14 11:31 - Initial Memory Usage: 215.42 MB
12-14 11:31 - Starting Sepsis Prediction Pipeline
12-14 11:31 - Initial Memory Usage: 215.42 MB
12-14 11:31 - Reports and metrics will be saved to: reports/evaluations/run_20241214_113146
12-14 11:31 - Loading and preprocessing data.
12-14 11:31 - Splitting data into training, validation, and testing sets
12-14 11:32 - Starting step: Preprocessing training data
12-14 11:53 - Completed step: Preprocessing training data (Duration: 1259.06s)
12-14 11:53 - Starting step: Preprocessing validation data
12-14 11:53 - Completed step: Preprocessing validation data (Duration: 7.25s)
12-14 11:53 - Starting step: Preprocessing testing data
12-14 11:53 - Completed step: Preprocessing testing data (Duration: 8.23s)
12-14 11:53 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_113146.pkl
12-14 11:53 - Applying SMOTEENN to training data.
12-14 11:56 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 11:56 - Saved resampled data to checkpoints/resampled_data_20241214_113146.pkl
12-14 11:56 - Initializing new Optuna studies.
12-14 11:56 - Saved Optuna studies to checkpoints/optuna_studies_20241214_113146.pkl
12-14 11:56 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 11:56 - Optimizing Random Forest hyperparameters with Optuna.
12-14 11:59 - Best Random Forest parameters: {'n_estimators': 212, 'max_depth': 28, 'min_samples_split': 8, 'min_samples_leaf': 2, 'max_features': 'sqrt'}
12-14 11:59 - Random Forest - Total trials: 11
12-14 11:59 - Random Forest - Completed trials: 11
12-14 11:59 - Random Forest - Pruned trials: 0
12-14 11:59 - Random Forest - Failed trials: 0
12-14 11:59 - Training Random Forest (Tuned)...
12-14 12:01 - Training completed for Random Forest (Tuned).
12-14 12:01 - Predictions made for Random Forest (Tuned).
12-14 12:01 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 12:01 - 
Random Forest (Tuned) Evaluation:
12-14 12:01 -   Accuracy                  : 0.9730
12-14 12:01 -   Precision                 : 0.3058
12-14 12:01 -   Recall                    : 0.5132
12-14 12:01 -   F1 Score                  : 0.3832
12-14 12:01 -   Mean Absolute Error       : 0.0270
12-14 12:01 -   Root Mean Squared Error   : 0.1643
12-14 12:01 -   AUC-ROC                   : 0.9528
12-14 12:01 -   AUPRC                     : 0.3671
12-14 12:01 -   Specificity               : 0.9806
12-14 12:01 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 12:01 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 12:01 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 12:01 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 12:01 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 12:01 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 12:01 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 12:01 - Missing values heatmap saved to reports/evaluations/run_20241214_113146/Random Forest (Tuned)_missing_values_heatmap.png
12-14 12:01 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 12:01 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 12:01 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 12:01 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 12:01 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 12:01 - Saved temporal progression plots for 5 patients
12-14 12:01 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 12:01 - Saved error analysis plots to reports/evaluations/run_20241214_113146
12-14 12:01 - Saved plot: Random Forest (Tuned)_interaction_Unit1_Unit2.png
12-14 12:01 - Saved plot: Random Forest (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 12:01 - Saved plot: Random Forest (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 12:01 - Saved plot: Random Forest (Tuned)_interaction_Hour_ICULOS.png
12-14 12:01 - Saved plot: Random Forest (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 12:01 - Saved feature interaction plots for top 5 pairs
12-14 12:01 - No sepsis patients have predictions for timeline plots.
12-14 12:01 - Saved evaluation metrics to reports/evaluations/run_20241214_113146/Random Forest (Tuned)_metrics.json

12-14 12:01 - Evaluation completed for Random Forest (Tuned).
12-14 12:01 - New best model: Random Forest (Tuned) with F1 Score: 0.3832
12-14 12:01 - Saved hyperparameters to reports/evaluations/run_20241214_113146/random_forest_tuned_params.json
12-14 12:01 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 12:02 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 12:02 - Logistic Regression - Total trials: 11
12-14 12:02 - Logistic Regression - Completed trials: 11
12-14 12:02 - Logistic Regression - Pruned trials: 0
12-14 12:02 - Logistic Regression - Failed trials: 0
12-14 12:02 - Training Logistic Regression (Tuned)...
12-14 12:02 - Training completed for Logistic Regression (Tuned).
12-14 12:02 - Predictions made for Logistic Regression (Tuned).
12-14 12:02 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 12:02 - 
Logistic Regression (Tuned) Evaluation:
12-14 12:02 -   Accuracy                  : 0.9460
12-14 12:02 -   Precision                 : 0.1902
12-14 12:02 -   Recall                    : 0.7063
12-14 12:02 -   F1 Score                  : 0.2997
12-14 12:02 -   Mean Absolute Error       : 0.0540
12-14 12:02 -   Root Mean Squared Error   : 0.2323
12-14 12:02 -   AUC-ROC                   : 0.8962
12-14 12:02 -   AUPRC                     : 0.1445
12-14 12:02 -   Specificity               : 0.9500
12-14 12:02 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 12:02 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 12:02 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 12:02 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 12:02 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 12:02 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 12:02 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 12:02 - Missing values heatmap saved to reports/evaluations/run_20241214_113146/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 12:02 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 12:02 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 12:02 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 12:02 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 12:02 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 12:02 - Saved temporal progression plots for 5 patients
12-14 12:02 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 12:02 - Saved error analysis plots to reports/evaluations/run_20241214_113146
12-14 12:02 - Saved plot: Logistic Regression (Tuned)_interaction_Unit1_Unit2.png
12-14 12:02 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 12:02 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 12:02 - Saved plot: Logistic Regression (Tuned)_interaction_Hour_ICULOS.png
12-14 12:02 - Saved plot: Logistic Regression (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 12:02 - Saved feature interaction plots for top 5 pairs
12-14 12:02 - No sepsis patients have predictions for timeline plots.
12-14 12:02 - Saved evaluation metrics to reports/evaluations/run_20241214_113146/Logistic Regression (Tuned)_metrics.json

12-14 12:02 - Evaluation completed for Logistic Regression (Tuned).
12-14 12:02 - Saved hyperparameters to reports/evaluations/run_20241214_113146/logistic_regression_tuned_params.json
12-14 12:02 - Optimizing XGBoost hyperparameters with Optuna.
12-14 12:06 - Best XGBoost parameters: {'n_estimators': 338, 'max_depth': 10, 'learning_rate': 0.2883055749891377, 'subsample': 0.5059150185631622, 'colsample_bytree': 0.568428206873383, 'gamma': 0.05932319447448364, 'reg_alpha': 0.038009630139306805, 'reg_lambda': 0.5636360459603342}
12-14 12:06 - XGBoost - Total trials: 20
12-14 12:06 - XGBoost - Completed trials: 20
12-14 12:06 - XGBoost - Pruned trials: 0
12-14 12:06 - XGBoost - Failed trials: 0
12-14 12:06 - Training XGBoost (Tuned)...
12-14 12:06 - Training completed for XGBoost (Tuned).
12-14 12:06 - Predictions made for XGBoost (Tuned).
12-14 12:06 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 12:07 - 
XGBoost (Tuned) Evaluation:
12-14 12:07 -   Accuracy                  : 0.9629
12-14 12:07 -   Precision                 : 0.2626
12-14 12:07 -   Recall                    : 0.7025
12-14 12:07 -   F1 Score                  : 0.3823
12-14 12:07 -   Mean Absolute Error       : 0.0371
12-14 12:07 -   Root Mean Squared Error   : 0.1926
12-14 12:07 -   AUC-ROC                   : 0.9428
12-14 12:07 -   AUPRC                     : 0.4457
12-14 12:07 -   Specificity               : 0.9672
12-14 12:07 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 12:07 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 12:07 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 12:07 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 12:07 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 12:07 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 12:07 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 12:07 - Missing values heatmap saved to reports/evaluations/run_20241214_113146/XGBoost (Tuned)_missing_values_heatmap.png
12-14 12:07 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 12:07 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 12:07 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 12:07 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 12:07 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 12:07 - Saved temporal progression plots for 5 patients
12-14 12:07 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 12:07 - Saved error analysis plots to reports/evaluations/run_20241214_113146
12-14 12:07 - Saved plot: XGBoost (Tuned)_interaction_Unit1_Unit2.png
12-14 12:07 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 12:07 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 12:07 - Saved plot: XGBoost (Tuned)_interaction_Hour_ICULOS.png
12-14 12:07 - Saved plot: XGBoost (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 12:07 - Saved feature interaction plots for top 5 pairs
12-14 12:07 - No sepsis patients have predictions for timeline plots.
12-14 12:07 - Saved evaluation metrics to reports/evaluations/run_20241214_113146/XGBoost (Tuned)_metrics.json

12-14 12:07 - Evaluation completed for XGBoost (Tuned).
12-14 12:07 - Saved hyperparameters to reports/evaluations/run_20241214_113146/xgboost_tuned_params.json
12-14 12:07 - Saved trained models to checkpoints/trained_models_20241214_113146.pkl
12-14 12:07 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_113146.pkl
12-14 12:07 - Saved trial data to reports/evaluations/run_20241214_113146/random_forest_optimization_optimization_trials.csv
12-14 12:07 - Saved trial data to reports/evaluations/run_20241214_113146/logistic_regression_optimization_optimization_trials.csv
12-14 12:07 - Saved trial data to reports/evaluations/run_20241214_113146/xgboost_optimization_optimization_trials.csv
12-14 12:07 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 12:07 - Predictions made with Random Forest (Tuned) on test set.
12-14 12:07 - 
Final_random_forest_(tuned) Evaluation:
12-14 12:07 -   Accuracy                  : 0.9866
12-14 12:07 -   Precision                 : 0.5985
12-14 12:07 -   Recall                    : 0.5121
12-14 12:07 -   F1 Score                  : 0.5519
12-14 12:07 -   Mean Absolute Error       : 0.0134
12-14 12:07 -   Root Mean Squared Error   : 0.1158
12-14 12:07 -   AUC-ROC                   : 0.9750
12-14 12:07 -   AUPRC                     : 0.5992
12-14 12:07 -   Specificity               : 0.9944
12-14 12:07 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-14 12:07 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-14 12:07 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-14 12:07 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-14 12:07 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-14 12:07 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 12:07 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 12:07 - Missing values heatmap saved to reports/evaluations/run_20241214_113146/Final_random_forest_(tuned)_missing_values_heatmap.png
12-14 12:07 - Saved plot: Final_random_forest_(tuned)_temporal_patient_11634.png
12-14 12:07 - Saved plot: Final_random_forest_(tuned)_temporal_patient_103435.png
12-14 12:07 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1226.png
12-14 12:07 - Saved plot: Final_random_forest_(tuned)_temporal_patient_3273.png
12-14 12:07 - Saved plot: Final_random_forest_(tuned)_temporal_patient_18872.png
12-14 12:07 - Saved temporal progression plots for 5 patients
12-14 12:07 - Error plotting error analysis: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 751, in plot_error_analysis
    if len(y_true[group_mask]) > 0:  # Check if group has samples
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/series.py", line 1149, in __getitem__
    key = check_bool_indexer(self.index, key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexing.py", line 2662, in check_bool_indexer
    raise IndexingError(
pandas.errors.IndexingError: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
12-14 12:07 - Error generating evaluation plots: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 288, in generate_evaluation_plots
    plot_error_analysis(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 751, in plot_error_analysis
    if len(y_true[group_mask]) > 0:  # Check if group has samples
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/series.py", line 1149, in __getitem__
    key = check_bool_indexer(self.index, key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexing.py", line 2662, in check_bool_indexer
    raise IndexingError(
pandas.errors.IndexingError: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
12-14 12:07 - Error in model evaluation: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 117, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 288, in generate_evaluation_plots
    plot_error_analysis(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 751, in plot_error_analysis
    if len(y_true[group_mask]) > 0:  # Check if group has samples
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/series.py", line 1149, in __getitem__
    key = check_bool_indexer(self.index, key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexing.py", line 2662, in check_bool_indexer
    raise IndexingError(
pandas.errors.IndexingError: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
12-14 12:07 - An error occurred during final evaluation: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1295, in main
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 117, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 288, in generate_evaluation_plots
    plot_error_analysis(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 751, in plot_error_analysis
    if len(y_true[group_mask]) > 0:  # Check if group has samples
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/series.py", line 1149, in __getitem__
    key = check_bool_indexer(self.index, key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexing.py", line 2662, in check_bool_indexer
    raise IndexingError(
pandas.errors.IndexingError: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
12-14 12:07 - An error occurred: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1295, in main
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 117, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 288, in generate_evaluation_plots
    plot_error_analysis(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 751, in plot_error_analysis
    if len(y_true[group_mask]) > 0:  # Check if group has samples
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/series.py", line 1149, in __getitem__
    key = check_bool_indexer(self.index, key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexing.py", line 2662, in check_bool_indexer
    raise IndexingError(
pandas.errors.IndexingError: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
12-14 12:07 - Phase Complete: Main
12-14 12:07 - Duration: 2161.39 seconds
12-14 12:07 - Final Memory Usage: 1390.86 MB
12-14 12:07 - Memory Change: +1175.44 MB
12-14 12:07 - Phase Failed: Main
12-14 12:07 - Error: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1295, in main
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 117, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 288, in generate_evaluation_plots
    plot_error_analysis(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 751, in plot_error_analysis
    if len(y_true[group_mask]) > 0:  # Check if group has samples
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/series.py", line 1149, in __getitem__
    key = check_bool_indexer(self.index, key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexing.py", line 2662, in check_bool_indexer
    raise IndexingError(
pandas.errors.IndexingError: Unalignable boolean Series provided as indexer (index of the boolean Series and of the indexed object do not match).
12-14 12:07 - ================================================================================
12-14 12:18 - ================================================================================
12-14 12:18 - Starting Phase: Main
12-14 12:18 - --------------------------------------------------------------------------------
12-14 12:18 - Initial Memory Usage: 214.47 MB
12-14 12:18 - Starting Sepsis Prediction Pipeline
12-14 12:18 - Reports and metrics will be saved to: reports/evaluations/run_20241214_121811
12-14 12:18 - Loading preprocessed data from checkpoint.
12-14 12:18 - An error occurred: too many values to unpack (expected 4)
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 526, in main
    df_train_processed, df_val_processed, df_test_processed, df_val_original = (
ValueError: too many values to unpack (expected 4)
12-14 12:18 - Phase Failed: Main
12-14 12:18 - Error: too many values to unpack (expected 4)
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 526, in main
    df_train_processed, df_val_processed, df_test_processed, df_val_original = (
ValueError: too many values to unpack (expected 4)
12-14 12:18 - ================================================================================
12-14 12:18 - ================================================================================
12-14 12:18 - Starting Phase: Main
12-14 12:18 - --------------------------------------------------------------------------------
12-14 12:18 - Initial Memory Usage: 215.41 MB
12-14 12:18 - Starting Sepsis Prediction Pipeline
12-14 12:18 - Reports and metrics will be saved to: reports/evaluations/run_20241214_121833
12-14 12:18 - Loading and preprocessing data.
12-14 12:18 - Splitting data into training, validation, and testing sets
12-14 12:18 - Starting step: Preprocessing training data
12-14 12:22 - Completed step: Preprocessing training data (Duration: 219.58s)
12-14 12:22 - Starting step: Preprocessing validation data
12-14 12:22 - Completed step: Preprocessing validation data (Duration: 7.15s)
12-14 12:22 - Starting step: Preprocessing testing data
12-14 12:22 - Completed step: Preprocessing testing data (Duration: 7.23s)
12-14 12:22 - Saved preprocessed data to checkpoints/preprocessed_data.pkl
12-14 12:22 - Applying SMOTEENN to training data.
12-14 12:25 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 12:25 - Saved resampled data to checkpoints/resampled_data.pkl
12-14 12:25 - Initializing new Optuna studies.
12-14 12:25 - Saved Optuna studies to checkpoints/optuna_studies.pkl
12-14 12:25 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 12:25 - Optimizing Random Forest hyperparameters with Optuna.
12-14 12:29 - Best Random Forest parameters: {'n_estimators': 212, 'max_depth': 28, 'min_samples_split': 8, 'min_samples_leaf': 2, 'max_features': 'sqrt'}
12-14 12:29 - Random Forest - Total trials: 12
12-14 12:29 - Random Forest - Completed trials: 12
12-14 12:29 - Random Forest - Pruned trials: 0
12-14 12:29 - Random Forest - Failed trials: 0
12-14 12:29 - Training Random Forest (Tuned)...
12-14 12:30 - Training completed for Random Forest (Tuned).
12-14 12:30 - Predictions made for Random Forest (Tuned).
12-14 12:30 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 12:30 - 
Random Forest (Tuned) Evaluation:
12-14 12:30 -   Accuracy                  : 0.9729
12-14 12:30 -   Precision                 : 0.3042
12-14 12:30 -   Recall                    : 0.5114
12-14 12:30 -   F1 Score                  : 0.3815
12-14 12:30 -   Mean Absolute Error       : 0.0271
12-14 12:30 -   Root Mean Squared Error   : 0.1647
12-14 12:30 -   AUC-ROC                   : 0.9531
12-14 12:30 -   Specificity               : 0.9806
12-14 12:30 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 12:30 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 12:30 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 12:30 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 12:30 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 12:30 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 12:30 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 12:30 - Missing values heatmap saved to reports/evaluations/run_20241214_121833/Random Forest (Tuned)_missing_values_heatmap.png
12-14 12:30 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 12:30 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 12:30 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 12:30 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 12:30 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 12:30 - Saved temporal progression plots for 5 patients
12-14 12:31 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 12:31 - Saved error analysis plots to reports/evaluations/run_20241214_121833
12-14 12:31 - Saved feature interaction plots for top 5 pairs
12-14 12:31 - No sepsis patients have predictions for timeline plots.
12-14 12:31 - Saved evaluation metrics to reports/evaluations/run_20241214_121833/Random Forest (Tuned)_metrics.json

12-14 12:31 - Evaluation completed for Random Forest (Tuned).
12-14 12:31 - New best model: Random Forest (Tuned) with F1 Score: 0.3815
12-14 12:31 - Saved hyperparameters to reports/evaluations/run_20241214_121833/random_forest_tuned_params.json
12-14 12:31 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 12:33 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 12:33 - Logistic Regression - Total trials: 12
12-14 12:33 - Logistic Regression - Completed trials: 12
12-14 12:33 - Logistic Regression - Pruned trials: 0
12-14 12:33 - Logistic Regression - Failed trials: 0
12-14 12:33 - Training Logistic Regression (Tuned)...
12-14 12:33 - Training completed for Logistic Regression (Tuned).
12-14 12:33 - Predictions made for Logistic Regression (Tuned).
12-14 12:33 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 12:33 - 
Logistic Regression (Tuned) Evaluation:
12-14 12:33 -   Accuracy                  : 0.9462
12-14 12:33 -   Precision                 : 0.1906
12-14 12:33 -   Recall                    : 0.7050
12-14 12:33 -   F1 Score                  : 0.3001
12-14 12:33 -   Mean Absolute Error       : 0.0538
12-14 12:33 -   Root Mean Squared Error   : 0.2319
12-14 12:33 -   AUC-ROC                   : 0.8967
12-14 12:33 -   Specificity               : 0.9502
12-14 12:33 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 12:33 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 12:33 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 12:33 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 12:33 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 12:33 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 12:33 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 12:33 - Missing values heatmap saved to reports/evaluations/run_20241214_121833/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 12:33 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 12:33 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 12:33 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 12:33 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 12:33 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 12:33 - Saved temporal progression plots for 5 patients
12-14 12:33 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 12:33 - Saved error analysis plots to reports/evaluations/run_20241214_121833
12-14 12:34 - Saved feature interaction plots for top 5 pairs
12-14 12:34 - No sepsis patients have predictions for timeline plots.
12-14 12:34 - Saved evaluation metrics to reports/evaluations/run_20241214_121833/Logistic Regression (Tuned)_metrics.json

12-14 12:34 - Evaluation completed for Logistic Regression (Tuned).
12-14 12:34 - Saved hyperparameters to reports/evaluations/run_20241214_121833/logistic_regression_tuned_params.json
12-14 12:34 - Optimizing XGBoost hyperparameters with Optuna.
12-14 12:35 - Best XGBoost parameters: {'n_estimators': 338, 'max_depth': 10, 'learning_rate': 0.2883055749891377, 'subsample': 0.5059150185631622, 'colsample_bytree': 0.568428206873383, 'gamma': 0.05932319447448364, 'reg_alpha': 0.038009630139306805, 'reg_lambda': 0.5636360459603342}
12-14 12:35 - XGBoost - Total trials: 21
12-14 12:35 - XGBoost - Completed trials: 21
12-14 12:35 - XGBoost - Pruned trials: 0
12-14 12:35 - XGBoost - Failed trials: 0
12-14 12:35 - Training XGBoost (Tuned)...
12-14 12:35 - Training completed for XGBoost (Tuned).
12-14 12:35 - Predictions made for XGBoost (Tuned).
12-14 12:35 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 12:35 - 
XGBoost (Tuned) Evaluation:
12-14 12:35 -   Accuracy                  : 0.9642
12-14 12:35 -   Precision                 : 0.2684
12-14 12:35 -   Recall                    : 0.6887
12-14 12:35 -   F1 Score                  : 0.3863
12-14 12:35 -   Mean Absolute Error       : 0.0358
12-14 12:35 -   Root Mean Squared Error   : 0.1891
12-14 12:35 -   AUC-ROC                   : 0.9444
12-14 12:35 -   Specificity               : 0.9688
12-14 12:35 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 12:35 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 12:35 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 12:35 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 12:35 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 12:35 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 12:35 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 12:35 - Missing values heatmap saved to reports/evaluations/run_20241214_121833/XGBoost (Tuned)_missing_values_heatmap.png
12-14 12:35 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 12:35 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 12:35 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 12:35 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 12:35 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 12:35 - Saved temporal progression plots for 5 patients
12-14 12:35 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 12:35 - Saved error analysis plots to reports/evaluations/run_20241214_121833
12-14 12:35 - Saved feature interaction plots for top 5 pairs
12-14 12:35 - No sepsis patients have predictions for timeline plots.
12-14 12:35 - Saved evaluation metrics to reports/evaluations/run_20241214_121833/XGBoost (Tuned)_metrics.json

12-14 12:35 - Evaluation completed for XGBoost (Tuned).
12-14 12:35 - New best model: XGBoost (Tuned) with F1 Score: 0.3863
12-14 12:35 - Saved hyperparameters to reports/evaluations/run_20241214_121833/xgboost_tuned_params.json
12-14 12:35 - Saved trained models to checkpoints/trained_models.pkl
12-14 12:35 - Saved updated Optuna studies to checkpoints/optuna_studies.pkl
12-14 12:35 - Saved trial data to reports/evaluations/run_20241214_121833/random_forest_optimization_optimization_trials.csv
12-14 12:35 - Saved trial data to reports/evaluations/run_20241214_121833/logistic_regression_optimization_optimization_trials.csv
12-14 12:35 - Saved trial data to reports/evaluations/run_20241214_121833/xgboost_optimization_optimization_trials.csv
12-14 12:35 - 
Performing final evaluation with best model: XGBoost (Tuned)
12-14 12:35 - An error occurred during final evaluation: 'XGBClassifier' object has no attribute 'named_steps'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1230, in main
    if "xgb_classifier" in best_model.named_steps:
AttributeError: 'XGBClassifier' object has no attribute 'named_steps'
12-14 12:35 - An error occurred: 'XGBClassifier' object has no attribute 'named_steps'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1230, in main
    if "xgb_classifier" in best_model.named_steps:
AttributeError: 'XGBClassifier' object has no attribute 'named_steps'
12-14 12:35 - Phase Failed: Main
12-14 12:35 - Error: 'XGBClassifier' object has no attribute 'named_steps'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1230, in main
    if "xgb_classifier" in best_model.named_steps:
AttributeError: 'XGBClassifier' object has no attribute 'named_steps'
12-14 12:35 - ================================================================================
12-14 12:55 - ================================================================================
12-14 12:55 - Starting Phase: Main
12-14 12:55 - --------------------------------------------------------------------------------
12-14 12:55 - Initial Memory Usage: 213.28 MB
12-14 12:55 - Starting Sepsis Prediction Pipeline
12-14 12:55 - Reports and metrics will be saved to: reports/evaluations/run_20241214_125504
12-14 12:55 - Loading preprocessed data from checkpoint.
12-14 12:55 - Loading resampled data from checkpoint.
12-14 12:55 - Loading trained models from checkpoint.
12-14 12:55 - Best model so far: XGBoost (Tuned) with F1 Score: 0.3863
12-14 12:55 - 
Performing final evaluation with best model: XGBoost (Tuned)
12-14 12:55 - An error occurred during final evaluation: 'XGBClassifier' object has no attribute 'named_steps'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1230, in main
    if "xgb_classifier" in best_model.named_steps:
AttributeError: 'XGBClassifier' object has no attribute 'named_steps'
12-14 12:55 - An error occurred: 'XGBClassifier' object has no attribute 'named_steps'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1230, in main
    if "xgb_classifier" in best_model.named_steps:
AttributeError: 'XGBClassifier' object has no attribute 'named_steps'
12-14 12:55 - Phase Failed: Main
12-14 12:55 - Error: 'XGBClassifier' object has no attribute 'named_steps'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1230, in main
    if "xgb_classifier" in best_model.named_steps:
AttributeError: 'XGBClassifier' object has no attribute 'named_steps'
12-14 12:55 - ================================================================================
12-14 12:55 - ================================================================================
12-14 12:55 - Starting Phase: Main
12-14 12:55 - --------------------------------------------------------------------------------
12-14 12:55 - Initial Memory Usage: 215.92 MB
12-14 12:55 - Starting Sepsis Prediction Pipeline
12-14 12:55 - Reports and metrics will be saved to: reports/evaluations/run_20241214_125532
12-14 12:55 - Loading and preprocessing data.
12-14 12:55 - Splitting data into training, validation, and testing sets
12-14 12:55 - Starting step: Preprocessing training data
12-14 12:59 - Completed step: Preprocessing training data (Duration: 221.48s)
12-14 12:59 - Starting step: Preprocessing validation data
12-14 12:59 - Completed step: Preprocessing validation data (Duration: 7.27s)
12-14 12:59 - Starting step: Preprocessing testing data
12-14 12:59 - Completed step: Preprocessing testing data (Duration: 7.46s)
12-14 12:59 - Saved preprocessed data to checkpoints/preprocessed_data.pkl
12-14 12:59 - Applying SMOTEENN to training data.
12-14 13:03 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 13:03 - Saved resampled data to checkpoints/resampled_data.pkl
12-14 13:03 - Initializing new Optuna studies.
12-14 13:03 - Saved Optuna studies to checkpoints/optuna_studies.pkl
12-14 13:03 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 13:03 - Optimizing Random Forest hyperparameters with Optuna.
12-14 13:06 - Best Random Forest parameters: {'n_estimators': 205, 'max_depth': 29, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_features': 'sqrt'}
12-14 13:06 - Random Forest - Total trials: 13
12-14 13:06 - Random Forest - Completed trials: 13
12-14 13:06 - Random Forest - Pruned trials: 0
12-14 13:06 - Random Forest - Failed trials: 0
12-14 13:06 - Training Random Forest (Tuned)...
12-14 13:08 - Training completed for Random Forest (Tuned).
12-14 13:08 - Predictions made for Random Forest (Tuned).
12-14 13:08 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 13:08 - 
Random Forest (Tuned) Evaluation:
12-14 13:08 -   Accuracy                  : 0.9746
12-14 13:08 -   Precision                 : 0.3201
12-14 13:08 -   Recall                    : 0.4955
12-14 13:08 -   F1 Score                  : 0.3890
12-14 13:08 -   Mean Absolute Error       : 0.0254
12-14 13:08 -   Root Mean Squared Error   : 0.1595
12-14 13:08 -   AUC-ROC                   : 0.9521
12-14 13:08 -   Specificity               : 0.9825
12-14 13:08 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 13:08 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 13:08 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 13:08 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 13:08 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 13:08 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 13:08 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 13:08 - Missing values heatmap saved to reports/evaluations/run_20241214_125532/Random Forest (Tuned)_missing_values_heatmap.png
12-14 13:08 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 13:08 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 13:08 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 13:08 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 13:08 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 13:08 - Saved temporal progression plots for 5 patients
12-14 13:08 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 13:08 - Saved error analysis plots to reports/evaluations/run_20241214_125532
12-14 13:08 - Saved feature interaction plots for top 5 pairs
12-14 13:08 - No sepsis patients have predictions for timeline plots.
12-14 13:08 - Saved evaluation metrics to reports/evaluations/run_20241214_125532/Random Forest (Tuned)_metrics.json

12-14 13:08 - Evaluation completed for Random Forest (Tuned).
12-14 13:08 - New best model: Random Forest (Tuned) with F1 Score: 0.3890
12-14 13:08 - Saved hyperparameters to reports/evaluations/run_20241214_125532/random_forest_tuned_params.json
12-14 13:08 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 13:11 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 13:11 - Logistic Regression - Total trials: 13
12-14 13:11 - Logistic Regression - Completed trials: 13
12-14 13:11 - Logistic Regression - Pruned trials: 0
12-14 13:11 - Logistic Regression - Failed trials: 0
12-14 13:11 - Training Logistic Regression (Tuned)...
12-14 13:11 - Training completed for Logistic Regression (Tuned).
12-14 13:11 - Predictions made for Logistic Regression (Tuned).
12-14 13:11 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 13:11 - 
Logistic Regression (Tuned) Evaluation:
12-14 13:11 -   Accuracy                  : 0.9462
12-14 13:11 -   Precision                 : 0.1906
12-14 13:11 -   Recall                    : 0.7050
12-14 13:11 -   F1 Score                  : 0.3001
12-14 13:11 -   Mean Absolute Error       : 0.0538
12-14 13:11 -   Root Mean Squared Error   : 0.2319
12-14 13:11 -   AUC-ROC                   : 0.8967
12-14 13:11 -   Specificity               : 0.9502
12-14 13:11 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 13:11 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 13:11 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 13:11 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 13:11 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 13:11 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 13:11 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 13:11 - Missing values heatmap saved to reports/evaluations/run_20241214_125532/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 13:11 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 13:11 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 13:11 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 13:11 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 13:11 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 13:11 - Saved temporal progression plots for 5 patients
12-14 13:11 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 13:11 - Saved error analysis plots to reports/evaluations/run_20241214_125532
12-14 13:12 - Saved feature interaction plots for top 5 pairs
12-14 13:12 - No sepsis patients have predictions for timeline plots.
12-14 13:12 - Saved evaluation metrics to reports/evaluations/run_20241214_125532/Logistic Regression (Tuned)_metrics.json

12-14 13:12 - Evaluation completed for Logistic Regression (Tuned).
12-14 13:12 - Saved hyperparameters to reports/evaluations/run_20241214_125532/logistic_regression_tuned_params.json
12-14 13:12 - Optimizing XGBoost hyperparameters with Optuna.
12-14 13:12 - Best XGBoost parameters: {'n_estimators': 338, 'max_depth': 10, 'learning_rate': 0.2883055749891377, 'subsample': 0.5059150185631622, 'colsample_bytree': 0.568428206873383, 'gamma': 0.05932319447448364, 'reg_alpha': 0.038009630139306805, 'reg_lambda': 0.5636360459603342}
12-14 13:12 - XGBoost - Total trials: 22
12-14 13:12 - XGBoost - Completed trials: 22
12-14 13:12 - XGBoost - Pruned trials: 0
12-14 13:12 - XGBoost - Failed trials: 0
12-14 13:12 - Training XGBoost (Tuned)...
12-14 13:12 - Training completed for XGBoost (Tuned).
12-14 13:12 - Predictions made for XGBoost (Tuned).
12-14 13:12 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 13:12 - 
XGBoost (Tuned) Evaluation:
12-14 13:12 -   Accuracy                  : 0.9642
12-14 13:12 -   Precision                 : 0.2684
12-14 13:12 -   Recall                    : 0.6887
12-14 13:12 -   F1 Score                  : 0.3863
12-14 13:12 -   Mean Absolute Error       : 0.0358
12-14 13:12 -   Root Mean Squared Error   : 0.1891
12-14 13:12 -   AUC-ROC                   : 0.9444
12-14 13:12 -   Specificity               : 0.9688
12-14 13:12 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 13:12 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 13:12 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 13:12 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 13:12 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 13:12 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 13:12 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 13:12 - Missing values heatmap saved to reports/evaluations/run_20241214_125532/XGBoost (Tuned)_missing_values_heatmap.png
12-14 13:12 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 13:12 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 13:12 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 13:12 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 13:12 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 13:12 - Saved temporal progression plots for 5 patients
12-14 13:12 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 13:12 - Saved error analysis plots to reports/evaluations/run_20241214_125532
12-14 13:13 - Saved feature interaction plots for top 5 pairs
12-14 13:13 - No sepsis patients have predictions for timeline plots.
12-14 13:13 - Saved evaluation metrics to reports/evaluations/run_20241214_125532/XGBoost (Tuned)_metrics.json

12-14 13:13 - Evaluation completed for XGBoost (Tuned).
12-14 13:13 - Saved hyperparameters to reports/evaluations/run_20241214_125532/xgboost_tuned_params.json
12-14 13:13 - Saved trained models to checkpoints/trained_models.pkl
12-14 13:13 - Saved updated Optuna studies to checkpoints/optuna_studies.pkl
12-14 13:13 - Saved trial data to reports/evaluations/run_20241214_125532/random_forest_optimization_optimization_trials.csv
12-14 13:13 - Saved trial data to reports/evaluations/run_20241214_125532/logistic_regression_optimization_optimization_trials.csv
12-14 13:13 - Saved trial data to reports/evaluations/run_20241214_125532/xgboost_optimization_optimization_trials.csv
12-14 13:13 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 13:13 - Predictions made with Random Forest (Tuned) on test set.
12-14 13:13 - 
Final_random_forest_(tuned) Evaluation:
12-14 13:13 -   Accuracy                  : 0.9873
12-14 13:13 -   Precision                 : 0.6384
12-14 13:13 -   Recall                    : 0.4911
12-14 13:13 -   F1 Score                  : 0.5551
12-14 13:13 -   Mean Absolute Error       : 0.0127
12-14 13:13 -   Root Mean Squared Error   : 0.1127
12-14 13:13 -   AUC-ROC                   : 0.9747
12-14 13:13 -   Specificity               : 0.9954
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-14 13:13 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 13:13 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 13:13 - Missing values heatmap saved to reports/evaluations/run_20241214_125532/Final_random_forest_(tuned)_missing_values_heatmap.png
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-14 13:13 - Saved temporal progression plots for 5 patients
12-14 13:13 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-14 13:13 - Saved error analysis plots to reports/evaluations/run_20241214_125532
12-14 13:14 - Saved feature interaction plots for top 5 pairs
12-14 13:14 - No sepsis patients have predictions for timeline plots.
12-14 13:14 - Saved evaluation metrics to reports/evaluations/run_20241214_125532/Final_random_forest_(tuned)_metrics.json

12-14 13:14 - Final evaluation completed for Random Forest (Tuned).
12-14 13:14 - An error occurred during final evaluation: Unknown format code 'f' for object of type 'str'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1287, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 421, in generate_model_card
    f.write(f"| AUPRC | {metrics.get('AUPRC', 'N/A'):.4f} |\n")
ValueError: Unknown format code 'f' for object of type 'str'
12-14 13:14 - An error occurred: Unknown format code 'f' for object of type 'str'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1287, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 421, in generate_model_card
    f.write(f"| AUPRC | {metrics.get('AUPRC', 'N/A'):.4f} |\n")
ValueError: Unknown format code 'f' for object of type 'str'
12-14 13:14 - Phase Failed: Main
12-14 13:14 - Error: Unknown format code 'f' for object of type 'str'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1287, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 421, in generate_model_card
    f.write(f"| AUPRC | {metrics.get('AUPRC', 'N/A'):.4f} |\n")
ValueError: Unknown format code 'f' for object of type 'str'
12-14 13:14 - ================================================================================
12-14 13:18 - ================================================================================
12-14 13:18 - Starting Phase: Main
12-14 13:18 - --------------------------------------------------------------------------------
12-14 13:18 - Initial Memory Usage: 213.52 MB
12-14 13:18 - Starting Sepsis Prediction Pipeline
12-14 13:18 - Reports and metrics will be saved to: reports/evaluations/run_20241214_131849
12-14 13:18 - Loading preprocessed data from checkpoint.
12-14 13:18 - Loading resampled data from checkpoint.
12-14 13:18 - Loading trained models from checkpoint.
12-14 13:18 - Best model so far: Random Forest (Tuned) with F1 Score: 0.3890
12-14 13:18 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 13:18 - Predictions made with Random Forest (Tuned) on test set.
12-14 13:18 - An error occurred during final evaluation: local variable 'df_test' referenced before assignment
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1280, in main
    df_test_with_predictions = df_test.copy()  # Use original df_test
UnboundLocalError: local variable 'df_test' referenced before assignment
12-14 13:18 - An error occurred: local variable 'df_test' referenced before assignment
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1280, in main
    df_test_with_predictions = df_test.copy()  # Use original df_test
UnboundLocalError: local variable 'df_test' referenced before assignment
12-14 13:18 - Phase Failed: Main
12-14 13:18 - Error: local variable 'df_test' referenced before assignment
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1280, in main
    df_test_with_predictions = df_test.copy()  # Use original df_test
UnboundLocalError: local variable 'df_test' referenced before assignment
12-14 13:18 - ================================================================================
12-14 13:19 - ================================================================================
12-14 13:19 - Starting Phase: Main
12-14 13:19 - --------------------------------------------------------------------------------
12-14 13:19 - Initial Memory Usage: 216.31 MB
12-14 13:19 - Starting Sepsis Prediction Pipeline
12-14 13:19 - Reports and metrics will be saved to: reports/evaluations/run_20241214_131910
12-14 13:19 - Loading and preprocessing data.
12-14 13:19 - Splitting data into training, validation, and testing sets
12-14 13:19 - Starting step: Preprocessing training data
12-14 13:23 - ================================================================================
12-14 13:23 - Starting Phase: Main
12-14 13:23 - --------------------------------------------------------------------------------
12-14 13:23 - Initial Memory Usage: 214.53 MB
12-14 13:23 - Starting Sepsis Prediction Pipeline
12-14 13:23 - Initial Memory Usage: 214.53 MB
12-14 13:23 - Reports and metrics will be saved to: reports/evaluations/run_20241214_132331
12-14 13:23 - An error occurred: 'Namespace' object has no attribute 'force'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 552, in main
    if not args.force and not args.new_study:
AttributeError: 'Namespace' object has no attribute 'force'
12-14 13:23 - Phase Failed: Main
12-14 13:23 - Error: 'Namespace' object has no attribute 'force'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 552, in main
    if not args.force and not args.new_study:
AttributeError: 'Namespace' object has no attribute 'force'
12-14 13:23 - ================================================================================
12-14 13:23 - ================================================================================
12-14 13:23 - Starting Phase: Main
12-14 13:23 - --------------------------------------------------------------------------------
12-14 13:23 - Initial Memory Usage: 216.09 MB
12-14 13:23 - Starting Sepsis Prediction Pipeline
12-14 13:23 - Initial Memory Usage: 216.09 MB
12-14 13:23 - Reports and metrics will be saved to: reports/evaluations/run_20241214_132354
12-14 13:23 - Loading and preprocessing data.
12-14 13:23 - Splitting data into training, validation, and testing sets
12-14 13:24 - Starting step: Preprocessing training data
12-14 13:28 - ================================================================================
12-14 13:28 - Starting Phase: Main
12-14 13:28 - --------------------------------------------------------------------------------
12-14 13:28 - Initial Memory Usage: 214.94 MB
12-14 13:28 - Starting Sepsis Prediction Pipeline
12-14 13:28 - Initial Memory Usage: 214.94 MB
12-14 13:28 - Reports and metrics will be saved to: reports/evaluations/run_20241214_132801
12-14 13:28 - Loading and preprocessing data.
12-14 13:28 - Splitting data into training, validation, and testing sets
12-14 13:28 - Starting step: Preprocessing training data
12-14 13:31 - Completed step: Preprocessing training data (Duration: 218.73s)
12-14 13:31 - Starting step: Preprocessing validation data
12-14 13:32 - Completed step: Preprocessing validation data (Duration: 7.02s)
12-14 13:32 - Starting step: Preprocessing testing data
12-14 13:32 - Completed step: Preprocessing testing data (Duration: 7.15s)
12-14 13:32 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_132801.pkl
12-14 13:32 - Applying SMOTEENN to training data.
12-14 13:35 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 13:35 - Saved resampled data to checkpoints/resampled_data_20241214_132801.pkl
12-14 13:35 - Initializing new Optuna studies.
12-14 13:35 - Saved Optuna studies to checkpoints/optuna_studies_20241214_132801.pkl
12-14 13:35 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 13:35 - Optimizing Random Forest hyperparameters with Optuna.
12-14 13:38 - Best Random Forest parameters: {'n_estimators': 205, 'max_depth': 29, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_features': 'sqrt'}
12-14 13:38 - Random Forest - Total trials: 14
12-14 13:38 - Random Forest - Completed trials: 14
12-14 13:38 - Random Forest - Pruned trials: 0
12-14 13:38 - Random Forest - Failed trials: 0
12-14 13:38 - Training Random Forest (Tuned)...
12-14 13:39 - Training completed for Random Forest (Tuned).
12-14 13:39 - Predictions made for Random Forest (Tuned).
12-14 13:39 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 13:39 - 
Random Forest (Tuned) Evaluation:
12-14 13:39 -   Accuracy                  : 0.9746
12-14 13:39 -   Precision                 : 0.3201
12-14 13:39 -   Recall                    : 0.4955
12-14 13:39 -   F1 Score                  : 0.3890
12-14 13:39 -   Mean Absolute Error       : 0.0254
12-14 13:39 -   Root Mean Squared Error   : 0.1595
12-14 13:39 -   AUC-ROC                   : 0.9521
12-14 13:39 -   Specificity               : 0.9825
12-14 13:39 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 13:39 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 13:39 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 13:39 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 13:39 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 13:39 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 13:39 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 13:39 - Missing values heatmap saved to reports/evaluations/run_20241214_132801/Random Forest (Tuned)_missing_values_heatmap.png
12-14 13:39 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 13:39 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 13:39 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 13:39 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 13:39 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 13:39 - Saved temporal progression plots for 5 patients
12-14 13:39 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 13:39 - Saved error analysis plots to reports/evaluations/run_20241214_132801
12-14 13:40 - Saved feature interaction plots for top 5 pairs
12-14 13:40 - No sepsis patients have predictions for timeline plots.
12-14 13:40 - Saved evaluation metrics to reports/evaluations/run_20241214_132801/Random Forest (Tuned)_metrics.json

12-14 13:40 - Evaluation completed for Random Forest (Tuned).
12-14 13:40 - New best model: Random Forest (Tuned) with F1 Score: 0.3890
12-14 13:40 - Saved hyperparameters to reports/evaluations/run_20241214_132801/random_forest_tuned_params.json
12-14 13:40 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 13:41 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 13:41 - Logistic Regression - Total trials: 14
12-14 13:41 - Logistic Regression - Completed trials: 14
12-14 13:41 - Logistic Regression - Pruned trials: 0
12-14 13:41 - Logistic Regression - Failed trials: 0
12-14 13:41 - Training Logistic Regression (Tuned)...
12-14 13:41 - Training completed for Logistic Regression (Tuned).
12-14 13:41 - Predictions made for Logistic Regression (Tuned).
12-14 13:41 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 13:41 - 
Logistic Regression (Tuned) Evaluation:
12-14 13:41 -   Accuracy                  : 0.9462
12-14 13:41 -   Precision                 : 0.1906
12-14 13:41 -   Recall                    : 0.7050
12-14 13:41 -   F1 Score                  : 0.3001
12-14 13:41 -   Mean Absolute Error       : 0.0538
12-14 13:41 -   Root Mean Squared Error   : 0.2319
12-14 13:41 -   AUC-ROC                   : 0.8967
12-14 13:41 -   Specificity               : 0.9502
12-14 13:41 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 13:41 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 13:41 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 13:41 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 13:41 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 13:41 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 13:41 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 13:41 - Missing values heatmap saved to reports/evaluations/run_20241214_132801/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 13:41 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 13:41 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 13:41 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 13:41 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 13:41 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 13:41 - Saved temporal progression plots for 5 patients
12-14 13:41 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 13:41 - Saved error analysis plots to reports/evaluations/run_20241214_132801
12-14 13:41 - Saved feature interaction plots for top 5 pairs
12-14 13:41 - No sepsis patients have predictions for timeline plots.
12-14 13:41 - Saved evaluation metrics to reports/evaluations/run_20241214_132801/Logistic Regression (Tuned)_metrics.json

12-14 13:41 - Evaluation completed for Logistic Regression (Tuned).
12-14 13:41 - Saved hyperparameters to reports/evaluations/run_20241214_132801/logistic_regression_tuned_params.json
12-14 13:41 - Optimizing XGBoost hyperparameters with Optuna.
12-14 13:45 - Best XGBoost parameters: {'n_estimators': 401, 'max_depth': 9, 'learning_rate': 0.21100591931629623, 'subsample': 0.6105007667255703, 'colsample_bytree': 0.5358862912908656, 'gamma': 0.00997908501368766, 'reg_alpha': 0.00775492473139619, 'reg_lambda': 0.6038364766656807}
12-14 13:45 - XGBoost - Total trials: 32
12-14 13:45 - XGBoost - Completed trials: 32
12-14 13:45 - XGBoost - Pruned trials: 0
12-14 13:45 - XGBoost - Failed trials: 0
12-14 13:45 - Training XGBoost (Tuned)...
12-14 13:46 - Training completed for XGBoost (Tuned).
12-14 13:46 - Predictions made for XGBoost (Tuned).
12-14 13:46 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 13:46 - 
XGBoost (Tuned) Evaluation:
12-14 13:46 -   Accuracy                  : 0.9617
12-14 13:46 -   Precision                 : 0.2548
12-14 13:46 -   Recall                    : 0.6981
12-14 13:46 -   F1 Score                  : 0.3734
12-14 13:46 -   Mean Absolute Error       : 0.0383
12-14 13:46 -   Root Mean Squared Error   : 0.1957
12-14 13:46 -   AUC-ROC                   : 0.9427
12-14 13:46 -   Specificity               : 0.9661
12-14 13:46 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 13:46 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 13:46 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 13:46 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 13:46 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 13:46 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 13:46 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 13:46 - Missing values heatmap saved to reports/evaluations/run_20241214_132801/XGBoost (Tuned)_missing_values_heatmap.png
12-14 13:46 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 13:46 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 13:46 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 13:46 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 13:46 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 13:46 - Saved temporal progression plots for 5 patients
12-14 13:46 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 13:46 - Saved error analysis plots to reports/evaluations/run_20241214_132801
12-14 13:46 - Saved feature interaction plots for top 5 pairs
12-14 13:46 - No sepsis patients have predictions for timeline plots.
12-14 13:46 - Saved evaluation metrics to reports/evaluations/run_20241214_132801/XGBoost (Tuned)_metrics.json

12-14 13:46 - Evaluation completed for XGBoost (Tuned).
12-14 13:46 - Saved hyperparameters to reports/evaluations/run_20241214_132801/xgboost_tuned_params.json
12-14 13:46 - Saved trained models to checkpoints/trained_models_20241214_132801.pkl
12-14 13:46 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_132801.pkl
12-14 13:46 - Saved trial data to reports/evaluations/run_20241214_132801/random_forest_optimization_optimization_trials.csv
12-14 13:46 - Saved trial data to reports/evaluations/run_20241214_132801/logistic_regression_optimization_optimization_trials.csv
12-14 13:46 - Saved trial data to reports/evaluations/run_20241214_132801/xgboost_optimization_optimization_trials.csv
12-14 13:46 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 13:46 - Predictions made with Random Forest (Tuned) on test set.
12-14 13:46 - 
Final_random_forest_(tuned) Evaluation:
12-14 13:46 -   Accuracy                  : 0.9873
12-14 13:46 -   Precision                 : 0.6384
12-14 13:46 -   Recall                    : 0.4911
12-14 13:46 -   F1 Score                  : 0.5551
12-14 13:46 -   Mean Absolute Error       : 0.0127
12-14 13:46 -   Root Mean Squared Error   : 0.1127
12-14 13:46 -   AUC-ROC                   : 0.9747
12-14 13:46 -   Specificity               : 0.9954
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-14 13:46 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 13:46 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 13:46 - Missing values heatmap saved to reports/evaluations/run_20241214_132801/Final_random_forest_(tuned)_missing_values_heatmap.png
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-14 13:46 - Saved temporal progression plots for 5 patients
12-14 13:46 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-14 13:46 - Saved error analysis plots to reports/evaluations/run_20241214_132801
12-14 13:47 - Saved feature interaction plots for top 5 pairs
12-14 13:47 - No sepsis patients have predictions for timeline plots.
12-14 13:47 - Saved evaluation metrics to reports/evaluations/run_20241214_132801/Final_random_forest_(tuned)_metrics.json

12-14 13:47 - Final evaluation completed for Random Forest (Tuned).
12-14 13:47 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 13:47 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 13:47 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 13:47 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 13:47 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 13:47 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 13:47 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 13:47 - Missing values heatmap saved to reports/evaluations/run_20241214_132801/Random Forest (Tuned)_missing_values_heatmap.png
12-14 13:47 - Saved plot: Random_Forest_(Tuned)_temporal_patient_13491.png
12-14 13:47 - Saved plot: Random_Forest_(Tuned)_temporal_patient_109380.png
12-14 13:47 - Saved plot: Random_Forest_(Tuned)_temporal_patient_15235.png
12-14 13:47 - Saved plot: Random_Forest_(Tuned)_temporal_patient_100016.png
12-14 13:47 - Saved plot: Random_Forest_(Tuned)_temporal_patient_9513.png
12-14 13:47 - Saved temporal progression plots for 5 patients
12-14 13:47 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 13:47 - Saved error analysis plots to reports/evaluations/run_20241214_132801
12-14 13:47 - Error plotting feature interactions: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 998, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 13:47 - Error generating evaluation plots: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 231, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 998, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 13:47 - An error occurred during final evaluation: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1420, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 444, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 231, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 998, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 13:47 - An error occurred: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1420, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 444, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 231, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 998, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 13:47 - Phase Failed: Main
12-14 13:47 - Error: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1420, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 444, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 231, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 998, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 13:47 - ================================================================================
12-14 13:49 - ================================================================================
12-14 13:49 - Starting Phase: Main
12-14 13:49 - --------------------------------------------------------------------------------
12-14 13:49 - Initial Memory Usage: 216.38 MB
12-14 13:49 - Starting Sepsis Prediction Pipeline
12-14 13:49 - Initial Memory Usage: 216.38 MB
12-14 13:49 - Reports and metrics will be saved to: reports/evaluations/run_20241214_134915
12-14 13:49 - Loading and preprocessing data.
12-14 13:49 - Splitting data into training, validation, and testing sets
12-14 13:49 - Starting step: Preprocessing training data
12-14 13:53 - Completed step: Preprocessing training data (Duration: 221.72s)
12-14 13:53 - Starting step: Preprocessing validation data
12-14 13:53 - Completed step: Preprocessing validation data (Duration: 7.31s)
12-14 13:53 - Starting step: Preprocessing testing data
12-14 13:53 - Completed step: Preprocessing testing data (Duration: 7.43s)
12-14 13:53 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_134915.pkl
12-14 13:53 - Applying SMOTEENN to training data.
12-14 13:56 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 13:56 - Saved resampled data to checkpoints/resampled_data_20241214_134915.pkl
12-14 13:56 - Initializing new Optuna studies.
12-14 13:56 - Saved Optuna studies to checkpoints/optuna_studies_20241214_134915.pkl
12-14 13:56 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 13:56 - Optimizing Random Forest hyperparameters with Optuna.
12-14 14:00 - Best Random Forest parameters: {'n_estimators': 205, 'max_depth': 29, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_features': 'sqrt'}
12-14 14:00 - Random Forest - Total trials: 15
12-14 14:00 - Random Forest - Completed trials: 15
12-14 14:00 - Random Forest - Pruned trials: 0
12-14 14:00 - Random Forest - Failed trials: 0
12-14 14:00 - Training Random Forest (Tuned)...
12-14 14:01 - Training completed for Random Forest (Tuned).
12-14 14:01 - Predictions made for Random Forest (Tuned).
12-14 14:01 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 14:01 - 
Random Forest (Tuned) Evaluation:
12-14 14:01 -   Accuracy                  : 0.9746
12-14 14:01 -   Precision                 : 0.3201
12-14 14:01 -   Recall                    : 0.4955
12-14 14:01 -   F1 Score                  : 0.3890
12-14 14:01 -   Mean Absolute Error       : 0.0254
12-14 14:01 -   Root Mean Squared Error   : 0.1595
12-14 14:01 -   AUC-ROC                   : 0.9521
12-14 14:01 -   AUPRC                     : 0.3697
12-14 14:01 -   Specificity               : 0.9825
12-14 14:01 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 14:01 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 14:01 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 14:01 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 14:01 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 14:01 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 14:01 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 14:01 - Missing values heatmap saved to reports/evaluations/run_20241214_134915/Random Forest (Tuned)_missing_values_heatmap.png
12-14 14:01 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 14:01 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 14:01 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 14:01 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 14:01 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 14:01 - Saved temporal progression plots for 5 patients
12-14 14:01 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 14:01 - Saved error analysis plots to reports/evaluations/run_20241214_134915
12-14 14:02 - Saved plot: Random Forest (Tuned)_interaction_Unit1_Unit2.png
12-14 14:02 - Saved plot: Random Forest (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 14:02 - Saved plot: Random Forest (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 14:02 - Saved plot: Random Forest (Tuned)_interaction_Hour_ICULOS.png
12-14 14:02 - Saved plot: Random Forest (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 14:02 - Saved feature interaction plots for top 5 pairs
12-14 14:02 - No sepsis patients have predictions for timeline plots.
12-14 14:02 - Saved evaluation metrics to reports/evaluations/run_20241214_134915/Random Forest (Tuned)_metrics.json

12-14 14:02 - Evaluation completed for Random Forest (Tuned).
12-14 14:02 - New best model: Random Forest (Tuned) with F1 Score: 0.3890
12-14 14:02 - Saved hyperparameters to reports/evaluations/run_20241214_134915/random_forest_tuned_params.json
12-14 14:02 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 14:04 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 14:04 - Logistic Regression - Total trials: 15
12-14 14:04 - Logistic Regression - Completed trials: 15
12-14 14:04 - Logistic Regression - Pruned trials: 0
12-14 14:04 - Logistic Regression - Failed trials: 0
12-14 14:04 - Training Logistic Regression (Tuned)...
12-14 14:04 - Training completed for Logistic Regression (Tuned).
12-14 14:04 - Predictions made for Logistic Regression (Tuned).
12-14 14:04 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 14:04 - 
Logistic Regression (Tuned) Evaluation:
12-14 14:04 -   Accuracy                  : 0.9462
12-14 14:04 -   Precision                 : 0.1906
12-14 14:04 -   Recall                    : 0.7050
12-14 14:04 -   F1 Score                  : 0.3001
12-14 14:04 -   Mean Absolute Error       : 0.0538
12-14 14:04 -   Root Mean Squared Error   : 0.2319
12-14 14:04 -   AUC-ROC                   : 0.8967
12-14 14:04 -   AUPRC                     : 0.1454
12-14 14:04 -   Specificity               : 0.9502
12-14 14:04 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 14:04 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 14:04 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 14:04 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 14:04 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 14:04 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 14:04 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 14:04 - Missing values heatmap saved to reports/evaluations/run_20241214_134915/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 14:04 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 14:04 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 14:04 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 14:04 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 14:04 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 14:04 - Saved temporal progression plots for 5 patients
12-14 14:04 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 14:04 - Saved error analysis plots to reports/evaluations/run_20241214_134915
12-14 14:04 - Saved plot: Logistic Regression (Tuned)_interaction_Unit1_Unit2.png
12-14 14:04 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 14:04 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 14:05 - Saved plot: Logistic Regression (Tuned)_interaction_Hour_ICULOS.png
12-14 14:05 - Saved plot: Logistic Regression (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 14:05 - Saved feature interaction plots for top 5 pairs
12-14 14:05 - No sepsis patients have predictions for timeline plots.
12-14 14:05 - Saved evaluation metrics to reports/evaluations/run_20241214_134915/Logistic Regression (Tuned)_metrics.json

12-14 14:05 - Evaluation completed for Logistic Regression (Tuned).
12-14 14:05 - Saved hyperparameters to reports/evaluations/run_20241214_134915/logistic_regression_tuned_params.json
12-14 14:05 - Optimizing XGBoost hyperparameters with Optuna.
12-14 14:09 - Best XGBoost parameters: {'n_estimators': 457, 'max_depth': 9, 'learning_rate': 0.17255776234553302, 'subsample': 0.7574329529424287, 'colsample_bytree': 0.5433439671072606, 'gamma': 0.012455929246615097, 'reg_alpha': 0.07875095024685662, 'reg_lambda': 0.5035646682042978}
12-14 14:09 - XGBoost - Total trials: 42
12-14 14:09 - XGBoost - Completed trials: 42
12-14 14:09 - XGBoost - Pruned trials: 0
12-14 14:09 - XGBoost - Failed trials: 0
12-14 14:09 - Training XGBoost (Tuned)...
12-14 14:09 - Training completed for XGBoost (Tuned).
12-14 14:09 - Predictions made for XGBoost (Tuned).
12-14 14:09 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 14:09 - 
XGBoost (Tuned) Evaluation:
12-14 14:09 -   Accuracy                  : 0.9626
12-14 14:09 -   Precision                 : 0.2616
12-14 14:09 -   Recall                    : 0.7076
12-14 14:09 -   F1 Score                  : 0.3820
12-14 14:09 -   Mean Absolute Error       : 0.0374
12-14 14:09 -   Root Mean Squared Error   : 0.1935
12-14 14:09 -   AUC-ROC                   : 0.9441
12-14 14:09 -   AUPRC                     : 0.4476
12-14 14:09 -   Specificity               : 0.9668
12-14 14:09 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 14:09 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 14:09 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 14:09 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 14:09 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 14:09 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 14:09 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 14:09 - Missing values heatmap saved to reports/evaluations/run_20241214_134915/XGBoost (Tuned)_missing_values_heatmap.png
12-14 14:09 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 14:09 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 14:09 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 14:09 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 14:09 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 14:09 - Saved temporal progression plots for 5 patients
12-14 14:09 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 14:09 - Saved error analysis plots to reports/evaluations/run_20241214_134915
12-14 14:10 - Saved plot: XGBoost (Tuned)_interaction_Unit1_Unit2.png
12-14 14:10 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 14:10 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 14:10 - Saved plot: XGBoost (Tuned)_interaction_Hour_ICULOS.png
12-14 14:10 - Saved plot: XGBoost (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 14:10 - Saved feature interaction plots for top 5 pairs
12-14 14:10 - No sepsis patients have predictions for timeline plots.
12-14 14:10 - Saved evaluation metrics to reports/evaluations/run_20241214_134915/XGBoost (Tuned)_metrics.json

12-14 14:10 - Evaluation completed for XGBoost (Tuned).
12-14 14:10 - Saved hyperparameters to reports/evaluations/run_20241214_134915/xgboost_tuned_params.json
12-14 14:10 - Saved trained models to checkpoints/trained_models_20241214_134915.pkl
12-14 14:10 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_134915.pkl
12-14 14:10 - Saved trial data to reports/evaluations/run_20241214_134915/random_forest_optimization_optimization_trials.csv
12-14 14:10 - Saved trial data to reports/evaluations/run_20241214_134915/logistic_regression_optimization_optimization_trials.csv
12-14 14:10 - Saved trial data to reports/evaluations/run_20241214_134915/xgboost_optimization_optimization_trials.csv
12-14 14:10 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 14:10 - Predictions made with Random Forest (Tuned) on test set.
12-14 14:10 - 
Final_random_forest_(tuned) Evaluation:
12-14 14:10 -   Accuracy                  : 0.9873
12-14 14:10 -   Precision                 : 0.6384
12-14 14:10 -   Recall                    : 0.4911
12-14 14:10 -   F1 Score                  : 0.5551
12-14 14:10 -   Mean Absolute Error       : 0.0127
12-14 14:10 -   Root Mean Squared Error   : 0.1127
12-14 14:10 -   AUC-ROC                   : 0.9747
12-14 14:10 -   AUPRC                     : 0.6051
12-14 14:10 -   Specificity               : 0.9954
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-14 14:10 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 14:10 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 14:10 - Missing values heatmap saved to reports/evaluations/run_20241214_134915/Final_random_forest_(tuned)_missing_values_heatmap.png
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-14 14:10 - Saved temporal progression plots for 5 patients
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-14 14:10 - Saved error analysis plots to reports/evaluations/run_20241214_134915
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed: 0_Hour.png
12-14 14:10 - Saved plot: Final_random_forest_(tuned)_interaction_Unit1_Unit2.png
12-14 14:11 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 14:11 - Saved plot: Final_random_forest_(tuned)_interaction_Hour_ICULOS.png
12-14 14:11 - Saved plot: Final_random_forest_(tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 14:11 - Saved feature interaction plots for top 5 pairs
12-14 14:11 - No sepsis patients have predictions for timeline plots.
12-14 14:11 - Saved evaluation metrics to reports/evaluations/run_20241214_134915/Final_random_forest_(tuned)_metrics.json

12-14 14:11 - Final evaluation completed for Random Forest (Tuned).
12-14 14:11 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 14:11 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 14:11 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 14:11 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 14:11 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 14:11 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 14:11 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 14:11 - Missing values heatmap saved to reports/evaluations/run_20241214_134915/Random Forest (Tuned)_missing_values_heatmap.png
12-14 14:11 - Saved plot: Random_Forest_(Tuned)_temporal_patient_13491.png
12-14 14:11 - Saved plot: Random_Forest_(Tuned)_temporal_patient_109380.png
12-14 14:11 - Saved plot: Random_Forest_(Tuned)_temporal_patient_15235.png
12-14 14:11 - Saved plot: Random_Forest_(Tuned)_temporal_patient_100016.png
12-14 14:11 - Saved plot: Random_Forest_(Tuned)_temporal_patient_9513.png
12-14 14:11 - Saved temporal progression plots for 5 patients
12-14 14:11 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 14:11 - Saved error analysis plots to reports/evaluations/run_20241214_134915
12-14 14:11 - Error plotting feature interactions: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 2179, in plot_feature_interactions
    sns.scatterplot(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 14:11 - Error generating evaluation plots: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1394, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 2179, in plot_feature_interactions
    sns.scatterplot(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 14:11 - An error occurred during final evaluation: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1420, in main
    # Generate model card
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 444, in generate_model_card
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1394, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 2179, in plot_feature_interactions
    sns.scatterplot(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 14:11 - An error occurred: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1420, in main
    # Generate model card
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 444, in generate_model_card
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1394, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 2179, in plot_feature_interactions
    sns.scatterplot(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 14:11 - Phase Failed: Main
12-14 14:11 - Error: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1420, in main
    # Generate model card
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 444, in generate_model_card
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1394, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 2179, in plot_feature_interactions
    sns.scatterplot(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 14:11 - ================================================================================
12-14 14:16 - ================================================================================
12-14 14:16 - Starting Phase: Main
12-14 14:16 - --------------------------------------------------------------------------------
12-14 14:16 - Initial Memory Usage: 215.56 MB
12-14 14:16 - Starting Sepsis Prediction Pipeline
12-14 14:16 - Initial Memory Usage: 215.56 MB
12-14 14:16 - Reports and metrics will be saved to: reports/evaluations/run_20241214_141640
12-14 14:16 - Loading and preprocessing data.
12-14 14:16 - Splitting data into training, validation, and testing sets
12-14 14:16 - Starting step: Preprocessing training data
12-14 14:20 - ================================================================================
12-14 14:20 - Starting Phase: Main
12-14 14:20 - --------------------------------------------------------------------------------
12-14 14:20 - Initial Memory Usage: 216.17 MB
12-14 14:20 - Starting Sepsis Prediction Pipeline
12-14 14:20 - Initial Memory Usage: 216.19 MB
12-14 14:20 - Reports and metrics will be saved to: reports/evaluations/run_20241214_142056
12-14 14:20 - Loading and preprocessing data.
12-14 14:20 - Splitting data into training, validation, and testing sets
12-14 14:21 - Starting step: Preprocessing training data
12-14 14:24 - Completed step: Preprocessing training data (Duration: 226.55s)
12-14 14:24 - Starting step: Preprocessing validation data
12-14 14:25 - Completed step: Preprocessing validation data (Duration: 7.24s)
12-14 14:25 - Starting step: Preprocessing testing data
12-14 14:25 - Completed step: Preprocessing testing data (Duration: 7.40s)
12-14 14:25 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_142056.pkl
12-14 14:25 - Applying SMOTEENN to training data.
12-14 14:28 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 14:28 - Saved resampled data to checkpoints/resampled_data_20241214_142056.pkl
12-14 14:28 - Initializing new Optuna studies.
12-14 14:28 - Saved Optuna studies to checkpoints/optuna_studies_20241214_142056.pkl
12-14 14:28 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 14:28 - Optimizing Random Forest hyperparameters with Optuna.
12-14 14:50 - Best Random Forest parameters: {'n_estimators': 205, 'max_depth': 29, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_features': 'sqrt'}
12-14 14:50 - Random Forest - Total trials: 16
12-14 14:50 - Random Forest - Completed trials: 16
12-14 14:50 - Random Forest - Pruned trials: 0
12-14 14:50 - Random Forest - Failed trials: 0
12-14 14:50 - Training Random Forest (Tuned)...
12-14 14:51 - Training completed for Random Forest (Tuned).
12-14 14:51 - Predictions made for Random Forest (Tuned).
12-14 14:51 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 14:51 - 
Random Forest (Tuned) Evaluation:
12-14 14:51 -   Accuracy                  : 0.9746
12-14 14:51 -   Precision                 : 0.3201
12-14 14:51 -   Recall                    : 0.4955
12-14 14:51 -   F1 Score                  : 0.3890
12-14 14:51 -   Mean Absolute Error       : 0.0254
12-14 14:51 -   Root Mean Squared Error   : 0.1595
12-14 14:51 -   AUC-ROC                   : 0.9521
12-14 14:51 -   AUPRC                     : 0.3697
12-14 14:51 -   Specificity               : 0.9825
12-14 14:51 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 14:51 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 14:51 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 14:51 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 14:51 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 14:52 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 14:52 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 14:52 - Missing values heatmap saved to reports/evaluations/run_20241214_142056/Random Forest (Tuned)_missing_values_heatmap.png
12-14 14:52 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 14:52 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 14:52 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 14:52 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 14:52 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 14:52 - Saved temporal progression plots for 5 patients
12-14 14:52 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 14:52 - Saved error analysis plots to reports/evaluations/run_20241214_142056
12-14 14:52 - Plotting feature interactions for 44 features.
12-14 14:52 - Top 5 correlated feature pairs:
12-14 14:52 - Unit1 vs Unit2 with correlation 1.00
12-14 14:52 - Unnamed: 0 vs Hour with correlation 1.00
12-14 14:52 - Unnamed: 0 vs ICULOS with correlation 0.99
12-14 14:52 - Hour vs ICULOS with correlation 0.99
12-14 14:52 - Bilirubin_direct vs Bilirubin_total with correlation 0.96
12-14 14:52 - Saved plot: Random Forest (Tuned)_interaction_Unit1_Unit2.png
12-14 14:52 - Saved plot: Random Forest (Tuned)_interaction_Unnamed_ 0_Hour.png
12-14 14:52 - Saved plot: Random Forest (Tuned)_interaction_Unnamed_ 0_ICULOS.png
12-14 14:52 - Saved plot: Random Forest (Tuned)_interaction_Hour_ICULOS.png
12-14 14:52 - Saved plot: Random Forest (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 14:52 - Saved feature interaction plots for top 5 pairs.
12-14 14:52 - No sepsis patients have predictions for timeline plots.
12-14 14:52 - Saved evaluation metrics to reports/evaluations/run_20241214_142056/Random Forest (Tuned)_metrics.json

12-14 14:52 - Evaluation completed for Random Forest (Tuned).
12-14 14:52 - New best model: Random Forest (Tuned) with F1 Score: 0.3890
12-14 14:52 - Saved hyperparameters to reports/evaluations/run_20241214_142056/random_forest_tuned_params.json
12-14 14:52 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 14:53 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 14:53 - Logistic Regression - Total trials: 16
12-14 14:53 - Logistic Regression - Completed trials: 16
12-14 14:53 - Logistic Regression - Pruned trials: 0
12-14 14:53 - Logistic Regression - Failed trials: 0
12-14 14:53 - Training Logistic Regression (Tuned)...
12-14 14:53 - Training completed for Logistic Regression (Tuned).
12-14 14:53 - Predictions made for Logistic Regression (Tuned).
12-14 14:53 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 14:53 - 
Logistic Regression (Tuned) Evaluation:
12-14 14:53 -   Accuracy                  : 0.9462
12-14 14:53 -   Precision                 : 0.1906
12-14 14:53 -   Recall                    : 0.7050
12-14 14:53 -   F1 Score                  : 0.3001
12-14 14:53 -   Mean Absolute Error       : 0.0538
12-14 14:53 -   Root Mean Squared Error   : 0.2319
12-14 14:53 -   AUC-ROC                   : 0.8967
12-14 14:53 -   AUPRC                     : 0.1454
12-14 14:53 -   Specificity               : 0.9502
12-14 14:53 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 14:53 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 14:53 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 14:53 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 14:53 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 14:53 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 14:53 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 14:53 - Missing values heatmap saved to reports/evaluations/run_20241214_142056/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 14:53 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 14:53 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 14:53 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 14:53 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 14:53 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 14:53 - Saved temporal progression plots for 5 patients
12-14 14:53 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 14:53 - Saved error analysis plots to reports/evaluations/run_20241214_142056
12-14 14:53 - Plotting feature interactions for 44 features.
12-14 14:53 - Top 5 correlated feature pairs:
12-14 14:53 - Unit1 vs Unit2 with correlation 1.00
12-14 14:53 - Unnamed: 0 vs Hour with correlation 1.00
12-14 14:53 - Unnamed: 0 vs ICULOS with correlation 0.99
12-14 14:53 - Hour vs ICULOS with correlation 0.99
12-14 14:53 - Bilirubin_direct vs Bilirubin_total with correlation 0.96
12-14 14:53 - Saved plot: Logistic Regression (Tuned)_interaction_Unit1_Unit2.png
12-14 14:53 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed_ 0_Hour.png
12-14 14:53 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed_ 0_ICULOS.png
12-14 14:53 - Saved plot: Logistic Regression (Tuned)_interaction_Hour_ICULOS.png
12-14 14:53 - Saved plot: Logistic Regression (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 14:53 - Saved feature interaction plots for top 5 pairs.
12-14 14:53 - No sepsis patients have predictions for timeline plots.
12-14 14:53 - Saved evaluation metrics to reports/evaluations/run_20241214_142056/Logistic Regression (Tuned)_metrics.json

12-14 14:53 - Evaluation completed for Logistic Regression (Tuned).
12-14 14:53 - Saved hyperparameters to reports/evaluations/run_20241214_142056/logistic_regression_tuned_params.json
12-14 14:53 - Optimizing XGBoost hyperparameters with Optuna.
12-14 14:54 - Best XGBoost parameters: {'n_estimators': 457, 'max_depth': 9, 'learning_rate': 0.17255776234553302, 'subsample': 0.7574329529424287, 'colsample_bytree': 0.5433439671072606, 'gamma': 0.012455929246615097, 'reg_alpha': 0.07875095024685662, 'reg_lambda': 0.5035646682042978}
12-14 14:54 - XGBoost - Total trials: 43
12-14 14:54 - XGBoost - Completed trials: 43
12-14 14:54 - XGBoost - Pruned trials: 0
12-14 14:54 - XGBoost - Failed trials: 0
12-14 14:54 - Training XGBoost (Tuned)...
12-14 14:54 - Training completed for XGBoost (Tuned).
12-14 14:54 - Predictions made for XGBoost (Tuned).
12-14 14:54 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 14:54 - 
XGBoost (Tuned) Evaluation:
12-14 14:54 -   Accuracy                  : 0.9626
12-14 14:54 -   Precision                 : 0.2616
12-14 14:54 -   Recall                    : 0.7076
12-14 14:54 -   F1 Score                  : 0.3820
12-14 14:54 -   Mean Absolute Error       : 0.0374
12-14 14:54 -   Root Mean Squared Error   : 0.1935
12-14 14:54 -   AUC-ROC                   : 0.9441
12-14 14:54 -   AUPRC                     : 0.4476
12-14 14:54 -   Specificity               : 0.9668
12-14 14:54 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 14:54 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 14:54 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 14:54 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 14:54 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 14:54 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 14:54 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 14:54 - Missing values heatmap saved to reports/evaluations/run_20241214_142056/XGBoost (Tuned)_missing_values_heatmap.png
12-14 14:54 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 14:54 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 14:54 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 14:54 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 14:54 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 14:54 - Saved temporal progression plots for 5 patients
12-14 14:54 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 14:54 - Saved error analysis plots to reports/evaluations/run_20241214_142056
12-14 14:54 - Plotting feature interactions for 44 features.
12-14 14:54 - Top 5 correlated feature pairs:
12-14 14:54 - Unit1 vs Unit2 with correlation 1.00
12-14 14:54 - Unnamed: 0 vs Hour with correlation 1.00
12-14 14:54 - Unnamed: 0 vs ICULOS with correlation 0.99
12-14 14:54 - Hour vs ICULOS with correlation 0.99
12-14 14:54 - Bilirubin_direct vs Bilirubin_total with correlation 0.96
12-14 14:54 - Saved plot: XGBoost (Tuned)_interaction_Unit1_Unit2.png
12-14 14:55 - Saved plot: XGBoost (Tuned)_interaction_Unnamed_ 0_Hour.png
12-14 14:55 - Saved plot: XGBoost (Tuned)_interaction_Unnamed_ 0_ICULOS.png
12-14 14:55 - Saved plot: XGBoost (Tuned)_interaction_Hour_ICULOS.png
12-14 14:55 - Saved plot: XGBoost (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 14:55 - Saved feature interaction plots for top 5 pairs.
12-14 14:55 - No sepsis patients have predictions for timeline plots.
12-14 14:55 - Saved evaluation metrics to reports/evaluations/run_20241214_142056/XGBoost (Tuned)_metrics.json

12-14 14:55 - Evaluation completed for XGBoost (Tuned).
12-14 14:55 - Saved hyperparameters to reports/evaluations/run_20241214_142056/xgboost_tuned_params.json
12-14 14:55 - Saved trained models to checkpoints/trained_models_20241214_142056.pkl
12-14 14:55 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_142056.pkl
12-14 14:55 - Saved trial data to reports/evaluations/run_20241214_142056/random_forest_optimization_optimization_trials.csv
12-14 14:55 - Saved trial data to reports/evaluations/run_20241214_142056/logistic_regression_optimization_optimization_trials.csv
12-14 14:55 - Saved trial data to reports/evaluations/run_20241214_142056/xgboost_optimization_optimization_trials.csv
12-14 14:55 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 14:55 - Predictions made with Random Forest (Tuned) on test set.
12-14 14:55 - 
Final_random_forest_(tuned) Evaluation:
12-14 14:55 -   Accuracy                  : 0.9873
12-14 14:55 -   Precision                 : 0.6384
12-14 14:55 -   Recall                    : 0.4911
12-14 14:55 -   F1 Score                  : 0.5551
12-14 14:55 -   Mean Absolute Error       : 0.0127
12-14 14:55 -   Root Mean Squared Error   : 0.1127
12-14 14:55 -   AUC-ROC                   : 0.9747
12-14 14:55 -   AUPRC                     : 0.6051
12-14 14:55 -   Specificity               : 0.9954
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-14 14:55 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 14:55 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 14:55 - Missing values heatmap saved to reports/evaluations/run_20241214_142056/Final_random_forest_(tuned)_missing_values_heatmap.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-14 14:55 - Saved temporal progression plots for 5 patients
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-14 14:55 - Saved error analysis plots to reports/evaluations/run_20241214_142056
12-14 14:55 - Plotting feature interactions for 44 features.
12-14 14:55 - Top 5 correlated feature pairs:
12-14 14:55 - Unnamed: 0 vs Hour with correlation 1.00
12-14 14:55 - Unit1 vs Unit2 with correlation 1.00
12-14 14:55 - Unnamed: 0 vs ICULOS with correlation 1.00
12-14 14:55 - Hour vs ICULOS with correlation 1.00
12-14 14:55 - Bilirubin_direct vs Bilirubin_total with correlation 0.98
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed_ 0_Hour.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_interaction_Unit1_Unit2.png
12-14 14:55 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed_ 0_ICULOS.png
12-14 14:56 - Saved plot: Final_random_forest_(tuned)_interaction_Hour_ICULOS.png
12-14 14:56 - Saved plot: Final_random_forest_(tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 14:56 - Saved feature interaction plots for top 5 pairs.
12-14 14:56 - No sepsis patients have predictions for timeline plots.
12-14 14:56 - Saved evaluation metrics to reports/evaluations/run_20241214_142056/Final_random_forest_(tuned)_metrics.json

12-14 14:56 - Final evaluation completed for Random Forest (Tuned).
12-14 14:56 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 14:56 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 14:56 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 14:56 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 14:56 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 14:56 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 14:56 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 14:56 - Missing values heatmap saved to reports/evaluations/run_20241214_142056/Random Forest (Tuned)_missing_values_heatmap.png
12-14 14:56 - Saved plot: Random_Forest_(Tuned)_temporal_patient_13491.png
12-14 14:56 - Saved plot: Random_Forest_(Tuned)_temporal_patient_109380.png
12-14 14:56 - Saved plot: Random_Forest_(Tuned)_temporal_patient_15235.png
12-14 14:56 - Saved plot: Random_Forest_(Tuned)_temporal_patient_100016.png
12-14 14:56 - Saved plot: Random_Forest_(Tuned)_temporal_patient_9513.png
12-14 14:56 - Saved temporal progression plots for 5 patients
12-14 14:56 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 14:56 - Saved error analysis plots to reports/evaluations/run_20241214_142056
12-14 14:56 - Plotting feature interactions for 21 features.
12-14 14:56 - Top 5 correlated feature pairs:
12-14 14:56 - Unit1 vs Unit2 with correlation 1.00
12-14 14:56 - Unit1 vs HospAdmTime with correlation 1.00
12-14 14:56 - Unit1 vs ICULOS with correlation 1.00
12-14 14:56 - Unit2 vs HospAdmTime with correlation 1.00
12-14 14:56 - Unit2 vs ICULOS with correlation 1.00
12-14 14:56 - Error plotting interaction for Unit1 vs Unit2: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 14:56 - Error plotting interaction for Unit1 vs HospAdmTime: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 14:56 - Error plotting interaction for Unit1 vs ICULOS: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 14:56 - Error plotting interaction for Unit2 vs HospAdmTime: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 14:56 - Error plotting interaction for Unit2 vs ICULOS: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 14:56 - Saved feature interaction plots for top 5 pairs.
12-14 14:56 - No sepsis patients have predictions for timeline plots.
12-14 14:56 - Model card saved to reports/evaluations/run_20241214_142056/Random Forest (Tuned)_model_card.md
12-14 14:56 - Saving the best model (Random Forest (Tuned))
12-14 14:56 - An error occurred during final evaluation: 'NoneType' object has no attribute 'get_params'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1441, in main
    ).get_params()
AttributeError: 'NoneType' object has no attribute 'get_params'
12-14 14:56 - An error occurred: 'NoneType' object has no attribute 'get_params'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1441, in main
    ).get_params()
AttributeError: 'NoneType' object has no attribute 'get_params'
12-14 14:56 - Phase Failed: Main
12-14 14:56 - Error: 'NoneType' object has no attribute 'get_params'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1441, in main
    ).get_params()
AttributeError: 'NoneType' object has no attribute 'get_params'
12-14 14:56 - ================================================================================
12-14 15:04 - ================================================================================
12-14 15:04 - Starting Phase: Main
12-14 15:04 - --------------------------------------------------------------------------------
12-14 15:04 - Initial Memory Usage: 215.44 MB
12-14 15:04 - Starting Sepsis Prediction Pipeline
12-14 15:04 - Initial Memory Usage: 215.44 MB
12-14 15:04 - Reports and metrics will be saved to: reports/evaluations/run_20241214_150409
12-14 15:04 - Loading and preprocessing data.
12-14 15:04 - Splitting data into training, validation, and testing sets
12-14 15:04 - Starting step: Preprocessing training data
12-14 15:08 - Completed step: Preprocessing training data (Duration: 233.54s)
12-14 15:08 - Starting step: Preprocessing validation data
12-14 15:08 - Completed step: Preprocessing validation data (Duration: 7.32s)
12-14 15:08 - Starting step: Preprocessing testing data
12-14 15:08 - Completed step: Preprocessing testing data (Duration: 7.52s)
12-14 15:08 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_150409.pkl
12-14 15:08 - Applying SMOTEENN to training data.
12-14 15:12 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 15:12 - Saved resampled data to checkpoints/resampled_data_20241214_150409.pkl
12-14 15:12 - Initializing new Optuna studies.
12-14 15:12 - Saved Optuna studies to checkpoints/optuna_studies_20241214_150409.pkl
12-14 15:12 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 15:12 - Optimizing Random Forest hyperparameters with Optuna.
12-14 15:14 - Best Random Forest parameters: {'n_estimators': 205, 'max_depth': 29, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_features': 'sqrt'}
12-14 15:14 - Random Forest - Total trials: 17
12-14 15:14 - Random Forest - Completed trials: 17
12-14 15:14 - Random Forest - Pruned trials: 0
12-14 15:14 - Random Forest - Failed trials: 0
12-14 15:14 - Training Random Forest (Tuned)...
12-14 15:16 - Training completed for Random Forest (Tuned).
12-14 15:16 - Predictions made for Random Forest (Tuned).
12-14 15:16 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 15:16 - 
Random Forest (Tuned) Evaluation:
12-14 15:16 -   Accuracy                  : 0.9746
12-14 15:16 -   Precision                 : 0.3201
12-14 15:16 -   Recall                    : 0.4955
12-14 15:16 -   F1 Score                  : 0.3890
12-14 15:16 -   Mean Absolute Error       : 0.0254
12-14 15:16 -   Root Mean Squared Error   : 0.1595
12-14 15:16 -   AUC-ROC                   : 0.9521
12-14 15:16 -   AUPRC                     : 0.3697
12-14 15:16 -   Specificity               : 0.9825
12-14 15:16 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 15:16 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 15:16 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 15:16 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 15:16 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 15:16 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 15:16 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 15:16 - Missing values heatmap saved to reports/evaluations/run_20241214_150409/Random Forest (Tuned)_missing_values_heatmap.png
12-14 15:16 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 15:16 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 15:16 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 15:16 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 15:16 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 15:16 - Saved temporal progression plots for 5 patients
12-14 15:16 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 15:16 - Saved error analysis plots to reports/evaluations/run_20241214_150409
12-14 15:16 - Plotting feature interactions for 44 features.
12-14 15:16 - Top 5 correlated feature pairs:
12-14 15:16 - Unit1 vs Unit2 with correlation 1.00
12-14 15:16 - Unnamed: 0 vs Hour with correlation 1.00
12-14 15:16 - Unnamed: 0 vs ICULOS with correlation 0.99
12-14 15:16 - Hour vs ICULOS with correlation 0.99
12-14 15:16 - Bilirubin_direct vs Bilirubin_total with correlation 0.96
12-14 15:16 - Saved plot: Random Forest (Tuned)_interaction_Unit1_Unit2.png
12-14 15:16 - Saved plot: Random Forest (Tuned)_interaction_Unnamed_ 0_Hour.png
12-14 15:16 - Saved plot: Random Forest (Tuned)_interaction_Unnamed_ 0_ICULOS.png
12-14 15:16 - Saved plot: Random Forest (Tuned)_interaction_Hour_ICULOS.png
12-14 15:16 - Saved plot: Random Forest (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 15:16 - Saved feature interaction plots for top 5 pairs.
12-14 15:16 - No sepsis patients have predictions for timeline plots.
12-14 15:16 - Saved evaluation metrics to reports/evaluations/run_20241214_150409/Random Forest (Tuned)_metrics.json

12-14 15:16 - Evaluation completed for Random Forest (Tuned).
12-14 15:16 - New best model: Random Forest (Tuned) with F1 Score: 0.3890
12-14 15:16 - Saved hyperparameters to reports/evaluations/run_20241214_150409/random_forest_tuned_params.json
12-14 15:16 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 15:17 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 15:17 - Logistic Regression - Total trials: 17
12-14 15:17 - Logistic Regression - Completed trials: 17
12-14 15:17 - Logistic Regression - Pruned trials: 0
12-14 15:17 - Logistic Regression - Failed trials: 0
12-14 15:17 - Training Logistic Regression (Tuned)...
12-14 15:17 - Training completed for Logistic Regression (Tuned).
12-14 15:17 - Predictions made for Logistic Regression (Tuned).
12-14 15:17 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 15:17 - 
Logistic Regression (Tuned) Evaluation:
12-14 15:17 -   Accuracy                  : 0.9462
12-14 15:17 -   Precision                 : 0.1906
12-14 15:17 -   Recall                    : 0.7050
12-14 15:17 -   F1 Score                  : 0.3001
12-14 15:17 -   Mean Absolute Error       : 0.0538
12-14 15:17 -   Root Mean Squared Error   : 0.2319
12-14 15:17 -   AUC-ROC                   : 0.8967
12-14 15:17 -   AUPRC                     : 0.1454
12-14 15:17 -   Specificity               : 0.9502
12-14 15:17 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 15:17 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 15:17 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 15:17 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 15:17 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 15:17 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 15:17 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 15:17 - Missing values heatmap saved to reports/evaluations/run_20241214_150409/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 15:17 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 15:17 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 15:17 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 15:17 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 15:17 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 15:17 - Saved temporal progression plots for 5 patients
12-14 15:17 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 15:17 - Saved error analysis plots to reports/evaluations/run_20241214_150409
12-14 15:17 - Plotting feature interactions for 44 features.
12-14 15:17 - Top 5 correlated feature pairs:
12-14 15:17 - Unit1 vs Unit2 with correlation 1.00
12-14 15:17 - Unnamed: 0 vs Hour with correlation 1.00
12-14 15:17 - Unnamed: 0 vs ICULOS with correlation 0.99
12-14 15:17 - Hour vs ICULOS with correlation 0.99
12-14 15:17 - Bilirubin_direct vs Bilirubin_total with correlation 0.96
12-14 15:17 - Saved plot: Logistic Regression (Tuned)_interaction_Unit1_Unit2.png
12-14 15:17 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed_ 0_Hour.png
12-14 15:18 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed_ 0_ICULOS.png
12-14 15:18 - Saved plot: Logistic Regression (Tuned)_interaction_Hour_ICULOS.png
12-14 15:18 - Saved plot: Logistic Regression (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 15:18 - Saved feature interaction plots for top 5 pairs.
12-14 15:18 - No sepsis patients have predictions for timeline plots.
12-14 15:18 - Saved evaluation metrics to reports/evaluations/run_20241214_150409/Logistic Regression (Tuned)_metrics.json

12-14 15:18 - Evaluation completed for Logistic Regression (Tuned).
12-14 15:18 - Saved hyperparameters to reports/evaluations/run_20241214_150409/logistic_regression_tuned_params.json
12-14 15:18 - Optimizing XGBoost hyperparameters with Optuna.
12-14 15:18 - Best XGBoost parameters: {'n_estimators': 457, 'max_depth': 9, 'learning_rate': 0.17255776234553302, 'subsample': 0.7574329529424287, 'colsample_bytree': 0.5433439671072606, 'gamma': 0.012455929246615097, 'reg_alpha': 0.07875095024685662, 'reg_lambda': 0.5035646682042978}
12-14 15:18 - XGBoost - Total trials: 44
12-14 15:18 - XGBoost - Completed trials: 44
12-14 15:18 - XGBoost - Pruned trials: 0
12-14 15:18 - XGBoost - Failed trials: 0
12-14 15:18 - Training XGBoost (Tuned)...
12-14 15:18 - Training completed for XGBoost (Tuned).
12-14 15:18 - Predictions made for XGBoost (Tuned).
12-14 15:18 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 15:18 - 
XGBoost (Tuned) Evaluation:
12-14 15:18 -   Accuracy                  : 0.9626
12-14 15:18 -   Precision                 : 0.2616
12-14 15:18 -   Recall                    : 0.7076
12-14 15:18 -   F1 Score                  : 0.3820
12-14 15:18 -   Mean Absolute Error       : 0.0374
12-14 15:18 -   Root Mean Squared Error   : 0.1935
12-14 15:18 -   AUC-ROC                   : 0.9441
12-14 15:18 -   AUPRC                     : 0.4476
12-14 15:18 -   Specificity               : 0.9668
12-14 15:18 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 15:18 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 15:18 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 15:18 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 15:18 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 15:18 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 15:18 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 15:19 - Missing values heatmap saved to reports/evaluations/run_20241214_150409/XGBoost (Tuned)_missing_values_heatmap.png
12-14 15:19 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 15:19 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 15:19 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 15:19 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 15:19 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 15:19 - Saved temporal progression plots for 5 patients
12-14 15:19 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 15:19 - Saved error analysis plots to reports/evaluations/run_20241214_150409
12-14 15:19 - Plotting feature interactions for 44 features.
12-14 15:19 - Top 5 correlated feature pairs:
12-14 15:19 - Unit1 vs Unit2 with correlation 1.00
12-14 15:19 - Unnamed: 0 vs Hour with correlation 1.00
12-14 15:19 - Unnamed: 0 vs ICULOS with correlation 0.99
12-14 15:19 - Hour vs ICULOS with correlation 0.99
12-14 15:19 - Bilirubin_direct vs Bilirubin_total with correlation 0.96
12-14 15:19 - Saved plot: XGBoost (Tuned)_interaction_Unit1_Unit2.png
12-14 15:19 - Saved plot: XGBoost (Tuned)_interaction_Unnamed_ 0_Hour.png
12-14 15:19 - Saved plot: XGBoost (Tuned)_interaction_Unnamed_ 0_ICULOS.png
12-14 15:19 - Saved plot: XGBoost (Tuned)_interaction_Hour_ICULOS.png
12-14 15:19 - Saved plot: XGBoost (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 15:19 - Saved feature interaction plots for top 5 pairs.
12-14 15:19 - No sepsis patients have predictions for timeline plots.
12-14 15:19 - Saved evaluation metrics to reports/evaluations/run_20241214_150409/XGBoost (Tuned)_metrics.json

12-14 15:19 - Evaluation completed for XGBoost (Tuned).
12-14 15:19 - Saved hyperparameters to reports/evaluations/run_20241214_150409/xgboost_tuned_params.json
12-14 15:19 - Saved trained models to checkpoints/trained_models_20241214_150409.pkl
12-14 15:19 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_150409.pkl
12-14 15:19 - Saved trial data to reports/evaluations/run_20241214_150409/random_forest_optimization_optimization_trials.csv
12-14 15:19 - Saved trial data to reports/evaluations/run_20241214_150409/logistic_regression_optimization_optimization_trials.csv
12-14 15:19 - Saved trial data to reports/evaluations/run_20241214_150409/xgboost_optimization_optimization_trials.csv
12-14 15:19 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 15:19 - Predictions made with Random Forest (Tuned) on test set.
12-14 15:19 - 
Final_random_forest_(tuned) Evaluation:
12-14 15:19 -   Accuracy                  : 0.9873
12-14 15:19 -   Precision                 : 0.6384
12-14 15:19 -   Recall                    : 0.4911
12-14 15:19 -   F1 Score                  : 0.5551
12-14 15:19 -   Mean Absolute Error       : 0.0127
12-14 15:19 -   Root Mean Squared Error   : 0.1127
12-14 15:19 -   AUC-ROC                   : 0.9747
12-14 15:19 -   AUPRC                     : 0.6051
12-14 15:19 -   Specificity               : 0.9954
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-14 15:19 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 15:19 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 15:19 - Missing values heatmap saved to reports/evaluations/run_20241214_150409/Final_random_forest_(tuned)_missing_values_heatmap.png
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-14 15:19 - Saved temporal progression plots for 5 patients
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-14 15:19 - Saved error analysis plots to reports/evaluations/run_20241214_150409
12-14 15:19 - Plotting feature interactions for 44 features.
12-14 15:19 - Top 5 correlated feature pairs:
12-14 15:19 - Unnamed: 0 vs Hour with correlation 1.00
12-14 15:19 - Unit1 vs Unit2 with correlation 1.00
12-14 15:19 - Unnamed: 0 vs ICULOS with correlation 1.00
12-14 15:19 - Hour vs ICULOS with correlation 1.00
12-14 15:19 - Bilirubin_direct vs Bilirubin_total with correlation 0.98
12-14 15:19 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed_ 0_Hour.png
12-14 15:20 - Saved plot: Final_random_forest_(tuned)_interaction_Unit1_Unit2.png
12-14 15:20 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed_ 0_ICULOS.png
12-14 15:20 - Saved plot: Final_random_forest_(tuned)_interaction_Hour_ICULOS.png
12-14 15:20 - Saved plot: Final_random_forest_(tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 15:20 - Saved feature interaction plots for top 5 pairs.
12-14 15:20 - No sepsis patients have predictions for timeline plots.
12-14 15:20 - Saved evaluation metrics to reports/evaluations/run_20241214_150409/Final_random_forest_(tuned)_metrics.json

12-14 15:20 - Final evaluation completed for Random Forest (Tuned).
12-14 15:20 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 15:20 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 15:20 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 15:20 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 15:20 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 15:20 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 15:20 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 15:20 - Missing values heatmap saved to reports/evaluations/run_20241214_150409/Random Forest (Tuned)_missing_values_heatmap.png
12-14 15:20 - Saved plot: Random_Forest_(Tuned)_temporal_patient_13491.png
12-14 15:20 - Saved plot: Random_Forest_(Tuned)_temporal_patient_109380.png
12-14 15:20 - Saved plot: Random_Forest_(Tuned)_temporal_patient_15235.png
12-14 15:20 - Saved plot: Random_Forest_(Tuned)_temporal_patient_100016.png
12-14 15:20 - Saved plot: Random_Forest_(Tuned)_temporal_patient_9513.png
12-14 15:20 - Saved temporal progression plots for 5 patients
12-14 15:20 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 15:20 - Saved error analysis plots to reports/evaluations/run_20241214_150409
12-14 15:20 - Plotting feature interactions for 21 features.
12-14 15:20 - Top 5 correlated feature pairs:
12-14 15:20 - Unit1 vs Unit2 with correlation 1.00
12-14 15:20 - Unit1 vs HospAdmTime with correlation 1.00
12-14 15:20 - Unit1 vs ICULOS with correlation 1.00
12-14 15:20 - Unit2 vs HospAdmTime with correlation 1.00
12-14 15:20 - Unit2 vs ICULOS with correlation 1.00
12-14 15:20 - Error plotting interaction for Unit1 vs Unit2: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 15:20 - Error plotting interaction for Unit1 vs HospAdmTime: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 15:20 - Error plotting interaction for Unit1 vs ICULOS: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 15:20 - Error plotting interaction for Unit2 vs HospAdmTime: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 15:20 - Error plotting interaction for Unit2 vs ICULOS: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 15:20 - Saved feature interaction plots for top 5 pairs.
12-14 15:20 - No sepsis patients have predictions for timeline plots.
12-14 15:20 - Model card saved to reports/evaluations/run_20241214_150409/Random Forest (Tuned)_model_card.md
12-14 15:20 - Saved model 'Random Forest (Tuned)' version 'v1' to 'models/Random Forest (Tuned)_20241214_152025_39ed4a'
12-14 15:20 - Model (Random Forest (Tuned)) saved successfully.
12-14 15:20 - Sepsis Prediction Pipeline completed successfully.
12-14 15:20 - --------------------------------------------------------------------------------
12-14 15:20 - Phase Complete: Main
12-14 15:20 - Duration: 976.19 seconds
12-14 15:20 - Final Memory Usage: 1166.53 MB
12-14 15:20 - Memory Change: +951.09 MB
12-14 15:20 - ================================================================================
12-14 15:24 - ================================================================================
12-14 15:24 - Starting Phase: Main
12-14 15:24 - --------------------------------------------------------------------------------
12-14 15:24 - Initial Memory Usage: 214.50 MB
12-14 15:24 - Starting Sepsis Prediction Pipeline
12-14 15:24 - Initial Memory Usage: 214.50 MB
12-14 15:24 - Reports and metrics will be saved to: reports/evaluations/run_20241214_152455
12-14 15:24 - Loading and preprocessing data.
12-14 15:24 - Splitting data into training, validation, and testing sets
12-14 15:25 - Starting step: Preprocessing training data
12-14 15:37 - Completed step: Preprocessing training data (Duration: 709.41s)
12-14 15:37 - Starting step: Preprocessing validation data
12-14 15:37 - Completed step: Preprocessing validation data (Duration: 6.96s)
12-14 15:37 - Starting step: Preprocessing testing data
12-14 15:37 - Completed step: Preprocessing testing data (Duration: 7.17s)
12-14 15:37 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_152455.pkl
12-14 15:37 - Applying SMOTEENN to training data.
12-14 15:40 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 15:40 - Saved resampled data to checkpoints/resampled_data_20241214_152455.pkl
12-14 15:40 - Initializing new Optuna studies.
12-14 15:40 - Saved Optuna studies to checkpoints/optuna_studies_20241214_152455.pkl
12-14 15:40 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 15:40 - Optimizing Random Forest hyperparameters with Optuna.
12-14 15:43 - Best Random Forest parameters: {'n_estimators': 205, 'max_depth': 29, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_features': 'sqrt'}
12-14 15:43 - Random Forest - Total trials: 18
12-14 15:43 - Random Forest - Completed trials: 18
12-14 15:43 - Random Forest - Pruned trials: 0
12-14 15:43 - Random Forest - Failed trials: 0
12-14 15:43 - Training Random Forest (Tuned)...
12-14 15:44 - Training completed for Random Forest (Tuned).
12-14 15:44 - Predictions made for Random Forest (Tuned).
12-14 15:44 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 15:44 - 
Random Forest (Tuned) Evaluation:
12-14 15:44 -   Accuracy                  : 0.9747
12-14 15:44 -   Precision                 : 0.3209
12-14 15:44 -   Recall                    : 0.4916
12-14 15:44 -   F1 Score                  : 0.3883
12-14 15:44 -   Mean Absolute Error       : 0.0253
12-14 15:44 -   Root Mean Squared Error   : 0.1591
12-14 15:44 -   AUC-ROC                   : 0.9512
12-14 15:44 -   AUPRC                     : 0.3673
12-14 15:44 -   Specificity               : 0.9827
12-14 15:44 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 15:44 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 15:44 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 15:44 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 15:44 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 15:44 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 15:44 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 15:44 - Missing values heatmap saved to reports/evaluations/run_20241214_152455/Random Forest (Tuned)_missing_values_heatmap.png
12-14 15:44 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 15:44 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 15:44 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 15:44 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 15:44 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 15:44 - Saved temporal progression plots for 5 patients
12-14 15:44 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 15:44 - Saved error analysis plots to reports/evaluations/run_20241214_152455
12-14 15:45 - Saved feature interaction plots for top 5 pairs
12-14 15:45 - No sepsis patients have predictions for timeline plots.
12-14 15:45 - Saved evaluation metrics to reports/evaluations/run_20241214_152455/Random Forest (Tuned)_metrics.json

12-14 15:45 - Evaluation completed for Random Forest (Tuned).
12-14 15:45 - New best model: Random Forest (Tuned) with F1 Score: 0.3883
12-14 15:45 - Saved hyperparameters to reports/evaluations/run_20241214_152455/random_forest_tuned_params.json
12-14 15:45 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 15:48 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 15:48 - Logistic Regression - Total trials: 18
12-14 15:48 - Logistic Regression - Completed trials: 18
12-14 15:48 - Logistic Regression - Pruned trials: 0
12-14 15:48 - Logistic Regression - Failed trials: 0
12-14 15:48 - Training Logistic Regression (Tuned)...
12-14 15:49 - Training completed for Logistic Regression (Tuned).
12-14 15:49 - Predictions made for Logistic Regression (Tuned).
12-14 15:49 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 15:49 - 
Logistic Regression (Tuned) Evaluation:
12-14 15:49 -   Accuracy                  : 0.9461
12-14 15:49 -   Precision                 : 0.1900
12-14 15:49 -   Recall                    : 0.7050
12-14 15:49 -   F1 Score                  : 0.2994
12-14 15:49 -   Mean Absolute Error       : 0.0539
12-14 15:49 -   Root Mean Squared Error   : 0.2323
12-14 15:49 -   AUC-ROC                   : 0.8963
12-14 15:49 -   AUPRC                     : 0.1447
12-14 15:49 -   Specificity               : 0.9501
12-14 15:49 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 15:49 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 15:49 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 15:49 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 15:49 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 15:49 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 15:49 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 15:49 - Missing values heatmap saved to reports/evaluations/run_20241214_152455/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 15:49 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 15:49 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 15:49 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 15:49 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 15:49 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 15:49 - Saved temporal progression plots for 5 patients
12-14 15:49 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 15:49 - Saved error analysis plots to reports/evaluations/run_20241214_152455
12-14 15:49 - Saved feature interaction plots for top 5 pairs
12-14 15:49 - No sepsis patients have predictions for timeline plots.
12-14 15:49 - Saved evaluation metrics to reports/evaluations/run_20241214_152455/Logistic Regression (Tuned)_metrics.json

12-14 15:49 - Evaluation completed for Logistic Regression (Tuned).
12-14 15:49 - Saved hyperparameters to reports/evaluations/run_20241214_152455/logistic_regression_tuned_params.json
12-14 15:49 - Optimizing XGBoost hyperparameters with Optuna.
12-14 15:50 - Best XGBoost parameters: {'n_estimators': 457, 'max_depth': 9, 'learning_rate': 0.17255776234553302, 'subsample': 0.7574329529424287, 'colsample_bytree': 0.5433439671072606, 'gamma': 0.012455929246615097, 'reg_alpha': 0.07875095024685662, 'reg_lambda': 0.5035646682042978}
12-14 15:50 - XGBoost - Total trials: 45
12-14 15:50 - XGBoost - Completed trials: 45
12-14 15:50 - XGBoost - Pruned trials: 0
12-14 15:50 - XGBoost - Failed trials: 0
12-14 15:50 - Training XGBoost (Tuned)...
12-14 15:50 - Training completed for XGBoost (Tuned).
12-14 15:50 - Predictions made for XGBoost (Tuned).
12-14 15:50 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 15:50 - 
XGBoost (Tuned) Evaluation:
12-14 15:50 -   Accuracy                  : 0.9627
12-14 15:50 -   Precision                 : 0.2632
12-14 15:50 -   Recall                    : 0.7115
12-14 15:50 -   F1 Score                  : 0.3843
12-14 15:50 -   Mean Absolute Error       : 0.0373
12-14 15:50 -   Root Mean Squared Error   : 0.1931
12-14 15:50 -   AUC-ROC                   : 0.9452
12-14 15:50 -   AUPRC                     : 0.4544
12-14 15:50 -   Specificity               : 0.9669
12-14 15:50 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 15:50 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 15:50 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 15:50 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 15:50 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 15:50 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 15:50 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 15:50 - Missing values heatmap saved to reports/evaluations/run_20241214_152455/XGBoost (Tuned)_missing_values_heatmap.png
12-14 15:50 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 15:50 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 15:50 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 15:50 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 15:50 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 15:50 - Saved temporal progression plots for 5 patients
12-14 15:50 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 15:50 - Saved error analysis plots to reports/evaluations/run_20241214_152455
12-14 15:50 - Saved feature interaction plots for top 5 pairs
12-14 15:50 - No sepsis patients have predictions for timeline plots.
12-14 15:50 - Saved evaluation metrics to reports/evaluations/run_20241214_152455/XGBoost (Tuned)_metrics.json

12-14 15:50 - Evaluation completed for XGBoost (Tuned).
12-14 15:50 - Saved hyperparameters to reports/evaluations/run_20241214_152455/xgboost_tuned_params.json
12-14 15:50 - Saved trained models to checkpoints/trained_models_20241214_152455.pkl
12-14 15:50 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_152455.pkl
12-14 15:50 - Saved trial data to reports/evaluations/run_20241214_152455/random_forest_optimization_optimization_trials.csv
12-14 15:50 - Saved trial data to reports/evaluations/run_20241214_152455/logistic_regression_optimization_optimization_trials.csv
12-14 15:50 - Saved trial data to reports/evaluations/run_20241214_152455/xgboost_optimization_optimization_trials.csv
12-14 15:50 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 15:50 - Predictions made with Random Forest (Tuned) on test set.
12-14 15:50 - 
Final_random_forest_(tuned) Evaluation:
12-14 15:50 -   Accuracy                  : 0.9876
12-14 15:50 -   Precision                 : 0.6553
12-14 15:50 -   Recall                    : 0.4879
12-14 15:50 -   F1 Score                  : 0.5593
12-14 15:50 -   Mean Absolute Error       : 0.0124
12-14 15:50 -   Root Mean Squared Error   : 0.1114
12-14 15:50 -   AUC-ROC                   : 0.9742
12-14 15:50 -   AUPRC                     : 0.6099
12-14 15:50 -   Specificity               : 0.9958
12-14 15:50 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-14 15:50 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-14 15:50 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-14 15:51 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-14 15:51 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-14 15:51 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 15:51 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 15:51 - Missing values heatmap saved to reports/evaluations/run_20241214_152455/Final_random_forest_(tuned)_missing_values_heatmap.png
12-14 15:51 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-14 15:51 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-14 15:51 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-14 15:51 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-14 15:51 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-14 15:51 - Saved temporal progression plots for 5 patients
12-14 15:51 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-14 15:51 - Saved error analysis plots to reports/evaluations/run_20241214_152455
12-14 15:51 - Saved feature interaction plots for top 5 pairs
12-14 15:51 - No sepsis patients have predictions for timeline plots.
12-14 15:51 - Saved evaluation metrics to reports/evaluations/run_20241214_152455/Final_random_forest_(tuned)_metrics.json

12-14 15:51 - Final evaluation completed for Random Forest (Tuned).
12-14 15:51 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 15:51 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 15:51 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 15:51 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 15:51 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 15:51 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 15:51 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 15:51 - Missing values heatmap saved to reports/evaluations/run_20241214_152455/Random Forest (Tuned)_missing_values_heatmap.png
12-14 15:51 - Saved plot: Random_Forest_(Tuned)_temporal_patient_13491.png
12-14 15:51 - Saved plot: Random_Forest_(Tuned)_temporal_patient_109380.png
12-14 15:51 - Saved plot: Random_Forest_(Tuned)_temporal_patient_15235.png
12-14 15:51 - Saved plot: Random_Forest_(Tuned)_temporal_patient_100016.png
12-14 15:51 - Saved plot: Random_Forest_(Tuned)_temporal_patient_9513.png
12-14 15:51 - Saved temporal progression plots for 5 patients
12-14 15:51 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 15:51 - Saved error analysis plots to reports/evaluations/run_20241214_152455
12-14 15:51 - Error plotting feature interactions: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1238, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 15:51 - Error generating evaluation plots: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 304, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1238, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 15:51 - An error occurred during final evaluation: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1421, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 446, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 304, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1238, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 15:51 - An error occurred: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1421, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 446, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 304, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1238, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 15:51 - Phase Failed: Main
12-14 15:51 - Error: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1421, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 446, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 304, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1238, in plot_feature_interactions
    sns.scatterplot(data=data, x=feat1, y=feat2, hue="SepsisLabel", alpha=0.5)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 615, in scatterplot
    p = _ScatterPlotter(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/relational.py", line 396, in __init__
    super().__init__(data=data, variables=variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 634, in __init__
    self.assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_base.py", line 679, in assign_variables
    plot_data = PlotData(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 58, in __init__
    frame, names, ids = self._assign_variables(data, variables)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/seaborn/_core/data.py", line 265, in _assign_variables
    frame = pd.DataFrame(plot_data)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 778, in __init__
    mgr = dict_to_mgr(data, index, columns, dtype=dtype, copy=copy, typ=manager)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 503, in dict_to_mgr
    return arrays_to_mgr(arrays, columns, index, dtype=dtype, typ=typ, consolidate=copy)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 119, in arrays_to_mgr
    arrays, refs = _homogenize(arrays, index, dtype)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/internals/construction.py", line 629, in _homogenize
    val = sanitize_array(val, index, dtype=dtype, copy=False)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 633, in sanitize_array
    return sanitize_array(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 659, in sanitize_array
    subarr = _sanitize_ndim(subarr, data, dtype, index, allow_2d=allow_2d)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/construction.py", line 718, in _sanitize_ndim
    raise ValueError(
ValueError: Data must be 1-dimensional, got ndarray of shape (138629, 2) instead
12-14 15:51 - ================================================================================
12-14 15:53 - ================================================================================
12-14 15:53 - Starting Phase: Main
12-14 15:53 - --------------------------------------------------------------------------------
12-14 15:53 - Initial Memory Usage: 214.33 MB
12-14 15:53 - Starting Sepsis Prediction Pipeline
12-14 15:53 - Initial Memory Usage: 214.33 MB
12-14 15:53 - Reports and metrics will be saved to: reports/evaluations/run_20241214_155339
12-14 15:53 - Loading and preprocessing data.
12-14 15:53 - Splitting data into training, validation, and testing sets
12-14 15:53 - Starting step: Preprocessing training data
12-14 16:00 - ================================================================================
12-14 16:00 - Starting Phase: Main
12-14 16:00 - --------------------------------------------------------------------------------
12-14 16:00 - Initial Memory Usage: 214.94 MB
12-14 16:00 - Starting Sepsis Prediction Pipeline
12-14 16:00 - Initial Memory Usage: 214.94 MB
12-14 16:00 - Reports and metrics will be saved to: reports/evaluations/run_20241214_160048
12-14 16:00 - Loading and preprocessing data.
12-14 16:00 - Splitting data into training, validation, and testing sets
12-14 16:01 - Starting step: Preprocessing training data
12-14 16:12 - Completed step: Preprocessing training data (Duration: 697.77s)
12-14 16:12 - Starting step: Preprocessing validation data
12-14 16:12 - Completed step: Preprocessing validation data (Duration: 7.02s)
12-14 16:12 - Starting step: Preprocessing testing data
12-14 16:12 - Completed step: Preprocessing testing data (Duration: 7.17s)
12-14 16:12 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_160048.pkl
12-14 16:12 - Applying SMOTEENN to training data.
12-14 16:16 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 16:16 - Saved resampled data to checkpoints/resampled_data_20241214_160048.pkl
12-14 16:16 - Initializing new Optuna studies.
12-14 16:16 - Saved Optuna studies to checkpoints/optuna_studies_20241214_160048.pkl
12-14 16:16 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 16:16 - Optimizing Random Forest hyperparameters with Optuna.
12-14 16:29 - Best Random Forest parameters: {'n_estimators': 205, 'max_depth': 29, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_features': 'sqrt'}
12-14 16:29 - Random Forest - Total trials: 19
12-14 16:29 - Random Forest - Completed trials: 19
12-14 16:29 - Random Forest - Pruned trials: 0
12-14 16:29 - Random Forest - Failed trials: 0
12-14 16:29 - Training Random Forest (Tuned)...
12-14 16:31 - Training completed for Random Forest (Tuned).
12-14 16:31 - Predictions made for Random Forest (Tuned).
12-14 16:31 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 16:31 - 
Random Forest (Tuned) Evaluation:
12-14 16:31 -   Accuracy                  : 0.9747
12-14 16:31 -   Precision                 : 0.3209
12-14 16:31 -   Recall                    : 0.4916
12-14 16:31 -   F1 Score                  : 0.3883
12-14 16:31 -   Mean Absolute Error       : 0.0253
12-14 16:31 -   Root Mean Squared Error   : 0.1591
12-14 16:31 -   AUC-ROC                   : 0.9512
12-14 16:31 -   AUPRC                     : 0.3673
12-14 16:31 -   Specificity               : 0.9827
12-14 16:31 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 16:31 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 16:31 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 16:31 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 16:31 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 16:31 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 16:31 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 16:31 - Missing values heatmap saved to reports/evaluations/run_20241214_160048/Random Forest (Tuned)_missing_values_heatmap.png
12-14 16:31 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 16:31 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 16:31 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 16:31 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 16:31 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 16:31 - Saved temporal progression plots for 5 patients
12-14 16:31 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 16:31 - Saved error analysis plots to reports/evaluations/run_20241214_160048
12-14 16:31 - Saved plot: Random Forest (Tuned)_interaction_Unit1_Unit2.png
12-14 16:31 - Saved plot: Random Forest (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 16:31 - Saved plot: Random Forest (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 16:31 - Saved plot: Random Forest (Tuned)_interaction_Hour_ICULOS.png
12-14 16:31 - Saved plot: Random Forest (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 16:31 - Saved feature interaction plots for top 5 pairs
12-14 16:31 - No sepsis patients have predictions for timeline plots.
12-14 16:31 - Saved evaluation metrics to reports/evaluations/run_20241214_160048/Random Forest (Tuned)_metrics.json

12-14 16:31 - Evaluation completed for Random Forest (Tuned).
12-14 16:31 - New best model: Random Forest (Tuned) with F1 Score: 0.3883
12-14 16:31 - Saved hyperparameters to reports/evaluations/run_20241214_160048/random_forest_tuned_params.json
12-14 16:31 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 16:32 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 16:32 - Logistic Regression - Total trials: 19
12-14 16:32 - Logistic Regression - Completed trials: 19
12-14 16:32 - Logistic Regression - Pruned trials: 0
12-14 16:32 - Logistic Regression - Failed trials: 0
12-14 16:32 - Training Logistic Regression (Tuned)...
12-14 16:32 - Training completed for Logistic Regression (Tuned).
12-14 16:32 - Predictions made for Logistic Regression (Tuned).
12-14 16:32 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 16:32 - 
Logistic Regression (Tuned) Evaluation:
12-14 16:32 -   Accuracy                  : 0.9461
12-14 16:32 -   Precision                 : 0.1900
12-14 16:32 -   Recall                    : 0.7050
12-14 16:32 -   F1 Score                  : 0.2994
12-14 16:32 -   Mean Absolute Error       : 0.0539
12-14 16:32 -   Root Mean Squared Error   : 0.2323
12-14 16:32 -   AUC-ROC                   : 0.8963
12-14 16:32 -   AUPRC                     : 0.1447
12-14 16:32 -   Specificity               : 0.9501
12-14 16:32 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 16:32 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 16:32 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 16:32 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 16:32 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 16:32 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 16:32 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 16:32 - Missing values heatmap saved to reports/evaluations/run_20241214_160048/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 16:32 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 16:32 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 16:32 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 16:32 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 16:32 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 16:32 - Saved temporal progression plots for 5 patients
12-14 16:32 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 16:32 - Saved error analysis plots to reports/evaluations/run_20241214_160048
12-14 16:32 - Saved plot: Logistic Regression (Tuned)_interaction_Unit1_Unit2.png
12-14 16:32 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 16:32 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 16:32 - Saved plot: Logistic Regression (Tuned)_interaction_Hour_ICULOS.png
12-14 16:32 - Saved plot: Logistic Regression (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 16:32 - Saved feature interaction plots for top 5 pairs
12-14 16:32 - No sepsis patients have predictions for timeline plots.
12-14 16:32 - Saved evaluation metrics to reports/evaluations/run_20241214_160048/Logistic Regression (Tuned)_metrics.json

12-14 16:32 - Evaluation completed for Logistic Regression (Tuned).
12-14 16:32 - Saved hyperparameters to reports/evaluations/run_20241214_160048/logistic_regression_tuned_params.json
12-14 16:32 - Optimizing XGBoost hyperparameters with Optuna.
12-14 16:33 - Best XGBoost parameters: {'n_estimators': 457, 'max_depth': 9, 'learning_rate': 0.17255776234553302, 'subsample': 0.7574329529424287, 'colsample_bytree': 0.5433439671072606, 'gamma': 0.012455929246615097, 'reg_alpha': 0.07875095024685662, 'reg_lambda': 0.5035646682042978}
12-14 16:33 - XGBoost - Total trials: 46
12-14 16:33 - XGBoost - Completed trials: 46
12-14 16:33 - XGBoost - Pruned trials: 0
12-14 16:33 - XGBoost - Failed trials: 0
12-14 16:33 - Training XGBoost (Tuned)...
12-14 16:33 - Training completed for XGBoost (Tuned).
12-14 16:33 - Predictions made for XGBoost (Tuned).
12-14 16:33 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 16:33 - 
XGBoost (Tuned) Evaluation:
12-14 16:33 -   Accuracy                  : 0.9627
12-14 16:33 -   Precision                 : 0.2632
12-14 16:33 -   Recall                    : 0.7115
12-14 16:33 -   F1 Score                  : 0.3843
12-14 16:33 -   Mean Absolute Error       : 0.0373
12-14 16:33 -   Root Mean Squared Error   : 0.1931
12-14 16:33 -   AUC-ROC                   : 0.9452
12-14 16:33 -   AUPRC                     : 0.4544
12-14 16:33 -   Specificity               : 0.9669
12-14 16:33 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 16:33 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 16:33 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 16:33 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 16:33 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 16:33 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 16:33 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 16:33 - Missing values heatmap saved to reports/evaluations/run_20241214_160048/XGBoost (Tuned)_missing_values_heatmap.png
12-14 16:33 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 16:33 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 16:33 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 16:33 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 16:33 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 16:33 - Saved temporal progression plots for 5 patients
12-14 16:33 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 16:33 - Saved error analysis plots to reports/evaluations/run_20241214_160048
12-14 16:33 - Saved plot: XGBoost (Tuned)_interaction_Unit1_Unit2.png
12-14 16:33 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 16:33 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 16:34 - Saved plot: XGBoost (Tuned)_interaction_Hour_ICULOS.png
12-14 16:34 - Saved plot: XGBoost (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 16:34 - Saved feature interaction plots for top 5 pairs
12-14 16:34 - No sepsis patients have predictions for timeline plots.
12-14 16:34 - Saved evaluation metrics to reports/evaluations/run_20241214_160048/XGBoost (Tuned)_metrics.json

12-14 16:34 - Evaluation completed for XGBoost (Tuned).
12-14 16:34 - Saved hyperparameters to reports/evaluations/run_20241214_160048/xgboost_tuned_params.json
12-14 16:34 - Saved trained models to checkpoints/trained_models_20241214_160048.pkl
12-14 16:34 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_160048.pkl
12-14 16:34 - Saved trial data to reports/evaluations/run_20241214_160048/random_forest_optimization_optimization_trials.csv
12-14 16:34 - Saved trial data to reports/evaluations/run_20241214_160048/logistic_regression_optimization_optimization_trials.csv
12-14 16:34 - Saved trial data to reports/evaluations/run_20241214_160048/xgboost_optimization_optimization_trials.csv
12-14 16:34 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 16:34 - Predictions made with Random Forest (Tuned) on test set.
12-14 16:34 - 
Final_random_forest_(tuned) Evaluation:
12-14 16:34 -   Accuracy                  : 0.9876
12-14 16:34 -   Precision                 : 0.6553
12-14 16:34 -   Recall                    : 0.4879
12-14 16:34 -   F1 Score                  : 0.5593
12-14 16:34 -   Mean Absolute Error       : 0.0124
12-14 16:34 -   Root Mean Squared Error   : 0.1114
12-14 16:34 -   AUC-ROC                   : 0.9742
12-14 16:34 -   AUPRC                     : 0.6099
12-14 16:34 -   Specificity               : 0.9958
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-14 16:34 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 16:34 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 16:34 - Missing values heatmap saved to reports/evaluations/run_20241214_160048/Final_random_forest_(tuned)_missing_values_heatmap.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-14 16:34 - Saved temporal progression plots for 5 patients
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-14 16:34 - Saved error analysis plots to reports/evaluations/run_20241214_160048
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed: 0_Hour.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_interaction_Unit1_Unit2.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_interaction_Hour_ICULOS.png
12-14 16:34 - Saved plot: Final_random_forest_(tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 16:34 - Saved feature interaction plots for top 5 pairs
12-14 16:34 - No sepsis patients have predictions for timeline plots.
12-14 16:34 - Saved evaluation metrics to reports/evaluations/run_20241214_160048/Final_random_forest_(tuned)_metrics.json

12-14 16:34 - Final evaluation completed for Random Forest (Tuned).
12-14 16:34 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 16:34 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 16:34 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 16:34 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 16:34 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 16:34 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 16:34 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 16:34 - Missing values heatmap saved to reports/evaluations/run_20241214_160048/Random Forest (Tuned)_missing_values_heatmap.png
12-14 16:34 - Saved plot: Random_Forest_(Tuned)_temporal_patient_13491.png
12-14 16:34 - Saved plot: Random_Forest_(Tuned)_temporal_patient_109380.png
12-14 16:34 - Saved plot: Random_Forest_(Tuned)_temporal_patient_15235.png
12-14 16:34 - Saved plot: Random_Forest_(Tuned)_temporal_patient_100016.png
12-14 16:34 - Saved plot: Random_Forest_(Tuned)_temporal_patient_9513.png
12-14 16:34 - Saved temporal progression plots for 5 patients
12-14 16:34 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 16:34 - Saved error analysis plots to reports/evaluations/run_20241214_160048
12-14 16:34 - Error plotting feature interactions: 'DataFrame' object has no attribute 'dtype'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1088, in plot_feature_interactions
    logger.debug(f"Column '{col}' dtype: {subset[col].dtype}")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'dtype'. Did you mean: 'dtypes'?
12-14 16:34 - Error generating evaluation plots: 'DataFrame' object has no attribute 'dtype'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 304, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1088, in plot_feature_interactions
    logger.debug(f"Column '{col}' dtype: {subset[col].dtype}")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'dtype'. Did you mean: 'dtypes'?
12-14 16:34 - An error occurred during final evaluation: 'DataFrame' object has no attribute 'dtype'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1421, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 446, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 304, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1088, in plot_feature_interactions
    logger.debug(f"Column '{col}' dtype: {subset[col].dtype}")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'dtype'. Did you mean: 'dtypes'?
12-14 16:34 - An error occurred: 'DataFrame' object has no attribute 'dtype'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1421, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 446, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 304, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1088, in plot_feature_interactions
    logger.debug(f"Column '{col}' dtype: {subset[col].dtype}")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'dtype'. Did you mean: 'dtypes'?
12-14 16:34 - Phase Failed: Main
12-14 16:34 - Error: 'DataFrame' object has no attribute 'dtype'
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/logger_utils.py", line 42, in wrapper
    result = func(*args, **kwargs)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1421, in main
    generate_model_card(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 446, in generate_model_card
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 304, in generate_evaluation_plots
    plot_feature_interactions(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 1088, in plot_feature_interactions
    logger.debug(f"Column '{col}' dtype: {subset[col].dtype}")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/generic.py", line 6299, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'dtype'. Did you mean: 'dtypes'?
12-14 16:34 - ================================================================================
12-14 16:58 - ================================================================================
12-14 16:58 - Starting Phase: Main
12-14 16:58 - --------------------------------------------------------------------------------
12-14 16:58 - Initial Memory Usage: 215.47 MB
12-14 16:58 - Starting Sepsis Prediction Pipeline
12-14 16:58 - Initial Memory Usage: 215.47 MB
12-14 16:58 - Reports and metrics will be saved to: reports/evaluations/run_20241214_165849
12-14 16:58 - Loading and preprocessing data.
12-14 16:58 - Splitting data into training, validation, and testing sets
12-14 16:59 - Starting step: Preprocessing training data
12-14 17:01 - ================================================================================
12-14 17:01 - Starting Phase: Main
12-14 17:01 - --------------------------------------------------------------------------------
12-14 17:01 - Initial Memory Usage: 216.28 MB
12-14 17:01 - Starting Sepsis Prediction Pipeline
12-14 17:01 - Initial Memory Usage: 216.28 MB
12-14 17:01 - Reports and metrics will be saved to: reports/evaluations/run_20241214_170127
12-14 17:01 - Loading and preprocessing data.
12-14 17:01 - Splitting data into training, validation, and testing sets
12-14 17:01 - Starting step: Preprocessing training data
12-14 17:13 - Completed step: Preprocessing training data (Duration: 718.45s)
12-14 17:13 - Starting step: Preprocessing validation data
12-14 17:13 - Completed step: Preprocessing validation data (Duration: 7.61s)
12-14 17:13 - Starting step: Preprocessing testing data
12-14 17:13 - Completed step: Preprocessing testing data (Duration: 7.77s)
12-14 17:13 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_170127.pkl
12-14 17:13 - Applying SMOTEENN to training data.
12-14 17:17 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 17:17 - Saved resampled data to checkpoints/resampled_data_20241214_170127.pkl
12-14 17:17 - Initializing new Optuna studies.
12-14 17:17 - Saved Optuna studies to checkpoints/optuna_studies_20241214_170127.pkl
12-14 17:17 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 17:17 - Optimizing Random Forest hyperparameters with Optuna.
12-14 17:18 - Best Random Forest parameters: {'n_estimators': 205, 'max_depth': 29, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_features': 'sqrt'}
12-14 17:18 - Random Forest - Total trials: 20
12-14 17:18 - Random Forest - Completed trials: 20
12-14 17:18 - Random Forest - Pruned trials: 0
12-14 17:18 - Random Forest - Failed trials: 0
12-14 17:18 - Training Random Forest (Tuned)...
12-14 17:20 - Training completed for Random Forest (Tuned).
12-14 17:20 - Predictions made for Random Forest (Tuned).
12-14 17:20 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 17:20 - 
Random Forest (Tuned) Evaluation:
12-14 17:20 -   Accuracy                  : 0.9741
12-14 17:20 -   Precision                 : 0.3180
12-14 17:20 -   Recall                    : 0.5084
12-14 17:20 -   F1 Score                  : 0.3913
12-14 17:20 -   Mean Absolute Error       : 0.0259
12-14 17:20 -   Root Mean Squared Error   : 0.1608
12-14 17:20 -   AUC-ROC                   : 0.9501
12-14 17:20 -   AUPRC                     : 0.3685
12-14 17:20 -   Specificity               : 0.9819
12-14 17:20 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 17:20 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 17:20 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 17:20 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 17:20 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 17:20 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 17:20 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 17:20 - Missing values heatmap saved to reports/evaluations/run_20241214_170127/Random Forest (Tuned)_missing_values_heatmap.png
12-14 17:20 - Error plotting temporal progression: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:20 - Error generating evaluation plots: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:20 - Error in model evaluation: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:20 - Error evaluating Random Forest (Tuned): 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 231, in train_and_evaluate_model
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:20 - Error training or evaluating Random Forest (Tuned): 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 231, in train_and_evaluate_model
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:20 - Error during Random Forest optimization or training: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1066, in main
    metrics_rf, best_rf_model = train_and_evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 231, in train_and_evaluate_model
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:20 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 17:24 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 17:24 - Logistic Regression - Total trials: 20
12-14 17:24 - Logistic Regression - Completed trials: 20
12-14 17:24 - Logistic Regression - Pruned trials: 0
12-14 17:24 - Logistic Regression - Failed trials: 0
12-14 17:24 - Training Logistic Regression (Tuned)...
12-14 17:25 - Training completed for Logistic Regression (Tuned).
12-14 17:25 - Predictions made for Logistic Regression (Tuned).
12-14 17:25 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 17:25 - 
Logistic Regression (Tuned) Evaluation:
12-14 17:25 -   Accuracy                  : 0.9461
12-14 17:25 -   Precision                 : 0.1901
12-14 17:25 -   Recall                    : 0.7055
12-14 17:25 -   F1 Score                  : 0.2995
12-14 17:25 -   Mean Absolute Error       : 0.0539
12-14 17:25 -   Root Mean Squared Error   : 0.2323
12-14 17:25 -   AUC-ROC                   : 0.8963
12-14 17:25 -   AUPRC                     : 0.1446
12-14 17:25 -   Specificity               : 0.9501
12-14 17:25 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 17:25 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 17:25 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 17:25 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 17:25 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 17:25 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 17:25 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 17:25 - Missing values heatmap saved to reports/evaluations/run_20241214_170127/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 17:25 - Error plotting temporal progression: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Error generating evaluation plots: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Error in model evaluation: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Error evaluating Logistic Regression (Tuned): 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 231, in train_and_evaluate_model
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Error training or evaluating Logistic Regression (Tuned): 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 231, in train_and_evaluate_model
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Error during Logistic Regression optimization or training: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1188, in main
    metrics_lr, best_lr_model = train_and_evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 231, in train_and_evaluate_model
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    sepsis_patients = patient_ids[data["SepsisLabel"] == 1].unique()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Optimizing XGBoost hyperparameters with Optuna.
12-14 17:25 - Best XGBoost parameters: {'n_estimators': 457, 'max_depth': 9, 'learning_rate': 0.17255776234553302, 'subsample': 0.7574329529424287, 'colsample_bytree': 0.5433439671072606, 'gamma': 0.012455929246615097, 'reg_alpha': 0.07875095024685662, 'reg_lambda': 0.5035646682042978}
12-14 17:25 - XGBoost - Total trials: 47
12-14 17:25 - XGBoost - Completed trials: 47
12-14 17:25 - XGBoost - Pruned trials: 0
12-14 17:25 - XGBoost - Failed trials: 0
12-14 17:25 - Training XGBoost (Tuned)...
12-14 17:25 - Training completed for XGBoost (Tuned).
12-14 17:25 - Predictions made for XGBoost (Tuned).
12-14 17:25 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 17:25 - 
XGBoost (Tuned) Evaluation:
12-14 17:25 -   Accuracy                  : 0.9586
12-14 17:25 -   Precision                 : 0.2399
12-14 17:25 -   Recall                    : 0.7081
12-14 17:25 -   F1 Score                  : 0.3584
12-14 17:25 -   Mean Absolute Error       : 0.0414
12-14 17:25 -   Root Mean Squared Error   : 0.2036
12-14 17:25 -   AUC-ROC                   : 0.9424
12-14 17:25 -   AUPRC                     : 0.4375
12-14 17:25 -   Specificity               : 0.9627
12-14 17:25 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 17:25 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 17:25 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 17:25 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 17:25 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 17:25 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 17:25 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 17:25 - Missing values heatmap saved to reports/evaluations/run_20241214_170127/XGBoost (Tuned)_missing_values_heatmap.png
12-14 17:25 - Error plotting temporal progression: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    raise KeyError("'SepsisLabel' column is missing from the data.")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Error generating evaluation plots: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    raise KeyError("'SepsisLabel' column is missing from the data.")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Error in model evaluation: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    raise KeyError("'SepsisLabel' column is missing from the data.")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Error evaluating XGBoost (Tuned): 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 231, in train_and_evaluate_model
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    raise KeyError("'SepsisLabel' column is missing from the data.")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Error training or evaluating XGBoost (Tuned): 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 231, in train_and_evaluate_model
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    raise KeyError("'SepsisLabel' column is missing from the data.")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Error during XGBoost optimization or training: 'SepsisLabel'
Traceback (most recent call last):
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'SepsisLabel'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 1296, in main
    metrics_xgb, best_xgb_model = train_and_evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 231, in train_and_evaluate_model
    metrics = evaluate_model(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 118, in evaluate_model
    generate_evaluation_plots(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 271, in generate_evaluation_plots
    plot_temporal_progression(
  File "/Users/jeremy/Desktop/predicting-sepsis-main/src/evaluation.py", line 677, in plot_temporal_progression
    raise KeyError("'SepsisLabel' column is missing from the data.")
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'SepsisLabel'
12-14 17:25 - Saved trained models to checkpoints/trained_models_20241214_170127.pkl
12-14 17:25 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_170127.pkl
12-14 17:25 - Saved trial data to reports/evaluations/run_20241214_170127/random_forest_optimization_optimization_trials.csv
12-14 17:25 - Saved trial data to reports/evaluations/run_20241214_170127/logistic_regression_optimization_optimization_trials.csv
12-14 17:25 - Saved trial data to reports/evaluations/run_20241214_170127/xgboost_optimization_optimization_trials.csv
12-14 17:25 - No models were trained. Pipeline did not complete successfully.
12-14 17:25 - --------------------------------------------------------------------------------
12-14 17:25 - Phase Complete: Main
12-14 17:25 - Duration: 1448.91 seconds
12-14 17:25 - Final Memory Usage: 592.44 MB
12-14 17:25 - Memory Change: +376.16 MB
12-14 17:25 - ================================================================================
12-14 17:27 - ================================================================================
12-14 17:27 - Starting Phase: Main
12-14 17:27 - --------------------------------------------------------------------------------
12-14 17:27 - Initial Memory Usage: 214.53 MB
12-14 17:27 - Starting Sepsis Prediction Pipeline
12-14 17:27 - Initial Memory Usage: 214.53 MB
12-14 17:27 - Reports and metrics will be saved to: reports/evaluations/run_20241214_172700
12-14 17:27 - Loading and preprocessing data.
12-14 17:27 - Splitting data into training, validation, and testing sets
12-14 17:27 - Starting step: Preprocessing training data
12-14 17:39 - Completed step: Preprocessing training data (Duration: 718.97s)
12-14 17:39 - Starting step: Preprocessing validation data
12-14 17:39 - Completed step: Preprocessing validation data (Duration: 7.82s)
12-14 17:39 - Starting step: Preprocessing testing data
12-14 17:39 - Completed step: Preprocessing testing data (Duration: 8.08s)
12-14 17:39 - Saved preprocessed data to checkpoints/preprocessed_data_20241214_172700.pkl
12-14 17:39 - Applying SMOTEENN to training data.
12-14 17:42 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-14 17:42 - Saved resampled data to checkpoints/resampled_data_20241214_172700.pkl
12-14 17:42 - Initializing new Optuna studies.
12-14 17:42 - Saved Optuna studies to checkpoints/optuna_studies_20241214_172700.pkl
12-14 17:42 - Starting Optuna hyperparameter tuning with 1 parallel jobs.
12-14 17:42 - Optimizing Random Forest hyperparameters with Optuna.
12-14 17:46 - Best Random Forest parameters: {'n_estimators': 205, 'max_depth': 29, 'min_samples_split': 8, 'min_samples_leaf': 1, 'max_features': 'sqrt'}
12-14 17:46 - Random Forest - Total trials: 21
12-14 17:46 - Random Forest - Completed trials: 21
12-14 17:46 - Random Forest - Pruned trials: 0
12-14 17:46 - Random Forest - Failed trials: 0
12-14 17:46 - Training Random Forest (Tuned)...
12-14 17:48 - Training completed for Random Forest (Tuned).
12-14 17:48 - Predictions made for Random Forest (Tuned).
12-14 17:48 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-14 17:48 - 
Random Forest (Tuned) Evaluation:
12-14 17:48 -   Accuracy                  : 0.9741
12-14 17:48 -   Precision                 : 0.3180
12-14 17:48 -   Recall                    : 0.5084
12-14 17:48 -   F1 Score                  : 0.3913
12-14 17:48 -   Mean Absolute Error       : 0.0259
12-14 17:48 -   Root Mean Squared Error   : 0.1608
12-14 17:48 -   AUC-ROC                   : 0.9501
12-14 17:48 -   AUPRC                     : 0.3685
12-14 17:48 -   Specificity               : 0.9819
12-14 17:48 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 17:48 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 17:48 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 17:48 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 17:48 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 17:48 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-14 17:48 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 17:48 - Missing values heatmap saved to reports/evaluations/run_20241214_172700/Random Forest (Tuned)_missing_values_heatmap.png
12-14 17:48 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-14 17:48 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-14 17:48 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-14 17:48 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-14 17:48 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-14 17:48 - Saved temporal progression plots for 5 patients
12-14 17:48 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 17:48 - Saved error analysis plots to reports/evaluations/run_20241214_172700
12-14 17:48 - Saved plot: Random Forest (Tuned)_interaction_Unit1_Unit2.png
12-14 17:48 - Saved plot: Random Forest (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 17:48 - Saved plot: Random Forest (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 17:48 - Saved plot: Random Forest (Tuned)_interaction_Hour_ICULOS.png
12-14 17:48 - Saved plot: Random Forest (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 17:48 - Saved feature interaction plots for top 5 pairs
12-14 17:48 - No sepsis patients have predictions for timeline plots.
12-14 17:48 - Saved evaluation metrics to reports/evaluations/run_20241214_172700/Random Forest (Tuned)_metrics.json

12-14 17:48 - Evaluation completed for Random Forest (Tuned).
12-14 17:48 - New best model: Random Forest (Tuned) with F1 Score: 0.3913
12-14 17:48 - Saved hyperparameters to reports/evaluations/run_20241214_172700/random_forest_tuned_params.json
12-14 17:48 - Optimizing Logistic Regression hyperparameters with Optuna.
12-14 17:49 - Best Logistic Regression parameters: {'penalty': 'l2', 'C': 0.18907023825792352, 'max_iter': 674, 'tol': 2.2393831699310015e-05}
12-14 17:49 - Logistic Regression - Total trials: 21
12-14 17:49 - Logistic Regression - Completed trials: 21
12-14 17:49 - Logistic Regression - Pruned trials: 0
12-14 17:49 - Logistic Regression - Failed trials: 0
12-14 17:49 - Training Logistic Regression (Tuned)...
12-14 17:49 - Training completed for Logistic Regression (Tuned).
12-14 17:49 - Predictions made for Logistic Regression (Tuned).
12-14 17:49 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-14 17:49 - 
Logistic Regression (Tuned) Evaluation:
12-14 17:49 -   Accuracy                  : 0.9461
12-14 17:49 -   Precision                 : 0.1901
12-14 17:49 -   Recall                    : 0.7055
12-14 17:49 -   F1 Score                  : 0.2995
12-14 17:49 -   Mean Absolute Error       : 0.0539
12-14 17:49 -   Root Mean Squared Error   : 0.2323
12-14 17:49 -   AUC-ROC                   : 0.8963
12-14 17:49 -   AUPRC                     : 0.1446
12-14 17:49 -   Specificity               : 0.9501
12-14 17:49 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-14 17:49 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-14 17:49 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-14 17:49 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-14 17:49 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-14 17:49 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-14 17:49 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 17:49 - Missing values heatmap saved to reports/evaluations/run_20241214_172700/Logistic Regression (Tuned)_missing_values_heatmap.png
12-14 17:49 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-14 17:49 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-14 17:49 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-14 17:49 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-14 17:49 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-14 17:49 - Saved temporal progression plots for 5 patients
12-14 17:49 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-14 17:49 - Saved error analysis plots to reports/evaluations/run_20241214_172700
12-14 17:49 - Saved plot: Logistic Regression (Tuned)_interaction_Unit1_Unit2.png
12-14 17:49 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 17:49 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 17:49 - Saved plot: Logistic Regression (Tuned)_interaction_Hour_ICULOS.png
12-14 17:49 - Saved plot: Logistic Regression (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 17:49 - Saved feature interaction plots for top 5 pairs
12-14 17:49 - No sepsis patients have predictions for timeline plots.
12-14 17:49 - Saved evaluation metrics to reports/evaluations/run_20241214_172700/Logistic Regression (Tuned)_metrics.json

12-14 17:49 - Evaluation completed for Logistic Regression (Tuned).
12-14 17:49 - Saved hyperparameters to reports/evaluations/run_20241214_172700/logistic_regression_tuned_params.json
12-14 17:49 - Optimizing XGBoost hyperparameters with Optuna.
12-14 17:50 - Best XGBoost parameters: {'n_estimators': 457, 'max_depth': 9, 'learning_rate': 0.17255776234553302, 'subsample': 0.7574329529424287, 'colsample_bytree': 0.5433439671072606, 'gamma': 0.012455929246615097, 'reg_alpha': 0.07875095024685662, 'reg_lambda': 0.5035646682042978}
12-14 17:50 - XGBoost - Total trials: 48
12-14 17:50 - XGBoost - Completed trials: 48
12-14 17:50 - XGBoost - Pruned trials: 0
12-14 17:50 - XGBoost - Failed trials: 0
12-14 17:50 - Training XGBoost (Tuned)...
12-14 17:50 - Training completed for XGBoost (Tuned).
12-14 17:50 - Predictions made for XGBoost (Tuned).
12-14 17:50 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-14 17:50 - 
XGBoost (Tuned) Evaluation:
12-14 17:50 -   Accuracy                  : 0.9586
12-14 17:50 -   Precision                 : 0.2399
12-14 17:50 -   Recall                    : 0.7081
12-14 17:50 -   F1 Score                  : 0.3584
12-14 17:50 -   Mean Absolute Error       : 0.0414
12-14 17:50 -   Root Mean Squared Error   : 0.2036
12-14 17:50 -   AUC-ROC                   : 0.9424
12-14 17:50 -   AUPRC                     : 0.4375
12-14 17:50 -   Specificity               : 0.9627
12-14 17:50 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-14 17:50 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-14 17:50 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-14 17:50 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-14 17:50 - Saved plot: XGBoost_(Tuned)_calibration.png
12-14 17:50 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-14 17:50 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 17:50 - Missing values heatmap saved to reports/evaluations/run_20241214_172700/XGBoost (Tuned)_missing_values_heatmap.png
12-14 17:50 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-14 17:50 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-14 17:50 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-14 17:50 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-14 17:50 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-14 17:50 - Saved temporal progression plots for 5 patients
12-14 17:50 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-14 17:50 - Saved error analysis plots to reports/evaluations/run_20241214_172700
12-14 17:50 - Saved plot: XGBoost (Tuned)_interaction_Unit1_Unit2.png
12-14 17:50 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_Hour.png
12-14 17:51 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 17:51 - Saved plot: XGBoost (Tuned)_interaction_Hour_ICULOS.png
12-14 17:51 - Saved plot: XGBoost (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 17:51 - Saved feature interaction plots for top 5 pairs
12-14 17:51 - No sepsis patients have predictions for timeline plots.
12-14 17:51 - Saved evaluation metrics to reports/evaluations/run_20241214_172700/XGBoost (Tuned)_metrics.json

12-14 17:51 - Evaluation completed for XGBoost (Tuned).
12-14 17:51 - Saved hyperparameters to reports/evaluations/run_20241214_172700/xgboost_tuned_params.json
12-14 17:51 - Saved trained models to checkpoints/trained_models_20241214_172700.pkl
12-14 17:51 - Saved updated Optuna studies to checkpoints/optuna_studies_20241214_172700.pkl
12-14 17:51 - Saved trial data to reports/evaluations/run_20241214_172700/random_forest_optimization_optimization_trials.csv
12-14 17:51 - Saved trial data to reports/evaluations/run_20241214_172700/logistic_regression_optimization_optimization_trials.csv
12-14 17:51 - Saved trial data to reports/evaluations/run_20241214_172700/xgboost_optimization_optimization_trials.csv
12-14 17:51 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-14 17:51 - Predictions made with Random Forest (Tuned) on test set.
12-14 17:51 - 
Final_random_forest_(tuned) Evaluation:
12-14 17:51 -   Accuracy                  : 0.9872
12-14 17:51 -   Precision                 : 0.6289
12-14 17:51 -   Recall                    : 0.4964
12-14 17:51 -   F1 Score                  : 0.5549
12-14 17:51 -   Mean Absolute Error       : 0.0128
12-14 17:51 -   Root Mean Squared Error   : 0.1133
12-14 17:51 -   AUC-ROC                   : 0.9742
12-14 17:51 -   AUPRC                     : 0.6006
12-14 17:51 -   Specificity               : 0.9952
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-14 17:51 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 17:51 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-14 17:51 - Missing values heatmap saved to reports/evaluations/run_20241214_172700/Final_random_forest_(tuned)_missing_values_heatmap.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-14 17:51 - Saved temporal progression plots for 5 patients
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-14 17:51 - Saved error analysis plots to reports/evaluations/run_20241214_172700
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed: 0_Hour.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_interaction_Unit1_Unit2.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed: 0_ICULOS.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_interaction_Hour_ICULOS.png
12-14 17:51 - Saved plot: Final_random_forest_(tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-14 17:51 - Saved feature interaction plots for top 5 pairs
12-14 17:51 - No sepsis patients have predictions for timeline plots.
12-14 17:51 - Saved evaluation metrics to reports/evaluations/run_20241214_172700/Final_random_forest_(tuned)_metrics.json

12-14 17:51 - Final evaluation completed for Random Forest (Tuned).
12-14 17:51 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-14 17:51 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-14 17:51 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-14 17:51 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-14 17:51 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-14 17:51 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-14 17:51 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-14 17:51 - Missing values heatmap saved to reports/evaluations/run_20241214_172700/Random Forest (Tuned)_missing_values_heatmap.png
12-14 17:51 - Saved plot: Random_Forest_(Tuned)_temporal_patient_13491.png
12-14 17:51 - Saved plot: Random_Forest_(Tuned)_temporal_patient_109380.png
12-14 17:51 - Saved plot: Random_Forest_(Tuned)_temporal_patient_15235.png
12-14 17:51 - Saved plot: Random_Forest_(Tuned)_temporal_patient_100016.png
12-14 17:51 - Saved plot: Random_Forest_(Tuned)_temporal_patient_9513.png
12-14 17:51 - Saved temporal progression plots for 5 patients
12-14 17:51 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-14 17:51 - Saved error analysis plots to reports/evaluations/run_20241214_172700
12-14 17:52 - Saved plot: Random Forest (Tuned)_interaction_Unit1_Unit2.png
12-14 17:52 - Saved plot: Random Forest (Tuned)_interaction_Hour_ICULOS.png
12-14 17:52 - Saved plot: Random Forest (Tuned)_interaction_Hct_Hgb.png
12-14 17:52 - Saved plot: Random Forest (Tuned)_interaction_BUN_Creatinine.png
12-14 17:52 - Saved plot: Random Forest (Tuned)_interaction_BUN_Age.png
12-14 17:52 - Saved feature interaction plots for top 5 pairs
12-14 17:52 - No sepsis patients have predictions for timeline plots.
12-14 17:52 - Model card saved to reports/evaluations/run_20241214_172700/Random Forest (Tuned)_model_card.md
12-14 17:52 - Saving the best model (Random Forest (Tuned))
12-14 17:52 - Saved model 'Random Forest (Tuned)' version 'v2' to 'models/Random Forest (Tuned)_20241214_175227_06d15d'
12-14 17:52 - Model (Random Forest (Tuned)) saved successfully.
12-14 17:52 - Sepsis Prediction Pipeline completed successfully.
12-14 17:52 - --------------------------------------------------------------------------------
12-14 17:52 - Phase Complete: Main
12-14 17:52 - Duration: 1527.76 seconds
12-14 17:52 - Final Memory Usage: 1609.86 MB
12-14 17:52 - Memory Change: +1395.33 MB
12-14 17:52 - ================================================================================
12-14 23:50 - ================================================================================
12-14 23:50 - Starting Phase: Main
12-14 23:50 - --------------------------------------------------------------------------------
12-14 23:50 - Initial Memory Usage: 211.64 MB
12-14 23:50 - Starting Sepsis Prediction Pipeline
12-14 23:50 - Initial Memory Usage: 211.64 MB
12-14 23:50 - Reports and metrics will be saved to: reports/evaluations/run_20241214_235059
12-14 23:50 - Loading and preprocessing data.
12-14 23:51 - Splitting data into training, validation, and testing sets
12-14 23:51 - Starting step: Preprocessing training data
12-15 00:12 - ================================================================================
12-15 00:12 - Starting Phase: Main
12-15 00:12 - --------------------------------------------------------------------------------
12-15 00:12 - Initial Memory Usage: 211.06 MB
12-15 00:12 - Starting Sepsis Prediction Pipeline
12-15 00:12 - Initial Memory Usage: 211.08 MB
12-15 00:12 - Reports and metrics will be saved to: reports/evaluations/run_20241215_001222
12-15 00:12 - Loading and preprocessing data.
12-15 00:12 - Splitting data into training, validation, and testing sets
12-15 00:12 - Starting step: Preprocessing training data
12-15 00:39 - Completed step: Preprocessing training data (Duration: 1596.74s)
12-15 00:39 - Starting step: Preprocessing validation data
12-15 00:39 - Completed step: Preprocessing validation data (Duration: 15.03s)
12-15 00:39 - Starting step: Preprocessing testing data
12-15 00:39 - Completed step: Preprocessing testing data (Duration: 15.41s)
12-15 00:39 - Saved preprocessed data to checkpoints/preprocessed_data_20241215_001222.pkl
12-15 00:39 - Applying SMOTEENN to training data.
12-15 00:42 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-15 00:42 - Saved resampled data to checkpoints/resampled_data_20241215_001222.pkl
12-15 00:42 - Initializing new Optuna studies.
12-15 00:42 - Saved Optuna studies to checkpoints/optuna_studies_20241215_001222.pkl
12-15 00:42 - Starting Optuna hyperparameter tuning with 5 parallel jobs.
12-15 00:42 - Optimizing Random Forest hyperparameters with Optuna.
12-15 00:42 - Error during Random Forest optimization or training: CategoricalDistribution does not support dynamic value space.
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 925, in main
    studies["Random_Forest_Optimization"].optimize(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 100, in _optimize
    f.result()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 792, in rf_objective
    "max_features": trial.suggest_categorical(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/trial/_trial.py", line 402, in suggest_categorical
    return self._suggest(name, CategoricalDistribution(choices=choices))
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/trial/_trial.py", line 637, in _suggest
    storage.set_trial_param(trial_id, name, param_value_in_internal_repr, distribution)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_cached_storage.py", line 171, in set_trial_param
    self._backend.set_trial_param(trial_id, param_name, param_value_internal, distribution)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 585, in set_trial_param
    self._set_trial_param_without_commit(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/storage.py", line 607, in _set_trial_param_without_commit
    trial_param.check_and_add(session, trial.study_id)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/models.py", line 353, in check_and_add
    self._check_compatibility_with_previous_trial_param_distributions(session, study_id)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/storages/_rdb/models.py", line 367, in _check_compatibility_with_previous_trial_param_distributions
    distributions.check_distribution_compatibility(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/distributions.py", line 678, in check_distribution_compatibility
    raise ValueError(
ValueError: CategoricalDistribution does not support dynamic value space.
12-15 00:42 - Optimizing Logistic Regression hyperparameters with Optuna.
12-15 01:05 - ================================================================================
12-15 01:05 - Starting Phase: Main
12-15 01:05 - --------------------------------------------------------------------------------
12-15 01:05 - Initial Memory Usage: 212.28 MB
12-15 01:05 - Starting Sepsis Prediction Pipeline
12-15 01:05 - Initial Memory Usage: 212.30 MB
12-15 01:05 - Reports and metrics will be saved to: reports/evaluations/run_20241215_010515
12-15 01:05 - Loading and preprocessing data.
12-15 01:05 - Splitting data into training, validation, and testing sets
12-15 01:05 - Starting step: Preprocessing training data
12-15 01:31 - Completed step: Preprocessing training data (Duration: 1554.56s)
12-15 01:31 - Starting step: Preprocessing validation data
12-15 01:31 - Completed step: Preprocessing validation data (Duration: 14.61s)
12-15 01:31 - Starting step: Preprocessing testing data
12-15 01:31 - Completed step: Preprocessing testing data (Duration: 14.55s)
12-15 01:31 - Saved preprocessed data to checkpoints/preprocessed_data_20241215_010515.pkl
12-15 01:31 - Applying SMOTEENN to training data.
12-15 01:34 - Post-Resampling Memory Usage: 2968.81 MB
12-15 01:34 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-15 01:34 - Post-Resampling Memory Usage: 3178.39 MB
12-15 01:34 - Saved resampled data to checkpoints/resampled_data_20241215_010515.pkl
12-15 01:34 - Initializing new Optuna studies.
12-15 01:34 - Saved Optuna studies to checkpoints/optuna_studies_20241215_010515.pkl
12-15 01:34 - Starting Optuna hyperparameter tuning with 5 parallel jobs.
12-15 01:34 - Optimizing Random Forest hyperparameters with Optuna.
12-15 01:34 - Error during Random Forest optimization or training: index 2 is out of bounds for axis 1 with size 2
Traceback (most recent call last):
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 943, in main
    studies["Random_Forest_Optimization"].optimize(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/study.py", line 475, in optimize
    _optimize(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 100, in _optimize
    f.result()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 248, in _run_trial
    raise func_err
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/study/_optimize.py", line 197, in _run_trial
    value_or_values = func(trial)
  File "/Users/jeremy/Desktop/predicting-sepsis-main/main.py", line 795, in rf_objective
    "max_features": trial.suggest_categorical(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/trial/_trial.py", line 402, in suggest_categorical
    return self._suggest(name, CategoricalDistribution(choices=choices))
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/trial/_trial.py", line 631, in _suggest
    param_value = self.study.sampler.sample_independent(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/samplers/_tpe/sampler.py", line 424, in sample_independent
    return self._sample(study, trial, {param_name: param_distribution})[param_name]
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/samplers/_tpe/sampler.py", line 460, in _sample
    mpe_above = self._build_parzen_estimator(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/samplers/_tpe/sampler.py", line 495, in _build_parzen_estimator
    mpe = self._parzen_estimator_cls(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/samplers/_tpe/parzen_estimator.py", line 70, in __init__
    distributions=[
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/samplers/_tpe/parzen_estimator.py", line 71, in <listcomp>
    self._calculate_distributions(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/samplers/_tpe/parzen_estimator.py", line 156, in _calculate_distributions
    return self._calculate_categorical_distributions(
  File "/Users/jeremy/miniforge3/envs/predictsepsis/lib/python3.10/site-packages/optuna/samplers/_tpe/parzen_estimator.py", line 210, in _calculate_categorical_distributions
    weights[np.arange(len(observed_indices)), observed_indices] += 1
IndexError: index 2 is out of bounds for axis 1 with size 2
12-15 01:34 - Optimizing Logistic Regression hyperparameters with Optuna.
12-15 01:34 - Best Logistic Regression parameters: {'penalty': 'elasticnet', 'C': 0.14333491189702535, 'max_iter': 1010, 'tol': 1.4467518214030764e-05, 'l1_ratio': 0.009821290379741665}
12-15 01:34 - Logistic Regression - Total trials: 26
12-15 01:34 - Logistic Regression - Completed trials: 25
12-15 01:34 - Logistic Regression - Pruned trials: 0
12-15 01:34 - Logistic Regression - Failed trials: 0
12-15 01:34 - Training Logistic Regression (Tuned)...
12-15 01:37 - Training completed for Logistic Regression (Tuned).
12-15 01:37 - Predictions made for Logistic Regression (Tuned).
12-15 01:37 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-15 01:37 - 
Logistic Regression (Tuned) Evaluation:
12-15 01:37 -   Accuracy                  : 0.9460
12-15 01:37 -   Precision                 : 0.1902
12-15 01:37 -   Recall                    : 0.7063
12-15 01:37 -   F1 Score                  : 0.2996
12-15 01:37 -   Mean Absolute Error       : 0.0540
12-15 01:37 -   Root Mean Squared Error   : 0.2323
12-15 01:37 -   AUC-ROC                   : 0.8962
12-15 01:37 -   AUPRC                     : 0.1445
12-15 01:37 -   Specificity               : 0.9500
12-15 01:37 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-15 01:37 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-15 01:37 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-15 01:37 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-15 01:37 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-15 01:37 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-15 01:37 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-15 01:37 - Missing values heatmap saved to reports/evaluations/run_20241215_010515/Logistic Regression (Tuned)_missing_values_heatmap.png
12-15 01:37 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_19434.png
12-15 01:37 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_119867.png
12-15 01:37 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113388.png
12-15 01:37 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16905.png
12-15 01:37 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_18504.png
12-15 01:37 - Saved temporal progression plots for 5 patients
12-15 01:37 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-15 01:37 - Saved error analysis plots to reports/evaluations/run_20241215_010515
12-15 01:37 - Saved plot: Logistic Regression (Tuned)_interaction_Unit1_Unit2.png
12-15 01:37 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_Hour.png
12-15 01:37 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-15 01:38 - Saved plot: Logistic Regression (Tuned)_interaction_Hour_ICULOS.png
12-15 01:38 - Saved plot: Logistic Regression (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-15 01:38 - Saved feature interaction plots for top 5 pairs
12-15 01:38 - No sepsis patients have predictions for timeline plots.
12-15 01:38 - Saved evaluation metrics to reports/evaluations/run_20241215_010515/Logistic Regression (Tuned)_metrics.json

12-15 01:38 - Evaluation completed for Logistic Regression (Tuned).
12-15 01:38 - New best model: Logistic Regression (Tuned) with F1 Score: 0.2996
12-15 01:38 - Saved hyperparameters to reports/evaluations/run_20241215_010515/logistic_regression_tuned_params.json
12-15 01:38 - Optimizing XGBoost hyperparameters with Optuna.
12-15 01:38 - Best XGBoost parameters: {'n_estimators': 457, 'max_depth': 9, 'learning_rate': 0.17255776234553302, 'subsample': 0.7574329529424287, 'colsample_bytree': 0.5433439671072606, 'gamma': 0.012455929246615097, 'reg_alpha': 0.07875095024685662, 'reg_lambda': 0.5035646682042978}
12-15 01:38 - XGBoost - Total trials: 48
12-15 01:38 - XGBoost - Completed trials: 48
12-15 01:38 - XGBoost - Pruned trials: 0
12-15 01:38 - XGBoost - Failed trials: 0
12-15 01:38 - Training XGBoost (Tuned)...
12-15 01:38 - Training completed for XGBoost (Tuned).
12-15 01:38 - Predictions made for XGBoost (Tuned).
12-15 01:38 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-15 01:38 - 
XGBoost (Tuned) Evaluation:
12-15 01:38 -   Accuracy                  : 0.9602
12-15 01:38 -   Precision                 : 0.2481
12-15 01:38 -   Recall                    : 0.7063
12-15 01:38 -   F1 Score                  : 0.3673
12-15 01:38 -   Mean Absolute Error       : 0.0398
12-15 01:38 -   Root Mean Squared Error   : 0.1995
12-15 01:38 -   AUC-ROC                   : 0.9429
12-15 01:38 -   AUPRC                     : 0.4455
12-15 01:38 -   Specificity               : 0.9644
12-15 01:38 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-15 01:38 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-15 01:38 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-15 01:38 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-15 01:38 - Saved plot: XGBoost_(Tuned)_calibration.png
12-15 01:38 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-15 01:38 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-15 01:38 - Missing values heatmap saved to reports/evaluations/run_20241215_010515/XGBoost (Tuned)_missing_values_heatmap.png
12-15 01:38 - Saved plot: XGBoost_(Tuned)_temporal_patient_13391.png
12-15 01:38 - Saved plot: XGBoost_(Tuned)_temporal_patient_113787.png
12-15 01:38 - Saved plot: XGBoost_(Tuned)_temporal_patient_4376.png
12-15 01:38 - Saved plot: XGBoost_(Tuned)_temporal_patient_16421.png
12-15 01:38 - Saved plot: XGBoost_(Tuned)_temporal_patient_117871.png
12-15 01:38 - Saved temporal progression plots for 5 patients
12-15 01:38 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-15 01:38 - Saved error analysis plots to reports/evaluations/run_20241215_010515
12-15 01:38 - Saved plot: XGBoost (Tuned)_interaction_Unit1_Unit2.png
12-15 01:38 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_Hour.png
12-15 01:38 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-15 01:38 - Saved plot: XGBoost (Tuned)_interaction_Hour_ICULOS.png
12-15 01:38 - Saved plot: XGBoost (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-15 01:38 - Saved feature interaction plots for top 5 pairs
12-15 01:38 - No sepsis patients have predictions for timeline plots.
12-15 01:38 - Saved evaluation metrics to reports/evaluations/run_20241215_010515/XGBoost (Tuned)_metrics.json

12-15 01:38 - Evaluation completed for XGBoost (Tuned).
12-15 01:38 - New best model: XGBoost (Tuned) with F1 Score: 0.3673
12-15 01:38 - Saved hyperparameters to reports/evaluations/run_20241215_010515/xgboost_tuned_params.json
12-15 01:38 - Saved trained models to checkpoints/trained_models_20241215_010515.pkl
12-15 01:38 - Saved updated Optuna studies to checkpoints/optuna_studies_20241215_010515.pkl
12-15 01:38 - Saved trial data to reports/evaluations/run_20241215_010515/random_forest_optimization_optimization_trials.csv
12-15 01:38 - Saved trial data to reports/evaluations/run_20241215_010515/logistic_regression_optimization_optimization_trials.csv
12-15 01:38 - Saved trial data to reports/evaluations/run_20241215_010515/xgboost_optimization_optimization_trials.csv
12-15 01:38 - 
Performing final evaluation with best model: XGBoost (Tuned)
12-15 01:38 - Predictions made with XGBoost (Tuned) on test set.
12-15 01:38 - 
Test Data with Predictions Information:
12-15 01:38 - Shape: (231564, 46)
12-15 01:38 - Memory usage: 82.15 MB
12-15 01:38 - Columns: ['Unnamed: 0', 'Hour', 'HR', 'O2Sat', 'Temp', 'SBP', 'MAP', 'DBP', 'Resp', 'EtCO2', 'BaseExcess', 'HCO3', 'FiO2', 'pH', 'PaCO2', 'SaO2', 'AST', 'BUN', 'Alkalinephos', 'Calcium', 'Chloride', 'Creatinine', 'Bilirubin_direct', 'Glucose', 'Lactate', 'Magnesium', 'Phosphate', 'Potassium', 'Bilirubin_total', 'TroponinI', 'Hct', 'Hgb', 'PTT', 'WBC', 'Fibrinogen', 'Platelets', 'Age', 'Gender', 'Unit1', 'Unit2', 'HospAdmTime', 'ICULOS', 'SepsisLabel', 'Patient_ID', 'Predicted', 'Predicted_Prob']
12-15 01:38 - 
Columns with missing values:
12-15 01:38 - HR: 23238 missing values (10.04%)
12-15 01:38 - O2Sat: 30505 missing values (13.17%)
12-15 01:38 - Temp: 153908 missing values (66.46%)
12-15 01:38 - SBP: 33801 missing values (14.60%)
12-15 01:38 - MAP: 29215 missing values (12.62%)
12-15 01:38 - DBP: 73440 missing values (31.71%)
12-15 01:38 - Resp: 35682 missing values (15.41%)
12-15 01:38 - EtCO2: 223495 missing values (96.52%)
12-15 01:38 - BaseExcess: 219066 missing values (94.60%)
12-15 01:38 - HCO3: 221952 missing values (95.85%)
12-15 01:38 - FiO2: 212427 missing values (91.74%)
12-15 01:38 - pH: 215588 missing values (93.10%)
12-15 01:38 - PaCO2: 218826 missing values (94.50%)
12-15 01:38 - SaO2: 223674 missing values (96.59%)
12-15 01:38 - AST: 227770 missing values (98.36%)
12-15 01:38 - BUN: 215682 missing values (93.14%)
12-15 01:38 - Alkalinephos: 227820 missing values (98.38%)
12-15 01:38 - Calcium: 218005 missing values (94.14%)
12-15 01:38 - Chloride: 221130 missing values (95.49%)
12-15 01:38 - Creatinine: 217516 missing values (93.93%)
12-15 01:38 - Bilirubin_direct: 231116 missing values (99.81%)
12-15 01:38 - Glucose: 191908 missing values (82.87%)
12-15 01:38 - Lactate: 225462 missing values (97.36%)
12-15 01:38 - Magnesium: 216944 missing values (93.69%)
12-15 01:38 - Phosphate: 222323 missing values (96.01%)
12-15 01:38 - Potassium: 210138 missing values (90.75%)
12-15 01:38 - Bilirubin_total: 228141 missing values (98.52%)
12-15 01:38 - TroponinI: 229287 missing values (99.02%)
12-15 01:38 - Hct: 210814 missing values (91.04%)
12-15 01:38 - Hgb: 214394 missing values (92.59%)
12-15 01:38 - PTT: 224719 missing values (97.04%)
12-15 01:38 - WBC: 216618 missing values (93.55%)
12-15 01:38 - Fibrinogen: 230003 missing values (99.33%)
12-15 01:38 - Platelets: 217708 missing values (94.02%)
12-15 01:38 - Unit1: 92935 missing values (40.13%)
12-15 01:38 - Unit2: 92935 missing values (40.13%)
12-15 01:38 - HospAdmTime: 8 missing values (0.00%)
12-15 01:38 - Predicted: 92935 missing values (40.13%)
12-15 01:38 - Predicted_Prob: 92935 missing values (40.13%)
12-15 01:38 - Class distribution: {0: 227392, 1: 4172}
12-15 01:38 - 
Final_xgboost_(tuned) Evaluation:
12-15 01:38 -   Accuracy                  : 0.9447
12-15 01:38 -   Precision                 : 0.2056
12-15 01:38 -   Recall                    : 0.8475
12-15 01:38 -   F1 Score                  : 0.3309
12-15 01:38 -   Mean Absolute Error       : 0.0553
12-15 01:38 -   Root Mean Squared Error   : 0.2351
12-15 01:38 -   AUC-ROC                   : 0.9587
12-15 01:38 -   AUPRC                     : 0.6273
12-15 01:38 -   Specificity               : 0.9463
12-15 01:38 - Saved plot: Final_xgboost_(tuned)_confusion_matrix.png
12-15 01:38 - Saved plot: Final_xgboost_(tuned)_confusion_matrix_normalized.png
12-15 01:38 - Saved plot: Final_xgboost_(tuned)_roc_curve.png
12-15 01:38 - Saved plot: Final_xgboost_(tuned)_precision_recall_curve.png
12-15 01:38 - Saved plot: Final_xgboost_(tuned)_calibration.png
12-15 01:38 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-15 01:38 - Final_xgboost_(tuned) - Dataset too large for missing values annotation on heatmap.
12-15 01:39 - Missing values heatmap saved to reports/evaluations/run_20241215_010515/Final_xgboost_(tuned)_missing_values_heatmap.png
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_temporal_patient_4786.png
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_temporal_patient_8586.png
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_temporal_patient_2919.png
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_temporal_patient_8522.png
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_temporal_patient_110866.png
12-15 01:39 - Saved temporal progression plots for 5 patients
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_error_analysis.png
12-15 01:39 - Saved error analysis plots to reports/evaluations/run_20241215_010515
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_interaction_Unnamed: 0_Hour.png
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_interaction_Unit1_Unit2.png
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_interaction_Unnamed: 0_ICULOS.png
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_interaction_Hour_ICULOS.png
12-15 01:39 - Saved plot: Final_xgboost_(tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-15 01:39 - Saved feature interaction plots for top 5 pairs
12-15 01:39 - No sepsis patients have predictions for timeline plots.
12-15 01:39 - Saved evaluation metrics to reports/evaluations/run_20241215_010515/Final_xgboost_(tuned)_metrics.json

12-15 01:39 - Final evaluation completed for XGBoost (Tuned).
12-15 01:39 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-15 01:39 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-15 01:39 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-15 01:39 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-15 01:39 - Saved plot: XGBoost_(Tuned)_calibration.png
12-15 01:39 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-15 01:39 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-15 01:39 - Missing values heatmap saved to reports/evaluations/run_20241215_010515/XGBoost (Tuned)_missing_values_heatmap.png
12-15 01:39 - Saved plot: XGBoost_(Tuned)_temporal_patient_107362.png
12-15 01:39 - Saved plot: XGBoost_(Tuned)_temporal_patient_3698.png
12-15 01:39 - Saved plot: XGBoost_(Tuned)_temporal_patient_113526.png
12-15 01:39 - Saved plot: XGBoost_(Tuned)_temporal_patient_14518.png
12-15 01:39 - Saved plot: XGBoost_(Tuned)_temporal_patient_111920.png
12-15 01:39 - Saved temporal progression plots for 5 patients
12-15 01:39 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-15 01:39 - Saved error analysis plots to reports/evaluations/run_20241215_010515
12-15 01:39 - Saved plot: XGBoost (Tuned)_interaction_Unit1_Unit2.png
12-15 01:39 - Saved plot: XGBoost (Tuned)_interaction_Hour_ICULOS.png
12-15 01:39 - Saved plot: XGBoost (Tuned)_interaction_Hct_Hgb.png
12-15 01:40 - Saved plot: XGBoost (Tuned)_interaction_BUN_Creatinine.png
12-15 01:40 - Saved plot: XGBoost (Tuned)_interaction_BUN_Age.png
12-15 01:40 - Saved feature interaction plots for top 5 pairs
12-15 01:40 - No sepsis patients have predictions for timeline plots.
12-15 01:40 - Model card saved to reports/evaluations/run_20241215_010515/XGBoost (Tuned)_model_card.md
12-15 01:40 - Saving the best model (XGBoost (Tuned))
12-15 01:40 - Saved model 'XGBoost (Tuned)' version 'v1' to 'models/XGBoost (Tuned)_20241215_014011_ced8dc'
12-15 01:40 - Model (XGBoost (Tuned)) saved successfully.
12-15 01:40 - Sepsis Prediction Pipeline completed successfully.
12-15 01:40 - --------------------------------------------------------------------------------
12-15 01:40 - Phase Complete: Main
12-15 01:40 - Duration: 2095.40 seconds
12-15 01:40 - Final Memory Usage: 1721.94 MB
12-15 01:40 - Memory Change: +1509.66 MB
12-15 01:40 - ================================================================================
12-15 02:22 - ================================================================================
12-15 02:22 - Starting Phase: Main
12-15 02:22 - --------------------------------------------------------------------------------
12-15 02:22 - Initial Memory Usage: 212.20 MB
12-15 02:22 - Starting Sepsis Prediction Pipeline
12-15 02:22 - Initial Memory Usage: 212.20 MB
12-15 02:22 - Reports and metrics will be saved to: reports/evaluations/run_20241215_022220
12-15 02:22 - Loading and preprocessing data.
12-15 02:22 - Splitting data into training, validation, and testing sets
12-15 02:22 - Starting step: Preprocessing training data
12-15 02:47 - Completed step: Preprocessing training data (Duration: 1519.04s)
12-15 02:47 - Starting step: Preprocessing validation data
12-15 02:48 - Completed step: Preprocessing validation data (Duration: 13.78s)
12-15 02:48 - Starting step: Preprocessing testing data
12-15 02:48 - Completed step: Preprocessing testing data (Duration: 14.72s)
12-15 02:48 - Saved preprocessed data to checkpoints/preprocessed_data_20241215_022220.pkl
12-15 02:48 - Applying SMOTEENN to training data.
12-15 02:51 - Post-Resampling Memory Usage: 3232.08 MB
12-15 02:51 - Saved plot: Resampled_Training_Data_class_distribution__after_resampling.png
12-15 02:51 - Post-Resampling Memory Usage: 2670.33 MB
12-15 02:51 - Saved resampled data to checkpoints/resampled_data_20241215_022220.pkl
12-15 02:51 - Initializing new Optuna studies.
12-15 02:51 - Saved Optuna studies to checkpoints/optuna_studies_20241215_022220.pkl
12-15 02:51 - Starting Optuna hyperparameter tuning with 5 parallel jobs.
12-15 02:51 - Optimizing Random Forest hyperparameters with Optuna.
12-15 04:22 - Best Random Forest parameters: {'n_estimators': 200, 'max_depth': 29, 'min_samples_split': 2, 'min_samples_leaf': 1, 'max_features': 'log2'}
12-15 04:22 - Random Forest - Total trials: 146
12-15 04:22 - Random Forest - Completed trials: 131
12-15 04:22 - Random Forest - Pruned trials: 0
12-15 04:22 - Random Forest - Failed trials: 10
12-15 04:22 - Training Random Forest (Tuned)...
12-15 04:24 - Training completed for Random Forest (Tuned).
12-15 04:24 - Predictions made for Random Forest (Tuned).
12-15 04:24 - Extracted model for evaluation: <class 'sklearn.ensemble._forest.RandomForestClassifier'>
12-15 04:24 - 
Random Forest (Tuned) Evaluation:
12-15 04:24 -   Accuracy                  : 0.9744
12-15 04:24 -   Precision                 : 0.3225
12-15 04:24 -   Recall                    : 0.5166
12-15 04:24 -   F1 Score                  : 0.3971
12-15 04:24 -   Mean Absolute Error       : 0.0256
12-15 04:24 -   Root Mean Squared Error   : 0.1601
12-15 04:24 -   AUC-ROC                   : 0.9483
12-15 04:24 -   AUPRC                     : 0.3833
12-15 04:24 -   Specificity               : 0.9820
12-15 04:24 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-15 04:24 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-15 04:24 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-15 04:24 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-15 04:24 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-15 04:24 - Saved plot: Random_Forest_(Tuned)_feature_importance.png
12-15 04:24 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-15 04:24 - Missing values heatmap saved to reports/evaluations/run_20241215_022220/Random Forest (Tuned)_missing_values_heatmap.png
12-15 04:24 - Saved plot: Random_Forest_(Tuned)_temporal_patient_19434.png
12-15 04:24 - Saved plot: Random_Forest_(Tuned)_temporal_patient_119867.png
12-15 04:24 - Saved plot: Random_Forest_(Tuned)_temporal_patient_113388.png
12-15 04:24 - Saved plot: Random_Forest_(Tuned)_temporal_patient_16905.png
12-15 04:24 - Saved plot: Random_Forest_(Tuned)_temporal_patient_18504.png
12-15 04:24 - Saved temporal progression plots for 5 patients
12-15 04:24 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-15 04:24 - Saved error analysis plots to reports/evaluations/run_20241215_022220
12-15 04:24 - Saved plot: Random Forest (Tuned)_interaction_Unit1_Unit2.png
12-15 04:24 - Saved plot: Random Forest (Tuned)_interaction_Unnamed: 0_Hour.png
12-15 04:24 - Saved plot: Random Forest (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-15 04:24 - Saved plot: Random Forest (Tuned)_interaction_Hour_ICULOS.png
12-15 04:24 - Saved plot: Random Forest (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-15 04:24 - Saved feature interaction plots for top 5 pairs
12-15 04:24 - No sepsis patients have predictions for timeline plots.
12-15 04:24 - Saved evaluation metrics to reports/evaluations/run_20241215_022220/Random Forest (Tuned)_metrics.json

12-15 04:24 - Evaluation completed for Random Forest (Tuned).
12-15 04:24 - New best model: Random Forest (Tuned) with F1 Score: 0.3971
12-15 04:24 - Saved hyperparameters to reports/evaluations/run_20241215_022220/random_forest_tuned_params.json
12-15 04:24 - Optimizing Logistic Regression hyperparameters with Optuna.
12-15 04:24 - Best Logistic Regression parameters: {'penalty': 'elasticnet', 'C': 0.14333491189702535, 'max_iter': 1010, 'tol': 1.4467518214030764e-05, 'l1_ratio': 0.009821290379741665}
12-15 04:24 - Logistic Regression - Total trials: 26
12-15 04:24 - Logistic Regression - Completed trials: 25
12-15 04:24 - Logistic Regression - Pruned trials: 0
12-15 04:24 - Logistic Regression - Failed trials: 0
12-15 04:24 - Training Logistic Regression (Tuned)...
12-15 04:25 - Training completed for Logistic Regression (Tuned).
12-15 04:25 - Predictions made for Logistic Regression (Tuned).
12-15 04:25 - Extracted model for evaluation: <class 'sklearn.linear_model._logistic.LogisticRegression'>
12-15 04:25 - 
Logistic Regression (Tuned) Evaluation:
12-15 04:25 -   Accuracy                  : 0.9344
12-15 04:25 -   Precision                 : 0.1691
12-15 04:25 -   Recall                    : 0.7697
12-15 04:25 -   F1 Score                  : 0.2773
12-15 04:25 -   Mean Absolute Error       : 0.0656
12-15 04:25 -   Root Mean Squared Error   : 0.2561
12-15 04:25 -   AUC-ROC                   : 0.8938
12-15 04:25 -   AUPRC                     : 0.1381
12-15 04:25 -   Specificity               : 0.9372
12-15 04:25 - Saved plot: Logistic Regression (Tuned)_confusion_matrix.png
12-15 04:25 - Saved plot: Logistic Regression (Tuned)_confusion_matrix_normalized.png
12-15 04:25 - Saved plot: Logistic_Regression_(Tuned)_roc_curve.png
12-15 04:25 - Saved plot: Logistic_Regression_(Tuned)_precision_recall_curve.png
12-15 04:25 - Saved plot: Logistic_Regression_(Tuned)_calibration.png
12-15 04:25 - Saved plot: Logistic_Regression_(Tuned)_feature_importance.png
12-15 04:25 - Logistic Regression (Tuned) - Dataset too large for missing values annotation on heatmap.
12-15 04:25 - Missing values heatmap saved to reports/evaluations/run_20241215_022220/Logistic Regression (Tuned)_missing_values_heatmap.png
12-15 04:25 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_13391.png
12-15 04:25 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_113787.png
12-15 04:25 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_4376.png
12-15 04:25 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_16421.png
12-15 04:25 - Saved plot: Logistic_Regression_(Tuned)_temporal_patient_117871.png
12-15 04:25 - Saved temporal progression plots for 5 patients
12-15 04:25 - Saved plot: Logistic_Regression_(Tuned)_error_analysis.png
12-15 04:25 - Saved error analysis plots to reports/evaluations/run_20241215_022220
12-15 04:25 - Saved plot: Logistic Regression (Tuned)_interaction_Unit1_Unit2.png
12-15 04:25 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_Hour.png
12-15 04:25 - Saved plot: Logistic Regression (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-15 04:26 - Saved plot: Logistic Regression (Tuned)_interaction_Hour_ICULOS.png
12-15 04:26 - Saved plot: Logistic Regression (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-15 04:26 - Saved feature interaction plots for top 5 pairs
12-15 04:26 - No sepsis patients have predictions for timeline plots.
12-15 04:26 - Saved evaluation metrics to reports/evaluations/run_20241215_022220/Logistic Regression (Tuned)_metrics.json

12-15 04:26 - Evaluation completed for Logistic Regression (Tuned).
12-15 04:26 - Saved hyperparameters to reports/evaluations/run_20241215_022220/logistic_regression_tuned_params.json
12-15 04:26 - Optimizing XGBoost hyperparameters with Optuna.
12-15 04:26 - Best XGBoost parameters: {'n_estimators': 457, 'max_depth': 9, 'learning_rate': 0.17255776234553302, 'subsample': 0.7574329529424287, 'colsample_bytree': 0.5433439671072606, 'gamma': 0.012455929246615097, 'reg_alpha': 0.07875095024685662, 'reg_lambda': 0.5035646682042978}
12-15 04:26 - XGBoost - Total trials: 48
12-15 04:26 - XGBoost - Completed trials: 48
12-15 04:26 - XGBoost - Pruned trials: 0
12-15 04:26 - XGBoost - Failed trials: 0
12-15 04:26 - Training XGBoost (Tuned)...
12-15 04:26 - Training completed for XGBoost (Tuned).
12-15 04:26 - Predictions made for XGBoost (Tuned).
12-15 04:26 - Extracted model for evaluation: <class 'xgboost.sklearn.XGBClassifier'>
12-15 04:26 - 
XGBoost (Tuned) Evaluation:
12-15 04:26 -   Accuracy                  : 0.9594
12-15 04:26 -   Precision                 : 0.2453
12-15 04:26 -   Recall                    : 0.7150
12-15 04:26 -   F1 Score                  : 0.3653
12-15 04:26 -   Mean Absolute Error       : 0.0406
12-15 04:26 -   Root Mean Squared Error   : 0.2015
12-15 04:26 -   AUC-ROC                   : 0.9437
12-15 04:26 -   AUPRC                     : 0.4494
12-15 04:26 -   Specificity               : 0.9634
12-15 04:26 - Saved plot: XGBoost (Tuned)_confusion_matrix.png
12-15 04:26 - Saved plot: XGBoost (Tuned)_confusion_matrix_normalized.png
12-15 04:26 - Saved plot: XGBoost_(Tuned)_roc_curve.png
12-15 04:26 - Saved plot: XGBoost_(Tuned)_precision_recall_curve.png
12-15 04:26 - Saved plot: XGBoost_(Tuned)_calibration.png
12-15 04:26 - Saved plot: XGBoost_(Tuned)_feature_importance.png
12-15 04:26 - XGBoost (Tuned) - Dataset too large for missing values annotation on heatmap.
12-15 04:26 - Missing values heatmap saved to reports/evaluations/run_20241215_022220/XGBoost (Tuned)_missing_values_heatmap.png
12-15 04:26 - Saved plot: XGBoost_(Tuned)_temporal_patient_110729.png
12-15 04:26 - Saved plot: XGBoost_(Tuned)_temporal_patient_1698.png
12-15 04:26 - Saved plot: XGBoost_(Tuned)_temporal_patient_12208.png
12-15 04:26 - Saved plot: XGBoost_(Tuned)_temporal_patient_102089.png
12-15 04:26 - Saved plot: XGBoost_(Tuned)_temporal_patient_13569.png
12-15 04:26 - Saved temporal progression plots for 5 patients
12-15 04:26 - Saved plot: XGBoost_(Tuned)_error_analysis.png
12-15 04:26 - Saved error analysis plots to reports/evaluations/run_20241215_022220
12-15 04:26 - Saved plot: XGBoost (Tuned)_interaction_Unit1_Unit2.png
12-15 04:26 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_Hour.png
12-15 04:26 - Saved plot: XGBoost (Tuned)_interaction_Unnamed: 0_ICULOS.png
12-15 04:26 - Saved plot: XGBoost (Tuned)_interaction_Hour_ICULOS.png
12-15 04:26 - Saved plot: XGBoost (Tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-15 04:26 - Saved feature interaction plots for top 5 pairs
12-15 04:26 - No sepsis patients have predictions for timeline plots.
12-15 04:26 - Saved evaluation metrics to reports/evaluations/run_20241215_022220/XGBoost (Tuned)_metrics.json

12-15 04:26 - Evaluation completed for XGBoost (Tuned).
12-15 04:26 - Saved hyperparameters to reports/evaluations/run_20241215_022220/xgboost_tuned_params.json
12-15 04:26 - Saved trained models to checkpoints/trained_models_20241215_022220.pkl
12-15 04:26 - Saved updated Optuna studies to checkpoints/optuna_studies_20241215_022220.pkl
12-15 04:26 - Saved trial data to reports/evaluations/run_20241215_022220/random_forest_optimization_optimization_trials.csv
12-15 04:26 - Saved trial data to reports/evaluations/run_20241215_022220/logistic_regression_optimization_optimization_trials.csv
12-15 04:26 - Saved trial data to reports/evaluations/run_20241215_022220/xgboost_optimization_optimization_trials.csv
12-15 04:26 - 
Performing final evaluation with best model: Random Forest (Tuned)
12-15 04:27 - Predictions made with Random Forest (Tuned) on test set.
12-15 04:27 - 
Test Data with Predictions Information:
12-15 04:27 - Shape: (231564, 46)
12-15 04:27 - Memory usage: 83.03 MB
12-15 04:27 - Columns: ['Unnamed: 0', 'Hour', 'HR', 'O2Sat', 'Temp', 'SBP', 'MAP', 'DBP', 'Resp', 'EtCO2', 'BaseExcess', 'HCO3', 'FiO2', 'pH', 'PaCO2', 'SaO2', 'AST', 'BUN', 'Alkalinephos', 'Calcium', 'Chloride', 'Creatinine', 'Bilirubin_direct', 'Glucose', 'Lactate', 'Magnesium', 'Phosphate', 'Potassium', 'Bilirubin_total', 'TroponinI', 'Hct', 'Hgb', 'PTT', 'WBC', 'Fibrinogen', 'Platelets', 'Age', 'Gender', 'Unit1', 'Unit2', 'HospAdmTime', 'ICULOS', 'SepsisLabel', 'Patient_ID', 'Predicted', 'Predicted_Prob']
12-15 04:27 - 
Columns with missing values:
12-15 04:27 - HR: 23238 missing values (10.04%)
12-15 04:27 - O2Sat: 30505 missing values (13.17%)
12-15 04:27 - Temp: 153908 missing values (66.46%)
12-15 04:27 - SBP: 33801 missing values (14.60%)
12-15 04:27 - MAP: 29215 missing values (12.62%)
12-15 04:27 - DBP: 73440 missing values (31.71%)
12-15 04:27 - Resp: 35682 missing values (15.41%)
12-15 04:27 - EtCO2: 223495 missing values (96.52%)
12-15 04:27 - BaseExcess: 219066 missing values (94.60%)
12-15 04:27 - HCO3: 221952 missing values (95.85%)
12-15 04:27 - FiO2: 212427 missing values (91.74%)
12-15 04:27 - pH: 215588 missing values (93.10%)
12-15 04:27 - PaCO2: 218826 missing values (94.50%)
12-15 04:27 - SaO2: 223674 missing values (96.59%)
12-15 04:27 - AST: 227770 missing values (98.36%)
12-15 04:27 - BUN: 215682 missing values (93.14%)
12-15 04:27 - Alkalinephos: 227820 missing values (98.38%)
12-15 04:27 - Calcium: 218005 missing values (94.14%)
12-15 04:27 - Chloride: 221130 missing values (95.49%)
12-15 04:27 - Creatinine: 217516 missing values (93.93%)
12-15 04:27 - Bilirubin_direct: 231116 missing values (99.81%)
12-15 04:27 - Glucose: 191908 missing values (82.87%)
12-15 04:27 - Lactate: 225462 missing values (97.36%)
12-15 04:27 - Magnesium: 216944 missing values (93.69%)
12-15 04:27 - Phosphate: 222323 missing values (96.01%)
12-15 04:27 - Potassium: 210138 missing values (90.75%)
12-15 04:27 - Bilirubin_total: 228141 missing values (98.52%)
12-15 04:27 - TroponinI: 229287 missing values (99.02%)
12-15 04:27 - Hct: 210814 missing values (91.04%)
12-15 04:27 - Hgb: 214394 missing values (92.59%)
12-15 04:27 - PTT: 224719 missing values (97.04%)
12-15 04:27 - WBC: 216618 missing values (93.55%)
12-15 04:27 - Fibrinogen: 230003 missing values (99.33%)
12-15 04:27 - Platelets: 217708 missing values (94.02%)
12-15 04:27 - Unit1: 92935 missing values (40.13%)
12-15 04:27 - Unit2: 92935 missing values (40.13%)
12-15 04:27 - HospAdmTime: 8 missing values (0.00%)
12-15 04:27 - Predicted: 92935 missing values (40.13%)
12-15 04:27 - Predicted_Prob: 92935 missing values (40.13%)
12-15 04:27 - Class distribution: {0: 227392, 1: 4172}
12-15 04:27 - 
Final_random_forest_(tuned) Evaluation:
12-15 04:27 -   Accuracy                  : 0.9872
12-15 04:27 -   Precision                 : 0.6268
12-15 04:27 -   Recall                    : 0.5152
12-15 04:27 -   F1 Score                  : 0.5655
12-15 04:27 -   Mean Absolute Error       : 0.0128
12-15 04:27 -   Root Mean Squared Error   : 0.1130
12-15 04:27 -   AUC-ROC                   : 0.9723
12-15 04:27 -   AUPRC                     : 0.6073
12-15 04:27 -   Specificity               : 0.9950
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_confusion_matrix.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_confusion_matrix_normalized.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_roc_curve.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_precision_recall_curve.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_calibration.png
12-15 04:27 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-15 04:27 - Final_random_forest_(tuned) - Dataset too large for missing values annotation on heatmap.
12-15 04:27 - Missing values heatmap saved to reports/evaluations/run_20241215_022220/Final_random_forest_(tuned)_missing_values_heatmap.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_temporal_patient_108897.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_temporal_patient_1849.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_temporal_patient_15449.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_temporal_patient_19636.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_temporal_patient_2114.png
12-15 04:27 - Saved temporal progression plots for 5 patients
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_error_analysis.png
12-15 04:27 - Saved error analysis plots to reports/evaluations/run_20241215_022220
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed: 0_Hour.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_interaction_Unit1_Unit2.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_interaction_Unnamed: 0_ICULOS.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_interaction_Hour_ICULOS.png
12-15 04:27 - Saved plot: Final_random_forest_(tuned)_interaction_Bilirubin_direct_Bilirubin_total.png
12-15 04:27 - Saved feature interaction plots for top 5 pairs
12-15 04:27 - No sepsis patients have predictions for timeline plots.
12-15 04:27 - Saved evaluation metrics to reports/evaluations/run_20241215_022220/Final_random_forest_(tuned)_metrics.json

12-15 04:27 - Final evaluation completed for Random Forest (Tuned).
12-15 04:27 - Saved plot: Random Forest (Tuned)_confusion_matrix.png
12-15 04:27 - Saved plot: Random Forest (Tuned)_confusion_matrix_normalized.png
12-15 04:27 - Saved plot: Random_Forest_(Tuned)_roc_curve.png
12-15 04:27 - Saved plot: Random_Forest_(Tuned)_precision_recall_curve.png
12-15 04:27 - Saved plot: Random_Forest_(Tuned)_calibration.png
12-15 04:27 - Model type <class 'imblearn.pipeline.Pipeline'> does not support feature importance plotting.
12-15 04:27 - Random Forest (Tuned) - Dataset too large for missing values annotation on heatmap.
12-15 04:27 - Missing values heatmap saved to reports/evaluations/run_20241215_022220/Random Forest (Tuned)_missing_values_heatmap.png
12-15 04:27 - Saved plot: Random_Forest_(Tuned)_temporal_patient_13491.png
12-15 04:27 - Saved plot: Random_Forest_(Tuned)_temporal_patient_109380.png
12-15 04:27 - Saved plot: Random_Forest_(Tuned)_temporal_patient_15235.png
12-15 04:27 - Saved plot: Random_Forest_(Tuned)_temporal_patient_100016.png
12-15 04:27 - Saved plot: Random_Forest_(Tuned)_temporal_patient_9513.png
12-15 04:27 - Saved temporal progression plots for 5 patients
12-15 04:27 - Saved plot: Random_Forest_(Tuned)_error_analysis.png
12-15 04:27 - Saved error analysis plots to reports/evaluations/run_20241215_022220
12-15 04:27 - Saved plot: Random Forest (Tuned)_interaction_Unit1_Unit2.png
12-15 04:27 - Saved plot: Random Forest (Tuned)_interaction_Hour_ICULOS.png
12-15 04:28 - Saved plot: Random Forest (Tuned)_interaction_Hct_Hgb.png
12-15 04:28 - Saved plot: Random Forest (Tuned)_interaction_BUN_Creatinine.png
12-15 04:28 - Saved plot: Random Forest (Tuned)_interaction_BUN_Age.png
12-15 04:28 - Saved feature interaction plots for top 5 pairs
12-15 04:28 - No sepsis patients have predictions for timeline plots.
12-15 04:28 - Model card saved to reports/evaluations/run_20241215_022220/Random Forest (Tuned)_model_card.md
12-15 04:28 - Saving the best model (Random Forest (Tuned))
12-15 04:28 - Saved model 'Random Forest (Tuned)' version 'v3' to 'models/Random Forest (Tuned)_20241215_042816_6c36d4'
12-15 04:28 - Model (Random Forest (Tuned)) saved successfully.
12-15 04:28 - Sepsis Prediction Pipeline completed successfully.
12-15 04:28 - --------------------------------------------------------------------------------
12-15 04:28 - Phase Complete: Main
12-15 04:28 - Duration: 7556.77 seconds
12-15 04:28 - Final Memory Usage: 2073.75 MB
12-15 04:28 - Memory Change: +1861.55 MB
12-15 04:28 - ================================================================================
